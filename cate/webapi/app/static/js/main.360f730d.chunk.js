(this["webpackJsonpcate-app"]=this["webpackJsonpcate-app"]||[]).push([[0],{10:function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return k})),n.d(t,"P",(function(){return w})),n.d(t,"gc",(function(){return S})),n.d(t,"ec",(function(){return j})),n.d(t,"hc",(function(){return I})),n.d(t,"I",(function(){return P})),n.d(t,"fc",(function(){return D})),n.d(t,"h",(function(){return T})),n.d(t,"N",(function(){return L})),n.d(t,"i",(function(){return R})),n.d(t,"v",(function(){return N})),n.d(t,"Q",(function(){return x})),n.d(t,"jc",(function(){return M})),n.d(t,"X",(function(){return V})),n.d(t,"r",(function(){return B})),n.d(t,"B",(function(){return W})),n.d(t,"c",(function(){return U})),n.d(t,"x",(function(){return Y})),n.d(t,"H",(function(){return H})),n.d(t,"V",(function(){return K})),n.d(t,"M",(function(){return z})),n.d(t,"cb",(function(){return q})),n.d(t,"ub",(function(){return J})),n.d(t,"tb",(function(){return X})),n.d(t,"Fb",(function(){return Z})),n.d(t,"Eb",(function(){return Q})),n.d(t,"O",(function(){return $})),n.d(t,"W",(function(){return ee})),n.d(t,"xb",(function(){return te})),n.d(t,"Wb",(function(){return ne})),n.d(t,"w",(function(){return ae})),n.d(t,"yb",(function(){return re})),n.d(t,"E",(function(){return oe})),n.d(t,"F",(function(){return ie})),n.d(t,"T",(function(){return le})),n.d(t,"S",(function(){return ce})),n.d(t,"R",(function(){return se})),n.d(t,"vb",(function(){return ue})),n.d(t,"wb",(function(){return de})),n.d(t,"fb",(function(){return pe})),n.d(t,"D",(function(){return he})),n.d(t,"U",(function(){return fe})),n.d(t,"u",(function(){return me})),n.d(t,"kb",(function(){return be})),n.d(t,"gb",(function(){return ve})),n.d(t,"s",(function(){return ye})),n.d(t,"t",(function(){return ge})),n.d(t,"Sb",(function(){return Ee})),n.d(t,"Rb",(function(){return Oe})),n.d(t,"Tb",(function(){return _e})),n.d(t,"Ub",(function(){return Ce})),n.d(t,"Vb",(function(){return ke})),n.d(t,"lb",(function(){return we})),n.d(t,"jb",(function(){return Se})),n.d(t,"C",(function(){return je})),n.d(t,"hb",(function(){return Ie})),n.d(t,"ib",(function(){return Pe})),n.d(t,"m",(function(){return De})),n.d(t,"o",(function(){return Te})),n.d(t,"n",(function(){return Le})),n.d(t,"p",(function(){return Ae})),n.d(t,"nc",(function(){return Re})),n.d(t,"J",(function(){return Ne})),n.d(t,"kc",(function(){return xe})),n.d(t,"bb",(function(){return Me})),n.d(t,"Y",(function(){return Be})),n.d(t,"Xb",(function(){return We})),n.d(t,"Ab",(function(){return Ue})),n.d(t,"ic",(function(){return Fe})),n.d(t,"Yb",(function(){return Ge})),n.d(t,"Mb",(function(){return Ye})),n.d(t,"Jb",(function(){return He})),n.d(t,"mc",(function(){return Ke})),n.d(t,"lc",(function(){return ze})),n.d(t,"K",(function(){return qe})),n.d(t,"ab",(function(){return Xe})),n.d(t,"Z",(function(){return Ze})),n.d(t,"Bb",(function(){return Qe})),n.d(t,"zb",(function(){return $e})),n.d(t,"Ob",(function(){return et})),n.d(t,"Pb",(function(){return tt})),n.d(t,"Db",(function(){return nt})),n.d(t,"Nb",(function(){return at})),n.d(t,"z",(function(){return rt})),n.d(t,"g",(function(){return ot})),n.d(t,"ac",(function(){return it})),n.d(t,"Kb",(function(){return lt})),n.d(t,"Gb",(function(){return ct})),n.d(t,"cc",(function(){return st})),n.d(t,"dc",(function(){return ut})),n.d(t,"d",(function(){return dt})),n.d(t,"e",(function(){return pt})),n.d(t,"f",(function(){return ht})),n.d(t,"mb",(function(){return mt})),n.d(t,"Qb",(function(){return bt})),n.d(t,"nb",(function(){return vt})),n.d(t,"y",(function(){return yt})),n.d(t,"db",(function(){return gt})),n.d(t,"pb",(function(){return Et})),n.d(t,"l",(function(){return Ot})),n.d(t,"j",(function(){return _t})),n.d(t,"k",(function(){return kt})),n.d(t,"L",(function(){return wt})),n.d(t,"rb",(function(){return St})),n.d(t,"qb",(function(){return jt})),n.d(t,"ob",(function(){return It})),n.d(t,"Ib",(function(){return Pt})),n.d(t,"Hb",(function(){return Dt})),n.d(t,"Lb",(function(){return Tt})),n.d(t,"Zb",(function(){return Lt})),n.d(t,"bc",(function(){return At})),n.d(t,"Cb",(function(){return Rt})),n.d(t,"sb",(function(){return Nt})),n.d(t,"G",(function(){return xt})),n.d(t,"q",(function(){return Mt})),n.d(t,"eb",(function(){return Vt})),n.d(t,"A",(function(){return Bt}));var a=n(33),r=n(6),o=n(31),i=n(117),l=n(25),c=n(68),s=n(38),u=n(18),d=n(56),p=n(65),h=n(15),f=n(16),m=function(){function e(t){Object(h.a)(this,e),this.webAPIClient=void 0,this.webAPIClient=t}return Object(f.a)(e,[{key:"loadPreferences",value:function(){return this.webAPIClient.call("get_preferences",[])}},{key:"updatePreferences",value:function(e){return this.webAPIClient.call("set_preferences",[e])}}]),e}(),b=n(808),v=n(118);function y(e,t,n){var a=function(e,t){return t&&t.length>0&&(e+="?"+t.map((function(e){return e.map(encodeURIComponent).join("=")})).join("&")),e}(e,t);return console.debug("Calling API: ",a),fetch(a,n).then((function(e){if(!e.ok)throw console.log(e),new v.a(e.status,e.statusText);return e})).catch((function(e){throw e}))}function g(e,t,n,a){return y(e,t,n).then((function(e){return e.blob()})).then((function(e){return function(e,t){t||(t="cate_"+Object(b.a)()+".zip");var n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n)}(e,a),e}))}function E(e,t,n){return y(e,t,n).then((function(e){return e.json()}))}var O=function(){function e(t){Object(h.a)(this,e),this.webAPIClient=void 0,this.webAPIClient=t}return Object(f.a)(e,[{key:"monitorProcess",value:function(e,t){return this.webAPIClient.call("monitor_download_files",[e],t,(function(){}))}},{key:"registerProcess",value:function(e){return E(e+"/files/download",void 0,{mode:"cors",method:"PUT",body:JSON.stringify({})})}},{key:"uploadFiles",value:function(e,t,n){var a=new FormData;return a.append("dir",e),a.append("files",t,t.name),E(n+"/files/upload",void 0,{mode:"cors",method:"POST",body:a})}},{key:"downloadFiles",value:function(e,t,n){var a={target_files:e,process_id:t};return g(n+"/files/download",void 0,{mode:"cors",method:"POST",body:JSON.stringify(a)})}}]),e}(),_=Object(i.b)(),C={},k=[],w=function(e){return e.session.offlineMode},S=function(e){return e.communication.webAPIServiceInfo},j=function(e){return e.communication.webAPIClient},I=function(e){return e.communication.webAPIServiceURL},P=function(e){return!!_&&!!_.ipcRenderer&&!!e.communication.webAPIServiceInfo&&!e.communication.webAPIServiceInfo.userRootMode},D=Object(o.createSelector)(I,(function(e){return function(e){return A(e,!1,"/")}(e)})),T=Object(o.createSelector)(I,(function(e){return function(e){return A(e,!0,"api")}(e)})),L=Object(o.createSelector)(I,(function(e){return function(e){return A(e,!0,"mpl/figures/")}(e)}));function A(e,t,n){var a=new URL(e),r=t?"https:"===a.protocol?"wss:":"ws:":a.protocol,o=a.pathname,i="".concat(r,"//").concat(a.host);return o&&"/"!==o&&(i+=o),n&&(n.startsWith("/")||i.endsWith("/")||(i+="/"),i+=n),i}var R=Object(o.createSelector)(j,(function(e){return new s.a(e)})),N=Object(o.createSelector)(j,(function(e){return new s.c(e)})),x=Object(o.createSelector)(j,(function(e){return new s.h(e)})),M=Object(o.createSelector)(j,(function(e){return new s.i(e)})),V=Object(o.createSelector)(j,(function(e){return new m(e)})),B=Object(o.createSelector)(j,(function(e){return new s.b(e)})),W=Object(o.createSelector)(j,(function(e){return null!==e?new s.f(e):null})),U=function(e){var t=new Set;for(var n in e.communication.tasks){var a=e.communication.tasks[n];a.status!==s.g.NEW&&a.status!==s.g.SUBMITTED&&a.status!==s.g.IN_PROGRESS||t.add(a.requestLock)}return t},F={},G=function(e){return e.control.dialogs},Y=function(e){return F[e]||(F[e]=Object(o.createSelector)(G,(function(t){return t[e]||C}))),F[e]},H=Object(o.createSelector)(G,(function(e){return Object.getOwnPropertyNames(e).some((function(t){return e[t].isOpen}))})),K=function(e){return e.session.panelContainerUndockedMode},z=function(e){return e.session.leftPanelContainerLayout},q=function(e){return e.session.rightPanelContainerLayout},J=function(e){return e.session.selectedLeftTopPanelId},X=function(e){return e.session.selectedLeftBottomPanelId},Z=function(e){return e.session.selectedRightTopPanelId},Q=function(e){return e.session.selectedRightBottomPanelId},$=function(e){return e.control.newPlacemarkToolType},ee=function(e){return e.session.placemarkCollection},te=function(e){return e.session.selectedPlacemarkId},ne=function(e){return e.session.showPlacemarkDetails},ae=function(e){return e.session.defaultPlacemarkStyle},re=Object(o.createSelector)((function(e){return e.session.placemarkCollection.features}),te,(function(e,t){return Wt(e,t)?e.find((function(e){return e.id===t})):null})),oe=function(e){return e.location.globeMousePosition},ie=function(e){return e.location.globeViewPosition},le=function(e){return e.data.operations},ce=function(e){return e.session.operationFilterTags},se=function(e){return e.session.operationFilterExpr},ue=function(e){return e.session.selectedOperationName},de=Object(o.createSelector)(le,ue,(function(e,t){return e&&e.length&&t?e.find((function(e){return e.name===t})):null})),pe=Object(o.createSelector)(le,(function(e){return e.control.selectedCtxOperationName}),(function(e,t){return e&&e.length&&t?e.find((function(e){return e.name===t})):null})),he=Object(o.createSelector)(le,ce,se,(function(e,t,n){var a=e&&e.length,r=n&&""!==n,o=t&&t.length;if(a&&(r||o)){var i,l;if(r){var c=n.toLowerCase().split(" ");i=function(e){return c.every((function(t){return e.name.toLowerCase().includes(t)}))}}else i=function(e){return!0};return l=o?function(e){return!t.length||t.every((function(t){return new Set(e.tags).has(t)}))}:function(e){return!0},e.filter((function(e){return i(e)&&l(e)}))}return e||k})),fe=Object(o.createSelector)(le,(function(e){var t=new Map;return(e||k).forEach((function(e){return(e.tags||k).forEach((function(e){t.set(e,(t.get(e)||0)+1)}))})),t})),me=function(e){return e.data.dataStores},be=function(e){return e.session.selectedDataStoreId},ve=function(e){return e.session.selectedDataSourceId},ye=function(e){return e.session.dataSourceFilterExpr},ge=function(e){return e.session.dataSourceListHeight},Ee=function(e){return e.session.showDataSourceDetails},Oe=function(e){return e.session.showAllDataSources},_e=function(e){return e.session.showDataSourceIDs},Ce=function(e){return e.session.showDataStoreDescription},ke=function(e){return e.session.showDataStoreNotices},we=Object(o.createSelector)(me,be,(function(e,t){return Wt(e,t)?e.find((function(e){return e.id===t})):null})),Se=Object(o.createSelector)(we,(function(e){return e&&e.dataSources||null})),je=Object(o.createSelector)(Se,ye,Oe,(function(e,t,n){if(e&&e.length&&(t&&""!==t||!n)){var a=t.toLowerCase().split(" ");return e.filter((function(e){return function(e,t,n){if(!t&&!Object(l.o)(e))return!1;var a=e.id.toLowerCase();if(n.every((function(e){return a.includes(e)})))return!0;var r=e.title||(e.metaInfo?e.metaInfo.title:null);if(!r||""===r)return!1;return r=r.toLowerCase(),n.every((function(e){return r.includes(e)}))}(e,n,a)}))}return e}));var Ie=Object(o.createSelector)(Se,ve,(function(e,t){return Wt(e,t)?e.find((function(e){return e.id===t})):null})),Pe=Object(o.createSelector)(Ie,(function(e){return e&&e.metaInfo&&e.metaInfo.time_range||null})),De=Object(o.createSelector)(be,Ie,(function(e,t){return null!==e&&"local"!==e&&"cci-zarr-store"!==e&&(!!t&&Object(l.j)(t))})),Te=(Object(o.createSelector)(Ie,(function(e){return!!e&&Object(l.n)(e)})),Object(o.createSelector)(Ie,(function(e){return e&&Object(l.l)(e)}))),Le=Object(o.createSelector)(Ie,(function(e){return e&&Object(l.k)(e)})),Ae=Object(o.createSelector)(Ie,(function(e){return e&&Object(l.m)(e)})),Re=function(e){return e.data.workspace},Ne=function(e){return e.data.workspace&&e.data.workspace.isScratch},xe=function(e){return e.data.workspace&&e.data.workspace.baseDir},Me=function(e){return e.data.workspace?e.data.workspace.resources:k},Ve=function(e){return e.data.workspace?e.data.workspace.workflow.steps:k},Be=function(e){return e.session.resourceListHeight},We=function(e){return e.session.showResourceDetails},Ue=function(e){return e.control.selectedWorkspaceResourceName},Fe=function(e){return e.session.workflowStepListHeight},Ge=function(e){return e.session.showWorkflowStepDetails},Ye=function(e){return e.control.selectedWorkflowStepId||Ue(e)},He=function(e){return e.control.selectedVariableName},Ke=Object(o.createSelector)(xe,(function(e){return function(e){if(!e)return null;var t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>=0?e.substring(t+1):e}(e)})),ze=Object(o.createSelector)(xe,(function(e){return Je(e)})),qe=Object(o.createSelector)((function(e){return e.session.lastWorkspacePath}),(function(e){return Je(e)}));function Je(e){if(!e)return null;var t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>=0?e.substring(0,t):""}var Xe=Object(o.createSelector)(Me,(function(e){return e.map((function(e){return e.name}))})),Ze=Object(o.createSelector)(Me,(function(e){var t={};return e.forEach((function(e){t[e.name]=e})),t})),Qe=Object(o.createSelector)(Me,Ue,(function(e,t){return Wt(e,t)?e.find((function(e){return e.name===t})):null})),$e=Object(o.createSelector)(Qe,(function(e){if(!e||!e.attributes)return k;var t=[],n=e.attributes;for(var a in n)n.hasOwnProperty(a)&&t.push([a,n[a]]);return t})),et=Object(o.createSelector)(Me,Ye,(function(e,t){return Wt(e,t)?e.find((function(e){return e.name===t})):null})),tt=Object(o.createSelector)(Ve,Ye,(function(e,t){return Wt(e,t)?e.find((function(e){return e.id===t})):null})),nt=Object(o.createSelector)(Ve,Ue,(function(e,t){return Wt(e,t)?e.find((function(e){return e.id===t})):null})),at=Object(o.createSelector)(le,tt,(function(e,t){return e&&t&&t.op?Object(l.r)(e,t.op):null})),rt=Object(o.createSelector)(Me,(function(e){return e.filter((function(e){return Object(l.U)(e)}))})),ot=(Object(o.createSelector)(Qe,(function(e){return e&&Object(l.U)(e)?e:null})),Object(o.createSelector)(Me,(function(e){return e.filter((function(e){return Object(l.S)(e)}))}))),it=Object(o.createSelector)(Qe,(function(e){return e&&e.variables||null})),lt=Object(o.createSelector)(it,He,(function(e,t){return Wt(e,t)?(e||k).find((function(e){return e.name===t})):null})),ct=Object(o.createSelector)(lt,(function(e){if(!e)return null;var t=[["Data type",e.dataType],["Units",e.units||""],["Valid minimum",e.validMin],["Valid maximum",e.validMax],["Dimension names",e.dimNames&&e.dimNames.join(", ")],["Array shape",e.shape&&e.shape.join(", ")],["Chunk sizes",e.chunkSizes&&e.chunkSizes.join(", ")],[" ",""]],n=e.attributes;return n&&Object.getOwnPropertyNames(n).forEach((function(e){t.push([e,n[e]])})),t})),st=function(e){return e.control.viewLayout},ut=function(e){return e.control.views},dt=function(e){return e.control.activeViewId},pt=(Object(o.createSelector)(ut,(function(e){return e?e.filter((function(e){return"figure"===e.type})):k})),Object(o.createSelector)(ut,dt,(function(e,t){return Wt(e,t)?e.find((function(e){return e.id===t})):null}))),ht=Object(o.createSelector)(pt,(function(e){return e?e.type:null})),ft=Object(o.createSelector)(pt,(function(e){return e&&"world"===e.type?e.data.selectedEntityId:null})),mt=Object(o.createSelector)(pt,ft,(function(e,t){return Object(l.N)(e)})),bt=Object(o.createSelector)(pt,(function(e){return e?Object(l.Q)(e):null})),vt=Object(o.createSelector)(pt,l.O),yt=function(e){return l.f},gt=function(e){return e.session.savedLayers},Et=Object(o.createSelector)(pt,(function(e){return e&&e.data.selectedLayerId||null})),Ot=function(e){return e.data.baseMaps},_t=Object(o.createSelector)(Ot,pt,(function(e,t){return t&&t.data.baseMapId||l.e})),Ct=Object(o.createSelector)(Ot,pt,(function(e,t){return t&&t.data.baseMapId&&e.find((function(e){return e.id===t.data.baseMapId}))||l.d})),kt=Object(o.createSelector)(Ct,(function(e){return e.options})),wt=Object(o.createSelector)(pt,(function(e){return e&&e.data.layers||null})),St=Object(o.createSelector)(wt,Et,(function(e,t){return Wt(e,t)?e.find((function(e){return e.id===t})):null})),jt=Object(o.createSelector)(wt,Et,(function(e,t){return Wt(e,t)?e.findIndex((function(e){return e.id===t})):-1})),It=Object(o.createSelector)(St,(function(e){return!e||"Image"!==e.type&&"VariableImage"!==e.type?null:e})),Pt=Object(o.createSelector)(St,(function(e){return e&&"VariableImage"===e.type?e:null})),Dt=Object(o.createSelector)(Pt,(function(e){if(e){var t=Object(u.d)(e.displayMin)?e.displayMin:0;return[t,Object(u.d)(e.displayMax)?e.displayMax:t+1]}return null})),Tt=Object(o.createSelector)(St,(function(e){return!e||"Vector"!==e.type&&"ResourceVector"!==e.type?null:e})),Lt=function(e){return e.session.styleContext},At=Object(o.createSelector)(pt,Lt,Tt,re,mt,(function(e){return e.control.entityUpdateCount}),(function(e,t,n,a,o,i){var s,u=n&&n.style;if(t===c.e)s=u;else if(t===c.d)if(a){var h=Object(p.c)(a.properties);s=Object(r.a)(Object(r.a)({},u),h)}else if(o){var f=Object(d.g)(o),m=Object(l.P)(e,o),b=m&&m.style,v=m&&m.entityStyles&&m.entityStyles[o.id];s=Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({},u),b),f),v)}return Object(r.a)(Object(r.a)({},p.a),s)})),Rt=Object(o.createSelector)(St,(function(e){return e&&"ResourceVector"===e.type?e:null})),Nt=Object(o.createSelector)(Me,(function(e){var t,n=[],r=Object(a.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.variables){var i,c=Object(a.a)(o.variables);try{for(c.s();!(i=c.n()).done;){var s=i.value;(Object(l.Y)(s)||Object(l.Z)(s))&&n.push({resource:o,variable:s})}}catch(u){c.e(u)}finally{c.f()}}}}catch(u){r.e(u)}finally{r.f()}return n})),xt=Object(o.createSelector)(Qe,lt,Pt,U,(function(e,t,n,a){var r=n;if(!e||!t||!r)return!1;var o=Object(l.G)(e.name,t.name,r.varIndex);return a.has(o)})),Mt=function(e){return e.data.colorMaps},Vt=Object(o.createSelector)(Mt,Pt,(function(e,t){var n=t?t.colorMapName:null;if(Wt(e,n)){var r,o=Object(a.a)(e);try{for(o.s();!(r=o.n()).done;){var i=r.value.colorMaps.find((function(e){return e.name===n}));if(i)return i}}catch(l){o.e(l)}finally{o.f()}}return null})),Bt=Object(o.createSelector)(j,(function(e){return new O(e)}));function Wt(e,t){return e&&e.length&&!!t}},101:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(15),r=function e(){Object(a.a)(this,e)};r.NEW="NEW",r.SUBMITTED="SUBMITTED",r.IN_PROGRESS="IN_PROGRESS",r.DONE="DONE",r.FAILED="FAILED",r.CANCELLED="CANCELLED"},112:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));n(6);var a=n(44);n(18);function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return Object.assign.apply(Object,[{},e].concat(n))}function o(e,t,n){var o=e[t];return r(e,Object(a.a)({},t,r(o,n)))}},117:function(e,t,n){"use strict";function a(){return Boolean(window.electron)}function r(){return window.electron||null}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),a()&&console.debug("We are running on Electron :)")},118:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(15),r=n(16),o=n(19),i=n(20),l=n(431),c=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e,r){var o;return Object(a.a)(this,n),(o=t.call(this,r))._status=void 0,o._status=e,o}return Object(r.a)(n,[{key:"status",get:function(){return this._status}},{key:"statusText",get:function(){return this.message}}],[{key:"fromResponse",value:function(e){return new n(e.status,e.statusText)}}]),n}(Object(l.a)(Error))},120:function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v}));var a=n(15),r=n(16),o=n(8),i=n(19),l=n(20),c=n(70),s=n(2),u=n(26),d=n(5),p=n(41),h=n(7),f=n(10),m=n(46),b="openWorkspaceDialog",v="deleteWorkspaceDialog";var y=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).renderItem=function(e){return s.createElement("span",null,e)},r.state={workspaceDir:"",currentWorkspaceName:"",selectedWorkspaceName:"",deleteEntireWorkspace:!0},r.onCancel=r.onCancel.bind(Object(o.a)(r)),r.onConfirm=r.onConfirm.bind(Object(o.a)(r)),r.canConfirm=r.canConfirm.bind(Object(o.a)(r)),r.renderBody=r.renderBody.bind(Object(o.a)(r)),r.onWorkspaceNameChange=r.onWorkspaceNameChange.bind(Object(o.a)(r)),r.onWorkspaceDirChange=r.onWorkspaceDirChange.bind(Object(o.a)(r)),r}return Object(r.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({workspaceDir:e.workspaceDir,currentWorkspaceName:e.currentWorkspaceName})}},{key:"onCancel",value:function(){this.props.dispatch(h.Tb(this.props.dialogId)),this.resetSelectedWorkspaceName()}},{key:"canConfirm",value:function(){return!("undefined"===this.state.selectedWorkspaceName||!this.state.selectedWorkspaceName)&&/^([A-Za-z_\-\s0-9.]+)$/.test(this.state.selectedWorkspaceName)}},{key:"composeWorkspacePath",value:function(){var e=this.state.workspaceDir,t=this.state.selectedWorkspaceName;return null===e?t:e+"/"+t}},{key:"onConfirm",value:function(){this.props.dispatch(h.Tb(this.props.dialogId,this.state)),this.props.dialogId===v?this.props.dispatch(h.Nb(this.composeWorkspacePath(),this.state.deleteEntireWorkspace)):this.props.dispatch(h.nc(this.composeWorkspacePath())),this.resetSelectedWorkspaceName()}},{key:"resetSelectedWorkspaceName",value:function(){this.setState({selectedWorkspaceName:""})}},{key:"setSelectedWorkspace",value:function(e){this.setState({selectedWorkspaceName:e})}},{key:"handleCheckboxChange",value:function(e){this.setState({deleteEntireWorkspace:e.target.checked})}},{key:"onWorkspaceDirChange",value:function(e){this.setState({workspaceDir:e.target.value})}},{key:"onWorkspaceNameChange",value:function(e){this.setState({currentWorkspaceName:e.target.value})}},{key:"render",value:function(){var e,t,n=this.props.isOpen;return n?(this.props.dialogId===v?(e="Delete Workspace",t="Delete"):(e="Open Workspace",t="Open"),s.createElement(p.a,{isOpen:n,title:e,confirmTitle:t,onCancel:this.onCancel,canConfirm:this.canConfirm,onConfirm:this.onConfirm,renderBody:this.renderBody})):null}},{key:"renderBody",value:function(){var e,t=this;return this.props.isOpen?0===this.props.workspaceNames.length?s.createElement("div",null,s.createElement("p",{style:{marginTop:"1em"}},"No saved workspaces found.")):(this.props.dialogId===v&&(e=s.createElement(d.Tooltip,{content:"Also delete other files in the workspace folder"},s.createElement(d.Checkbox,{style:{marginTop:"1em"},label:"Delete entire workspace",checked:this.state.deleteEntireWorkspace,onChange:this.handleCheckboxChange.bind(this)}))),s.createElement("div",null,s.createElement("p",{style:{marginTop:"1em"}},"Saved workspaces:"),s.createElement(m.a,{items:this.props.workspaceNames,selectionMode:m.b.SINGLE,getItemKey:function(e,t){return e},renderItem:this.renderItem,onSelection:function(e){return t.setSelectedWorkspace(""+e[0])},selection:this.state.selectedWorkspaceName}),e)):null}}]),n}(s.Component);t.c=Object(u.b)((function(e,t){var n,a=f.x(t.dialogId)(e),r=a.isOpen,o=t.dialogId,i=f.I(e),l=a.workspaceDir,s=a.workspaceName;if(r&&(f.J(e)||(l=l||f.lc(e),s=s||f.mc(e)),l=l||f.K(e)),l=i?l||"":null,s=s||"",e.data.workspace&&e.data.workspaceNames){var u=(n=Object(c.a)(e.data.workspaceNames)).indexOf(s);u>-1&&n.splice(u,1)}return{workspaceDir:l,currentWorkspaceName:s,selectedWorkspaceName:"",dialogId:o,isOpen:r,isLocalFSAllowed:i,workspaceNames:n,deleteEntireWorkspace:this.deleteEntireWorkspace}}))(y)},170:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(70),r=n(59),o=n.n(r),i=n(78),l=n(15),c=n(16),s=n(118),u=n(73),d=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"getPodStatus",value:function(){var e=Object(i.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performServiceOp(u.b.webApi.managApiUrl,"GET",t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"startService",value:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performServiceOp(u.b.webApi.managApiUrl,"POST",t,n);case 2:return a=e.sent,e.abrupt("return",a.serverUrl);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopServiceInstance",value:function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performServiceOp(u.b.webApi.closeApiUrl,"DELETE",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getServiceCount",value:function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performServiceOp(u.b.webApi.countApiUrl,"GET");case 2:return t=e.sent,e.abrupt("return",t.running_pods);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"performServiceOp",value:function(){var e=Object(i.a)(o.a.mark((function e(t,n,r,i){var l,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=[["Accept","application/json"]],i&&(l=[].concat(Object(a.a)(l),[["Authorization","Bearer ".concat(i)]])),c=t,t.indexOf("{username}")>0&&(c=new URL(t.replace("{username}",r)).toString()),e.next=6,fetch(c,{method:n,headers:l,mode:"cors"});case 6:if((u=e.sent).ok){e.next=9;break}throw s.a.fromResponse(u);case 9:return e.abrupt("return",u.json());case 10:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}()}]),e}()},18:function(e,t,n){"use strict";function a(e){return"undefined"!==typeof e}function r(e){return"undefined"===typeof e}function o(e){return null!==e&&"undefined"!==typeof e}function i(e){return null===e||"undefined"===typeof e}function l(e){return"number"===typeof e}function c(e){return"string"===typeof e}function s(e){return"boolean"===typeof e}n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s}))},223:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a=n(33),r=n(6),o=n(15),i=n(16),l=n(8),c=n(19),s=n(20),u=n(2),d=n(26),p=n(5),h=n(430),f=n(41),m=n(7),b=n(10),v=n(52),y={width:"100%",marginBottom:"2em",display:"flex",flexGrow:1},g={flexGrow:1},E={flex:"none"},O={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",border:"2px dashed #137cbd",borderRadius:"5px",background:"rgba(16, 22, 26, 0.3)",color:"#f5f8fa",transition:"border .24s ease-in-out"};var _=function(e){Object(c.a)(n,e);var t=Object(s.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleOnDrop=function(e){a.setState(Object(r.a)(Object(r.a)({},a.state),{},{files:e}))},a.handleOpenDirectoryOnClose=function(e){a.setState(Object(r.a)(Object(r.a)({},a.state),{},{dir:e})),console.log(e)},a.handleOpenDirectoryOpen=function(){a.props.dispatch(Object(m.ed)({title:"Select Target Directory"},a.handleOpenDirectoryOnClose))},a.state={files:[],dir:"./"},a.onCancel=a.onCancel.bind(Object(l.a)(a)),a.onConfirm=a.onConfirm.bind(Object(l.a)(a)),a.canConfirm=a.canConfirm.bind(Object(l.a)(a)),a.renderBody=a.renderBody.bind(Object(l.a)(a)),a}return Object(i.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({files:[],dir:"./"})}},{key:"onCancel",value:function(){this.props.dispatch(m.Tb(n.DIALOG_ID))}},{key:"canConfirm",value:function(){return this.state.files.length>0}},{key:"onConfirm",value:function(){this.props.dispatch(m.Tb(n.DIALOG_ID,this.state));var e,t=Object(a.a)(this.state.files);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.props.dispatch(m.Cd(this.state.dir,r))}}catch(o){t.e(o)}finally{t.f()}}},{key:"render",value:function(){var e=this.props.isOpen;return e?u.createElement(f.a,{isOpen:e,title:"Upload files",icon:"upload",confirmTitle:"Upload",confirmIconName:"upload",confirmTooltip:"Upload files.",onCancel:this.onCancel,canConfirm:this.canConfirm,onConfirm:this.onConfirm,renderBody:this.renderBody}):null}},{key:"renderBody",value:function(){var e=this.state.files.map((function(e){return u.createElement("li",{key:e.name},e.name," - ",e.size," bytes")}));return this.state.files?u.createElement("div",null,u.createElement("div",null,"Remote target directory:",u.createElement(p.ControlGroup,{style:y,fill:!0},u.createElement(v.a,{style:g,value:this.state.dir,onChange:function(e){console.log(e)},nullable:!1}),u.createElement(p.AnchorButton,{intent:p.Intent.PRIMARY,style:E,onClick:this.handleOpenDirectoryOpen},"..."))),u.createElement("div",null,"Files to upload:",u.createElement(p.ControlGroup,{style:y,fill:!0},u.createElement(h.a,{onDrop:this.handleOnDrop},(function(t){var n=t.getRootProps,a=t.getInputProps;return u.createElement("section",{className:"container"},u.createElement("div",n({style:O}),u.createElement("input",a()),u.createElement("p",null,"Drag 'n' drop files here, or click to select files")),u.createElement("aside",null,e.length>0?u.createElement("h4",null,"Files"):"",u.createElement("ul",null,e)))}))))):null}}]),n}(u.Component);_.DIALOG_ID="fileUploadDialog";var C=_.DIALOG_ID;t.b=Object(d.b)((function(e){return{isOpen:b.x(_.DIALOG_ID)(e).isOpen,dialogId:_.DIALOG_ID}}))(_)},224:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(15),r=n(16),o=n(118),i=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,[{key:"getServiceInfo",value:function(e){var t=new URL(e+"/");return fetch(t.toString()).then((function(e){if(!e.ok)throw o.a.fromResponse(e);return e.json()})).then((function(e){var t=e.content;return{name:t.name,version:t.version,timestamp:t.timestamp,userRootMode:t.user_root_mode,hostOS:t.host_os,dependencies:t.dependencies}}))}}]),e}()},226:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return g}));var a=n(6),r=n(33),o=n(25),i=n(18);var l=n(10),c=n(23),s=n(56);function u(e,t,n,a,i){if(!e||!e.length)return l.b;var c,s,u,f=Object(r.a)(e);try{for(f.s();!(u=f.n()).done;){var m=u.value,b=void 0,v=void 0;switch(m.type){case"VariableImage":b=d(m,a,i,t);break;case"ResourceVector":v=p(m,a,i,t);break;case"Vector":v=h(m,a,n)}b?c?c.push(b):c=[b]:v?s?s.push(v):s=[v]:m.id!==o.a&&console.warn('GlobeView: layer with ID "'.concat(m.id,'" will not be rendered'))}}catch(y){f.e(y)}finally{f.f()}return{imageLayerDescriptors:c,vectorLayerDescriptors:s}}function d(e,t,n,a){var r=Object(o.u)(a,e);if(!r)return console.warn('GlobeView: variable "'.concat(e.varName,'" not found in resource "').concat(e.resId,'"')),null;var i=r.imageLayout;if(!r.imageLayout)return console.warn('GlobeView: variable "'.concat(e.varName,'" of resource "').concat(e.resId,'" has no imageLayout')),null;var l=Object(o.M)(t,n,e),s=c.u.MAX_VALUE;if(i.extent){var u=i.extent;s=c.u.fromDegrees(u.west,u.south,u.east,u.north)}return Object.assign({},e,{imageryProvider:f,imageryProviderOptions:{url:l,rectangle:s,minimumLevel:0,maximumLevel:i.numLevels-1,tileWidth:i.tileWidth,tileHeight:i.tileHeight,tilingScheme:new c.k({rectangle:s,numberOfLevelZeroTilesX:i.numLevelZeroTilesX,numberOfLevelZeroTilesY:i.numLevelZeroTilesY})}})}function p(e,t,n,r){var i=Object(o.s)(r,e);return i?Object(a.a)(Object(a.a)({},e),{},{dataSource:b,dataSourceOptions:{data:Object(o.z)(t,n,e),resId:i.id,style:e.style}}):(console.warn('globe-view-layers: resource "'.concat(e.resId,'" not found"')),null)}function h(e,t,n){var r=e.data,i=e.style;return e.id===o.c?r=Object(o.C)(t):e.id===o.h&&(r=n),Object(a.a)(Object(a.a)({},e),{},{dataSource:m,dataSourceOptions:{data:r,style:i}})}function f(e,t){var n=new c.z(t);return n.errorEvent.addEventListener((function(e){console.error("GlobeView:",e)})),n}function m(e,t){var n=Object(s.k)(t.style||l.b);return c.j.load(t.data,n)}function b(e,t){return v(t.data,t.resId,t.style)}var v=function(e,t){var n={},a=0,r=function(){for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];var c=o.map((function(e){return"(".concat(e,":").concat(typeof e,")")})).join();if(c in n)return n[c];var s=e.apply(void 0,o);return(Object(i.g)(t)||t>0&&a<t)&&(n[c]=s,a++),s};return r.getMaxSize=function(){return t},r.getSize=function(){return a},r.clearCache=function(){n={},a=0},r}((function(e,t,n){var a=new c.g("Cate Resource #"+t),o=Object(s.k)(n),l=new Worker("".concat(".","/stream-geojson.js"));return l.postMessage(e),l.onmessage=function(e){var t=e.data;if(t){var n=c.d.fromAlpha(o.fill,.9),l=c.d.fromAlpha(o.fill,.5),s={type:"FeatureCollection",features:t};c.j.load(s,o).then((function(e){var o=new Map;t.forEach((function(e){return o.set(e.id,e)}));var s=new c.r(200,1,1e7,.1),u=new c.r(200,1,1e7,.5);a.entities.suspendEvents();var d,p=Object(r.a)(e.entities.values);try{for(p.s();!(d=p.n()).done;){var h=d.value,f=o.get(h.id);if(f&&Object(i.d)(f._simp)&&Object(i.d)(f._resId)&&Object(i.d)(f._idx)&&(h.point||h.billboard||h.label)){var m=.2;if(f.properties){var b=f.properties.area_npl43;b&&((m=(b-20)/480)<0&&(m=0),m>1&&(m=1))}var v=10+90*m;(h=new c.i({id:h.id,position:h.position,description:h.description,properties:h.properties,point:{color:n,outlineColor:l,outlineWidth:10,pixelSize:v,scaleByDistance:s,translucencyByDistance:u}}))._simp=f._simp,h._resId=f._resId,h._idx=f._idx}try{a.entities.add(h)}catch(y){console.error("failed to add entity: ",h,y)}}}catch(g){p.e(g)}finally{p.f()}e.entities.removeAll(),a.entities.resumeEvents(),a.changedEvent.raiseEvent()}))}},a})),y=["billboard","label","point","corridor","polyline","polygon"];function g(e,t,n){var a=Object(s.k)(n);c.j.load(t,a).then((function(t){var n=t.entities.values;n&&n.length&&function(e,t){var n=y.find((function(t){return c.E(e[t])})),a=y.find((function(e){return c.E(t[e])}));a&&n&&a!==n&&(t[a]=void 0);n&&(t[n]=e[n],Object(i.d)(t._simp)&&(t._simp&=-2))}(n[0],e)}))}},237:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=237},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"g",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"W",(function(){return y})),n.d(t,"X",(function(){return g})),n.d(t,"y",(function(){return E})),n.d(t,"p",(function(){return O})),n.d(t,"o",(function(){return C})),n.d(t,"j",(function(){return k})),n.d(t,"l",(function(){return w})),n.d(t,"k",(function(){return S})),n.d(t,"n",(function(){return j})),n.d(t,"m",(function(){return I})),n.d(t,"M",(function(){return D})),n.d(t,"z",(function(){return T})),n.d(t,"A",(function(){return L})),n.d(t,"x",(function(){return A})),n.d(t,"D",(function(){return R})),n.d(t,"C",(function(){return N})),n.d(t,"J",(function(){return x})),n.d(t,"I",(function(){return M})),n.d(t,"Y",(function(){return V})),n.d(t,"Z",(function(){return B})),n.d(t,"w",(function(){return W})),n.d(t,"U",(function(){return F})),n.d(t,"S",(function(){return G})),n.d(t,"T",(function(){return Y})),n.d(t,"E",(function(){return H})),n.d(t,"F",(function(){return K})),n.d(t,"s",(function(){return z})),n.d(t,"t",(function(){return q})),n.d(t,"u",(function(){return X})),n.d(t,"r",(function(){return Z})),n.d(t,"q",(function(){return Q})),n.d(t,"v",(function(){return $})),n.d(t,"K",(function(){return ee})),n.d(t,"b",(function(){return ne})),n.d(t,"e",(function(){return ae})),n.d(t,"d",(function(){return re})),n.d(t,"fb",(function(){return ce})),n.d(t,"cb",(function(){return se})),n.d(t,"B",(function(){return ue})),n.d(t,"bb",(function(){return de})),n.d(t,"db",(function(){return pe})),n.d(t,"f",(function(){return he})),n.d(t,"Q",(function(){return me})),n.d(t,"N",(function(){return be})),n.d(t,"P",(function(){return ve})),n.d(t,"O",(function(){return ye})),n.d(t,"ab",(function(){return ge})),n.d(t,"V",(function(){return Ee})),n.d(t,"eb",(function(){return Ce})),n.d(t,"gb",(function(){return ke})),n.d(t,"H",(function(){return Se})),n.d(t,"G",(function(){return je})),n.d(t,"R",(function(){return De})),n.d(t,"L",(function(){return Te}));var a=n(33),r=n(6),o=n(68),i=n(29),l=n(18),c=n(10),s=n(56),u=n(65),d="auto",p="countries",h="myPlaces",f={id:d,type:"Unknown",visible:!0},m={id:p,name:"Countries",type:"Vector",visible:!1,style:Object(r.a)(Object(r.a)({},u.a),{},{stroke:"#ffff00",fill:"#FFFFFF",fillOpacity:.2,strokeWidth:1.5})},b={id:h,name:"My Places",type:"Vector",visible:!0,style:{markerSize:"small",markerColor:"#ff0000",markerSymbol:"",fill:"#0000ff",fillOpacity:.5,stroke:"#ffff00",strokeOpacity:.5,strokeWidth:1}},v="placemark-";function y(e){return e&&("local"===e.id||e.isLocal)}function g(e){return e&&"local"!==e.id&&!e.isLocal}function E(e){var t,n,a=e.metaInfo;return a&&(!(t=a.catalog_url||a.catalogue_url)&&e.id.includes("esacci")&&a.uuid&&(t="https://catalogue.ceda.ac.uk/uuid/".concat(a.uuid)),n=a.info_url),{catalogUrl:t,infoUrl:n}}function O(e){var t=e.metaInfo;if(t){var n=_(t,"time"),a=_(t,"lon")&&_(t,"lat");if(n&&a)return["open","constrain_time","constrain_region"];if(n)return["open","constrain_time"];if(a)return["open","constrain_region"];if(Object(l.e)(t.data_type)&&"dataset"===t.data_type)return["open"]}}function _(e,t){return!(!e.coords||!e.coords.find((function(e){return function(e,t){return e.name===t&&!!e.dims&&1===e.dims.length&&!!e.dims.find((function(e){return e===t}))}(e,t)})))}function C(e){return P(e,"open","constrain_region","constrain_time","write_zarr")}function k(e){return P(e,"write_zarr")}function w(e){return P(e,"constrain_time")}function S(e){return P(e,"constrain_region")}function j(e){return P(e,"constrain_region")}function I(e){return e.metaInfo&&e.metaInfo.data_vars&&e.metaInfo.data_vars.length>1}function P(e){var t=e.capabilities;if(t||(e.dataType&&"dataset"===e.dataType||e.id.endsWith(".zarr"))&&(t=["open"]),Array.isArray(t)){for(var n=new Set(t),a=arguments.length,r=new Array(a>1?a-1:0),o=1;o<a;o++)r[o-1]=arguments[o];for(var i=0,l=r;i<l.length;i++){var c=l[i];if(n.has(c))return!0}return!1}}function D(e,t,n){return e+"ws/res/tile/".concat(encodeURIComponent(t),"/").concat(n.resId,"/{z}/{y}/{x}.png?")+"&var=".concat(encodeURIComponent(n.varName))+"&index=".concat(encodeURIComponent((n.varIndex||[]).join()))+"&cmap=".concat(encodeURIComponent(n.colorMapName)+(n.alphaBlending?"_alpha":""))+"&min=".concat(encodeURIComponent(n.displayMin+""))+"&max=".concat(encodeURIComponent(n.displayMax+""))}function T(e,t,n){return e+"ws/res/geojson/".concat(encodeURIComponent(t),"/").concat(n.resId)}function L(e,t,n,a){return e+"ws/res/geojson/".concat(encodeURIComponent(t),"/").concat(n.resId,"/").concat(a)}function A(e,t,n,a){var r="";return a&&(r="?var=".concat(encodeURIComponent(a))),e+"ws/res/csv/".concat(encodeURIComponent(t),"/").concat(n.resId).concat(r)}function R(e,t,n){return e+"ws/res/html/".concat(encodeURIComponent(t),"/").concat(n)}function N(e){return e+"ws/countries"}function x(e,t,n){return"".concat(e).concat(encodeURIComponent(t),"/").concat(encodeURIComponent(""+n))}function M(e,t,n){return"".concat(e,"mpl/download/").concat(encodeURIComponent(t),"/").concat(encodeURIComponent(""+n))}function V(e){return e.numDims&&e.numDims>=2&&!!e.imageLayout}function B(e){return e.isFeatureAttribute}function W(e){return e+Math.floor(4294967296*(1+Math.random())).toString(16)+"-"+Math.floor(Date.now()).toString(16)}function U(){return W("layer-")}function F(e){return e&&Object(l.d)(e.id)&&e.dataType.endsWith(".Figure")}function G(e){return e&&Object(l.d)(e.id)&&e.dataType.endsWith(".HTML")}function Y(e){return e&&(e.dataType.endsWith(".DataFrame")||e.dataType.endsWith(".GeoDataFrame"))}function H(e){if(e.name)return e.name;var t=e.varName,n=e.resName;return e.id===d?n&&t?"Selected Variable (".concat(n," / ").concat(t,")"):"Selected Variable (none)":n&&t?"".concat(n," / ").concat(t):e.id}function K(e){return ge(e)?"map-marker":"Image"===e.type||"VariableImage"===e.type?"layout-grid":"layer"}function z(e,t){return J(e,t.resId)}function q(e,t){return e.find((function(e){return e.name===t}))}function J(e,t){return e.find((function(e){return e.id===t}))}function X(e,t){var n=z(e,t);return n&&n.variables&&n.variables.find((function(e){return e.name===t.varName}))}function Z(e,t){return e&&e.find((function(e){return e.qualifiedName===t||e.name===t}))}function Q(e,t,n){var a=e&&e.find((function(e){return e.id===t}));if(a){var r=a.dataSources&&a.dataSources.find((function(e){return e.id===n}));if(r)return r}return null}function $(e,t){var n=J(e,t.resId);if(!n)return c.a;var a=n.coordVariables;if(!a)return c.a;var r=n&&n.variables.find((function(e){return e.name===t.varName}));if(!r)return c.a;var o=t.varIndex;if(!o||!o.length)return c.a;var i=r.dimNames;if(!i||!i.length)return c.a;var l={};a.forEach((function(e){l[e.name]=e.data}));for(var s=[],u=0;u<o.length;u++){var d=o[u],p=u<i.length?i[u]:null,h=void 0;if(p){var f=l[p];h=f&&f.length&&d<f.length?f[d]:"-"}else h="?";s.push([p,h])}return s}function ee(e,t){var n=e.coordVariables;if(!n)return c.b;var a=e&&e.variables.find((function(e){return e.name===t.varName}));if(!a)return c.b;var r=t.varIndex;if(!r||!r.length)return c.b;var o=a.dimNames;if(!o||!o.length)return c.b;var i={};n.forEach((function(e){i[e.name]=e.data}));for(var l={},s=0;s<r.length;s++){var u=r[s],d=s<o.length?o[s]:null;if(d){var p=i[d];p&&p.length&&u<p.length&&(l[d]=p[u])}}return l}var te=function(e){return{id:e,title:e[0].toUpperCase()+e.substring(1),options:{url:"https://storage.googleapis.com/esa-cfs-tiles/0.7.0/basemaps/".concat(e,"/{z}/{x}/{reverseY}.png"),tilingScheme:"Geographic",maximumLevel:4}}},ne=[{id:"natural",title:"Natural",options:null},{id:"natural_offline",title:"Natural (offline)",options:{url:"./Cesium/Assets/Textures/NaturalEarthII/{z}/{x}/{reverseY}.jpg",credit:"\xa9 Analytical Graphics, Inc.",tilingScheme:"Geographic",maximumLevel:2}},te("atmosphere"),te("blue"),te("dark"),te("land"),te("ocean")],ae="atmosphere",re=ne.find((function(e){return"atmosphere"===e.id}));function oe(e){return{viewMode:"3D",projectionCode:"EPSG:4326",baseMapId:e||ae,layers:[Object(r.a)({},f),Object(r.a)({},m),Object(r.a)({},b)],selectedLayerId:d,selectedEntityId:null,layerSplitPosition:.5}}function ie(e,t){return{resName:e,varName:t,dataRows:null}}var le=0;function ce(e){var t=++le;return{title:"World (".concat(t,")"),id:W("world-"),type:"world",icon:"globe",data:oe(e)}}function se(e){return{title:ue(e.name),id:"fig-".concat(e.id),type:"figure",icon:"timeline-area-chart",data:(t=e.id,{resourceId:t,fixedSize:!1})};var t}function ue(e){return"Figure - ".concat(e)}function de(e){return{title:(n=e.name,"Animation - ".concat(n)),id:"anim-".concat(e.id),type:"animation",icon:"play",data:(t=e.id,{resourceId:t,fixedSize:!1})};var t,n}function pe(e,t){return{title:t?"".concat(e,".").concat(t):e,id:W("table-"),type:"table",icon:"th",data:ie(e,t)}}var he={id:"global_external_object_store"};function fe(e){if(e&&"world"===e.type)return he["CesiumGlobe-"+e.id]}function me(e){var t=fe(e);return t?t.object:null}function be(e){var t=me(e);return t&&t.selectedEntity?t.selectedEntity:null}function ve(e,t){var n=fe(e);if(!t||!n)return null;var r=n.object;i.a(r);var o=n.state.dataSourceMap;i.a(o);for(var l=r.dataSources,c=0;c<l.length;c++){var s=l.get(c);if(s.entities.contains(t)){var u,d=Object(a.a)(Object.getOwnPropertyNames(o));try{for(d.s();!(u=d.n()).done;){var p=u.value;if(s===o[p]){var h,f=Object(a.a)(e.data.layers);try{for(f.s();!(h=f.n()).done;){var m=h.value;if(m.id===p)return i.a(ge(m)),m}}catch(b){f.e(b)}finally{f.f()}}}}catch(b){d.e(b)}finally{d.f()}}}return null}function ye(e){var t=be(e);return t?function(){return Object(s.f)(t)}:null}function ge(e){return"Vector"===e.type||"ResourceVector"===e.type}function Ee(e){return"Image"===e.type||"VariableImage"===e.type}var Oe=["#550000","#005500","#000055","#555555"],_e=["#FF0000","#FFA500","#FFFF00","#00FF00","#0000FF","#FF00FF","#00FFFF"];function Ce(e,t,n){i.a(e),i.a(t);var a=t&&V(t),o=t&&B(t);if(i.a(a||o,"geo-spatial variable expected"),a){var l=n&&n[t.name],c=Ie(t,l);return Object(r.a)(Object(r.a)({},l),{},{id:U(),type:"VariableImage",name:"".concat(e.name,".").concat(t.name),visible:!0,resId:e.id,resName:e.name,varName:t.name},c)}var s=n&&n[t.name],u=s&&s.style;return Object(r.a)(Object(r.a)({},s),{},{id:U(),type:"ResourceVector",name:"".concat(e.name),visible:!0,resId:e.id,resName:e.name,style:we(e.id,u)})}function ke(e,t,n,a){i.a(e),i.a(e.id===d);var o=n&&V(n),l=n&&B(n);if(o){var c=a&&a[n.name],s=Ie(n,c);return Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({},e),c),{},{type:"VariableImage",name:"Auto ".concat(t.name,".").concat(n.name),resId:t.id,resName:t.name,varName:n.name},s),{},{id:d})}if(l){var u=a&&a[t.name],p=u&&u.style;return Object(r.a)(Object(r.a)(Object(r.a)({},e),u),{},{type:"ResourceVector",name:"Auto ".concat(t.name),resId:t.id,resName:t.name,style:we(t.id,p),id:d})}return{type:"Unknown",name:n?"Auto ".concat(n.name," (geo-ref not found or recognized)"):"Auto (no selection)",visible:e.visible,id:d}}function we(e,t){return Object(r.a)(Object(r.a)({},u.a),{},{stroke:Oe[e%Oe.length],fill:_e[e%_e.length]},t)}function Se(e){return'loadDataSources("'.concat(e,'")')}function je(e,t,n){return function(e,t,n,a){return a&&a.length?"".concat(e,'("').concat(t,'", "').concat(n,'", [').concat(a,"])"):"".concat(e,'("').concat(t,'", "').concat(n,'")')}("getWorkspaceVariableStatistics",e,t,n)}function Ie(e,t){var n,a;return t?a=t.varIndex&&t.varIndex.slice():e&&(n=function(e){var t=Object(l.d)(e.validMin)?e.validMin:0,n=Object(l.d)(e.validMax)?e.validMax:t+1;return{colorMapName:Object(l.e)(e.colorMapName)?e.colorMapName:"inferno",displayMin:Object(l.d)(e.displayMin)?e.displayMin:t,displayMax:Object(l.d)(e.displayMax)?e.displayMax:n,alphaBlending:!1,opacity:1,brightness:1,contrast:1,hue:0,saturation:1,gamma:1,splitMode:o.b}}(e)),e&&(a=function(e,t){if(e.numDims&&e.numDims>=2&&(!t||t.length!==e.numDims-2))return Array(e.numDims-2).fill(0);return t}(e,a)),Object(r.a)(Object(r.a)({},n),{},{varIndex:a})}var Pe=null;function De(){var e,t;if(null===Pe)try{e=document.createElement("canvas"),Pe=!0,t=(e.getContext("webgl")||e.getContext("experimental-webgl")).getSupportedExtensions(),console.debug("WebGL supported extensions:",t)}catch(n){return Pe=!1,console.warn("WebGL not supported but required by world view"),!1}return e=null,null,Pe}function Te(e,t){var n,r,o,i,l=e.geometry.type,c=t.features,s=new Set,u=Object(a.a)(c);try{for(u.s();!(n=u.n()).done;){var d=n.value.properties;d&&d.title&&d.title.startsWith(l)&&s.add(d.title)}}catch(p){u.e(p)}finally{u.f()}for(o=1;o<=c.length+1;o++)if(i="".concat(l," ").concat(o),!s.has(i)){r=i;break}return{title:r,index:o}}},29:function(e,t,n){"use strict";function a(e,t){if(!e)throw new Error("assertion failed"+(t?": ".concat(t):""))}n.d(t,"a",(function(){return a}))},327:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return ERROR_CODE_INVALID_PARAMS})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ERROR_CODE_CANCELLED})),__webpack_require__.d(__webpack_exports__,"h",(function(){return newWebAPIClient})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getJobFailureIntentName})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getJobFailureIconName})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getJobFailureTitle})),__webpack_require__.d(__webpack_exports__,"f",(function(){return isDeveloperError})),__webpack_require__.d(__webpack_exports__,"g",(function(){return isUserError}));var D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5),_Job__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(101),ERROR_CODE_INVALID_REQUEST=-32600,ERROR_CODE_METHOD_NOT_FOUND=-32601,ERROR_CODE_INVALID_PARAMS=-32602,ERROR_CODE_OS_ERROR=-32001,ERROR_CODE_OUT_OF_MEMORY=-32002,ERROR_CODE_METHOD_ERROR=-32003,ERROR_CODE_INVALID_RESPONSE=-32004,ERROR_CODE_CANCELLED=999,CANCEL_METHOD="__cancel__",DEBUG=!1;function newWebAPIClient(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new WebAPIClientImpl(e,t,n)}var WebAPIClientImpl=function(){function WebAPIClientImpl(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,WebAPIClientImpl),this.url=void 0,this.onOpen=void 0,this.onClose=void 0,this.onError=void 0,this.onWarning=void 0,this.socket=void 0,this.currentMessageId=0,this.activeJobs=void 0,this.url=e,this.currentMessageId=n,this.activeJobs=[],this.socket=a||new WebSocket(e),this.socket.onopen=function(e){t.onOpen&&t.onOpen(e)},this.socket.onclose=function(e){t.onClose&&t.onClose(e)},this.socket.onerror=function(e){t.onError&&t.onError(e)},this.socket.onmessage=function(e){t.processMessage(e.data)}}return Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(WebAPIClientImpl,[{key:"call",value:function(e,t,n,a){var r={id:this.newId(),method:e,params:t},o=new JobImpl(this,r,a);return this.activeJobs[r.id]=o,o.invoke(n)}},{key:"cancel",value:function(e){var t=this.activeJobs[e];t?t.cancel():this.warn('Job with "id"='.concat(e," does not exist"))}},{key:"close",value:function(){this.socket.close()}},{key:"sendMessage",value:function(e){var t=Object.assign({},{jsonrpc:"2.0"},e),n=JSON.stringify(t);this.socket.send(n)}},{key:"processMessage",value:function processMessage(messageText){var message;try{message=eval("(".concat(messageText,")"))}catch(err){return void this.warnInvalidJsonRcpMessage("Message is no valid JSON",messageText)}if("2.0"===message.jsonrpc&&"number"===typeof message.id){var job=this.activeJobs[message.id];if(job)if(message.response||null===message.response)job.notifyDone(message.response),delete this.activeJobs[message.id];else if(message.progress)message.progress.id=message.id,job.notifyInProgress(message.progress);else{if(!message.error)return void this.warnInvalidJsonRcpMessage('Method is neither a "response", "progress", nor "error"',messageText);job.notifyFailed(message.error),delete this.activeJobs[message.id]}else this.warnInvalidJsonRcpMessage('Method with "id"='.concat(message.id," has no associated job"),messageText)}else this.warnInvalidJsonRcpMessage("Message is not JSON-RCP 2.0 compliant",messageText)}},{key:"warnInvalidJsonRcpMessage",value:function(e,t){if(this.onWarning){var n="Received invalid JSON-RCP message from Cate service. ".concat(e,". Ignoring it.\n--------------------\n").concat(t,"\n--------------------");this.onWarning({type:"warning",message:n})}}},{key:"warn",value:function(e){this.onWarning&&this.onWarning({type:"warning",message:e})}},{key:"newId",value:function(){return this.currentMessageId++}},{key:"isOpen",get:function(){return this.socket.readyState===WebSocket.OPEN}}]),WebAPIClientImpl}(),JobImpl=function(){function e(t,n,a){Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,e),this.webAPIClient=void 0,this.request=void 0,this.status=void 0,this.onProgress=void 0,this.onResolve=void 0,this.onReject=void 0,this.transformer=void 0,this.webAPIClient=t,this.request=n,this.status=_Job__WEBPACK_IMPORTED_MODULE_3__.a.NEW,this.transformer=a}return Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(e,[{key:"getRequest",value:function(){return this.request}},{key:"getStatus",value:function(){return this.status}},{key:"isCancelled",value:function(){return this.status===_Job__WEBPACK_IMPORTED_MODULE_3__.a.CANCELLED}},{key:"cancel",value:function(e,t){this.webAPIClient.call(CANCEL_METHOD,{id:this.request.id}).then(e||function(){},t||function(){})}},{key:"invoke",value:function(e){var t=this,n=new Promise(function(n,a){t.setHandlers(e,n,a),t.sendMessage(),t.setStatus(_Job__WEBPACK_IMPORTED_MODULE_3__.a.SUBMITTED)}.bind(this));return n.getJob=this.getJob.bind(this),n.getJobId=this.getJobId.bind(this),n}},{key:"notifyInProgress",value:function(e){this.setStatus(_Job__WEBPACK_IMPORTED_MODULE_3__.a.IN_PROGRESS),this.onProgress&&this.onProgress(e)}},{key:"notifyDone",value:function(e){this.setStatus(_Job__WEBPACK_IMPORTED_MODULE_3__.a.DONE),this.onResolve&&this.onResolve(this.transformer?this.transformer(e):e)}},{key:"notifyFailed",value:function(e){this.setStatus(e.code===ERROR_CODE_CANCELLED?_Job__WEBPACK_IMPORTED_MODULE_3__.a.CANCELLED:_Job__WEBPACK_IMPORTED_MODULE_3__.a.FAILED),this.onReject&&this.onReject(e)}},{key:"getJob",value:function(){return this}},{key:"getJobId",value:function(){return this.getRequest().id}},{key:"setHandlers",value:function(e,t,n){this.onProgress=e,this.onResolve=t,this.onReject=n}},{key:"sendMessage",value:function(){this.webAPIClient.sendMessage(this.request)}},{key:"setStatus",value:function(e){this.status=e}}]),e}();function getJobFailureIntentName(e){if(e)switch(e.code){case ERROR_CODE_INVALID_PARAMS:case ERROR_CODE_CANCELLED:return _blueprintjs_core__WEBPACK_IMPORTED_MODULE_2__.Intent.PRIMARY;case ERROR_CODE_OS_ERROR:default:return _blueprintjs_core__WEBPACK_IMPORTED_MODULE_2__.Intent.WARNING}return _blueprintjs_core__WEBPACK_IMPORTED_MODULE_2__.Intent.WARNING}function getJobFailureIconName(e){if(e){if(e.data){if("cate.core.ds.NetworkError"===e.data.exception)return"offline";if("cate.core.ds.DataAccessError"===e.data.exception)return"database"}switch(e.code){case ERROR_CODE_INVALID_PARAMS:return"manually-entered-data";case ERROR_CODE_CANCELLED:return"hand";default:return"error"}}return"warning-sign"}function getJobFailureTitle(e){if(e){if(console.log(e),e.data){if("cate.core.ds.NetworkError"===e.data.exception)return"Network Problem";if("cate.core.ds.DataAccessError"===e.data.exception)return"Data Access Error"}switch(e.code){case ERROR_CODE_INVALID_PARAMS:return"Invalid Input";case ERROR_CODE_OUT_OF_MEMORY:return"Out-Of-Memory Error";case ERROR_CODE_OS_ERROR:return"External Problem";case ERROR_CODE_CANCELLED:return"Task Cancelled";case ERROR_CODE_METHOD_NOT_FOUND:return"Internal Error (Method Not Found)";case ERROR_CODE_INVALID_REQUEST:return"Internal Error (Invalid Request)";case ERROR_CODE_INVALID_RESPONSE:return"Internal Error (Invalid Response)";case ERROR_CODE_METHOD_ERROR:return"Operation Error"}}return"Unknown Error"}var NON_DEVELOPER_ERRORS=[ERROR_CODE_INVALID_PARAMS,ERROR_CODE_CANCELLED,ERROR_CODE_OS_ERROR,ERROR_CODE_OUT_OF_MEMORY];function isDeveloperError(e){return NON_DEVELOPER_ERRORS.indexOf(e.code)<0}var USER_ERRORS=[ERROR_CODE_INVALID_PARAMS,ERROR_CODE_CANCELLED];function isUserError(e){return USER_ERRORS.indexOf(e.code)>=0}},38:function(e,t,n){"use strict";n.d(t,"g",(function(){return a.a})),n.d(t,"e",(function(){return r.b})),n.d(t,"d",(function(){return r.a})),n.d(t,"o",(function(){return r.h})),n.d(t,"k",(function(){return r.d})),n.d(t,"j",(function(){return r.c})),n.d(t,"l",(function(){return r.e})),n.d(t,"m",(function(){return r.f})),n.d(t,"n",(function(){return r.g})),n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return y})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return _})),n.d(t,"f",(function(){return C}));var a=n(101),r=n(327),o=n(15),i=n(16),l=function(){function e(t){Object(o.a)(this,e),this.webAPIClient=void 0,this.webAPIClient=t}return Object(i.a)(e,[{key:"getDataStores",value:function(){return this.webAPIClient.call("get_data_stores",[])}},{key:"getDataSources",value:function(t,n){return this.webAPIClient.call("get_data_sources",[t],n,e.responseToDataSources)}},{key:"getDataSourceMetaInfo",value:function(t,n,a){return this.webAPIClient.call("get_data_source_meta_info",[t,n],a,e.responseToMetaInfo)}},{key:"addLocalDataSource",value:function(e,t,n){return this.webAPIClient.call("add_local_data_source",[e,t],n)}},{key:"removeLocalDataSource",value:function(e,t,n){return this.webAPIClient.call("remove_local_data_source",[e,t],n)}},{key:"extractPixelValues",value:function(e,t,n,a){return this.webAPIClient.call("extract_pixel_values",[e,t,n,a])}}],[{key:"responseToDataSources",value:function(e){return e.map((function(e,t){return console.debug("dataSources[".concat(t,"]:"),e),{id:e.id,title:e.title,dataType:e.data_type||"dataset",capabilities:e.verification_flags,metaInfoStatus:"init"}}))}},{key:"responseToMetaInfo",value:function(e){return e}}]),e}();function c(e){return e?e.map(s):null}function s(e){return{qualifiedName:e.qualified_name,name:e.name||e.qualified_name,description:e.header&&e.header.description||null,tags:e.header&&e.header.tags||[],hasMonitor:e.has_monitor||!1,inputs:e.inputs.map(u),outputs:e.outputs.map(d)}}function u(e){return{name:e.name,dataType:e.data_type,description:e.description||null,units:e.units,password:e.password,defaultValue:e.default_value,nullable:e.nullable||null===e.default_value,valueSet:e.value_set,valueSetSource:e.value_set_source,valueRange:e.value_range,scriptLang:e.script_lang,fileOpenMode:e.file_open_mode,fileFilters:e.file_filters,fileProps:e.file_props,noUI:e.no_ui||e.step_id}}function d(e){return{name:e.name,dataType:e.data_type,description:e.description||null}}var p=function(){function e(t){Object(o.a)(this,e),this.webAPIClient=void 0,this.webAPIClient=t}return Object(i.a)(e,[{key:"getOperations",value:function(){return this.webAPIClient.call("get_operations",[],null,c)}}]),e}(),h=n(6),f=n(18),m=n(10);function b(e){return e?{baseDir:e.base_dir,description:e.description,isScratch:e.is_scratch,isModified:e.is_modified,isSaved:e.is_saved,workflow:e.workflow,resources:(t=e.resources,(t||m.a).map((function(e){return e.variables?Object(h.a)(Object(h.a)({},e),{},{variables:(t=e.variables,(t||m.a).map((function(e){var t=e.attributes||m.b,n=t.valid_min,a=t.valid_max,r=t.valid_range,o=Object(f.b)(r)&&2===r.length;n=!Object(f.d)(n)&&o&&Object(f.d)(r[0])?r[0]:n,a=!Object(f.d)(a)&&o&&Object(f.d)(r[1])?r[1]:a;var i=t.units;return"kelvin"!==i&&"Kelvin"!==i||((!Object(f.d)(n)||n<270)&&(n=270),(!Object(f.d)(a)||a>310)&&(a=310)),Object(h.a)(Object(h.a)({},e),{},{units:i,validMin:n,validMax:a})})))}):e;var t})))}:null;var t}function v(e){return[b(e[0]),e[1]]}var y=function(){function e(t){Object(o.a)(this,e),this.webAPIClient=void 0,this.webAPIClient=t}return Object(i.a)(e,[{key:"listWorkspaces",value:function(){return this.webAPIClient.call("list_workspace_names",[])}},{key:"newWorkspace",value:function(e){return this.webAPIClient.call("new_workspace",[e],null,b)}},{key:"openWorkspace",value:function(e,t){return this.webAPIClient.call("open_workspace",[e],t,b)}},{key:"closeWorkspace",value:function(e){return this.webAPIClient.call("close_workspace",[e])}},{key:"saveWorkspace",value:function(e,t){return this.webAPIClient.call("save_workspace",[e],t,b)}},{key:"saveWorkspaceAs",value:function(e,t,n){return this.webAPIClient.call("save_workspace_as",[e,t],n,b)}},{key:"cleanWorkspace",value:function(e){return this.webAPIClient.call("clean_workspace",[e],null,b)}},{key:"setWorkspaceResource",value:function(e,t,n,a,r,o){return this.webAPIClient.call("set_workspace_resource",[e,t,n,a,r],o,v)}},{key:"setWorkspaceResourcePersistence",value:function(e,t,n){return this.webAPIClient.call("set_workspace_resource_persistence",[e,t,n],null,b)}},{key:"runOpInWorkspace",value:function(e,t,n,a){return this.webAPIClient.call("run_op_in_workspace",[e,t,n],a)}},{key:"renameWorkspaceResource",value:function(e,t,n){return this.webAPIClient.call("rename_workspace_resource",[e,t,n],null,b)}},{key:"deleteWorkspace",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.webAPIClient.call("delete_workspace",[e,t],null,b)}},{key:"deleteWorkspaceResource",value:function(e,t){return this.webAPIClient.call("delete_workspace_resource",[e,t],null,b)}},{key:"getWorkspaceVariableStatistics",value:function(e,t,n,a,r){return this.webAPIClient.call("get_workspace_variable_statistics",[e,t,n,a],r)}}]),e}();function g(e){return e?{dataStoresPath:e.data_stores_path,useWorkspaceImageryCache:e.use_workspace_imagery_cache,resourceNamePattern:e.default_res_pattern,proxyUrl:e.http_proxy}:null}var E=function(){function e(t){Object(o.a)(this,e),this.webAPIClient=void 0,this.webAPIClient=t}return Object(i.a)(e,[{key:"getBackendConfig",value:function(){return this.webAPIClient.call("get_config",[],null,g)}},{key:"setBackendConfig",value:function(e){return this.webAPIClient.call("set_config",[(t=e,t?{data_stores_path:t.dataStoresPath,use_workspace_imagery_cache:t.useWorkspaceImageryCache,default_res_pattern:t.resourceNamePattern,http_proxy:t.proxyUrl}:{})]);var t}}]),e}();function O(e){return e?e.map((function(e){return{name:e[0],description:e[1],colorMaps:e[2].map((function(e){return{name:e[0],imageData:e[1]}}))}})):null}var _=function(){function e(t){Object(o.a)(this,e),this.webAPIClient=void 0,this.webAPIClient=t}return Object(i.a)(e,[{key:"getColorMaps",value:function(){return this.webAPIClient.call("get_color_maps",[],null,O)}}]),e}(),C=function(){function e(t){Object(o.a)(this,e),this.webAPIClient=void 0,this.webAPIClient=t}return Object(i.a)(e,[{key:"updateFileNode",value:function(e){return this.webAPIClient.call("update_file_node",[e])}}]),e}()},41:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(70),r=n(15),o=n(16),i=n(19),l=n(20),c=n(2),s=n(5),u=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return this.props.isOpen?c.createElement(s.Dialog,{isOpen:this.props.isOpen,title:this.props.title,icon:this.props.icon,onClose:this.props.onCancel,autoFocus:!0,canEscapeKeyClose:!0,canOutsideClickClose:!1,enforceFocus:!0,style:this.props.style},this.renderDialogContent(),this.renderDialogFooter()):null}},{key:"renderDialogContent",value:function(){return c.createElement("div",{className:s.Classes.DIALOG_BODY},this.props.renderBody?this.props.renderBody():this.props.children)}},{key:"renderDialogFooter",value:function(){return c.createElement("div",{className:s.Classes.DIALOG_FOOTER},c.createElement("div",{className:s.Classes.DIALOG_FOOTER_ACTIONS},this.props.renderActions?this.props.renderActions():this.renderActions()))}},{key:"renderActions",value:function(){var e,t=!this.props.canConfirm||this.props.canConfirm();this.props.noCancelButton||(e=c.createElement(s.AnchorButton,{key:"cancel",onClick:this.props.onCancel},"Cancel"));var n,r=c.createElement(s.AnchorButton,{key:"confirm",onClick:this.props.onConfirm,intent:s.Intent.PRIMARY,disabled:!t,icon:this.props.confirmIconName},this.props.confirmTitle||"OK");return this.props.confirmTooltip&&(r=c.createElement(s.Tooltip,{key:"confirmTooltip",content:this.props.confirmTooltip},r)),this.props.renderExtraActions&&(n=this.props.renderExtraActions()),n?[e].concat(Object(a.a)(n),[r]):[e,r]}}]),n}(c.Component)},420:function(e,t,n){e.exports=n.p+"static/media/cate-icon-128.4edcc198.png"},424:function(e){e.exports=JSON.parse('{"ecvs":{"aerosol":{"group":"atmosphere","color":"ecv_blue","label":"AER"},"cloud":{"group":"atmosphere","color":"ecv_blue","label":"CL"},"ghg":{"group":"atmosphere","color":"ecv_blue","label":"GHG"},"ozone":{"group":"atmosphere","color":"ecv_blue","label":"OZ"},"biomass":{"group":"terrestrial","color":"ecv_orange","label":"BIO"},"fire":{"group":"terrestrial","color":"ecv_orange","label":"FIR"},"glaciers":{"group":"terrestrial","color":"ecv_orange","label":"GLA"},"lc":{"group":"terrestrial","color":"ecv_orange","label":"LC"},"permafrost":{"group":"terrestrial","color":"ecv_orange","label":"PF"},"soilmoisture":{"group":"terrestrial","color":"ecv_orange","label":"SM"},"snow":{"group":"terrestrial","color":"ecv_orange","label":"SNW"},"ghrsst":{"group":"ocean","color":"ecv_green","label":"SST"},"icesheats":{"group":"ocean","color":"ecv_green","label":"IS"},"oc":{"group":"ocean","color":"ecv_green","label":"OC"},"seaice":{"group":"ocean","color":"ecv_green","label":"SI"},"sealevel":{"group":"ocean","color":"ecv_green","label":"SL"},"seasurfacesalinity":{"group":"ocean","color":"ecv_green","label":"SAL"},"sst":{"group":"ocean","color":"ecv_green","label":"SST"}},"colors":{"ecv_deep_space":"#002B40","ecv_deep_space_1":"#2F5D6F","ecv_green":"#248A90","ecv_orange":"#FF902B","ecv_blue":"#32A6DC","esa_teal":"#0BB7A0","esa_teal_55":"#78D4C7","default":"#0BB7A0"},"mappings":{"icesheets_antarctica_gmb":"icesheets","icesheets_greenland_gmb":"icesheets","l3c_cloud":"cloud","l3c_snow":"snow","l4_ghrsst":"sst"}}')},425:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DictValueEditor}));var D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(19),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(20),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),_components_field_Field__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(55),_components_field_TextField__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(52),DictValueEditor=function(e){Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__.a)(n,e);var t=Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__.a)(n);function n(e){var a;return Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__.a)(a)),a}return Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(n,[{key:"onChange",value:function(e){this.props.onChange(this.props.input,e)}},{key:"render",value:function(){var e=Object(_components_field_Field__WEBPACK_IMPORTED_MODULE_6__.c)(this.props.value);return react__WEBPACK_IMPORTED_MODULE_5__.createElement(_components_field_TextField__WEBPACK_IMPORTED_MODULE_7__.a,{value:e,validator:validateDictText,size:36,placeholder:"Enter key-value pairs (Python), separated by comma",onChange:this.onChange,style:n.TEXT_FIELD_STYLE,nullable:this.props.input.nullable})}}]),n}(react__WEBPACK_IMPORTED_MODULE_5__.Component);function validateDictText(value){if(value&&""!==value.trim()){var None=null,True=!0,False=!1;eval("var ".concat(value,";"))}}DictValueEditor.TEXT_FIELD_STYLE={flexGrow:1}},426:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LiteralValueEditor}));var D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(19),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(20),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),_components_field_Field__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(55),_components_field_TextField__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(52),LiteralValueEditor=function(e){Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__.a)(n,e);var t=Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__.a)(n);function n(e){var a;return Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__.a)(a)),a}return Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(n,[{key:"onChange",value:function(e){this.props.onChange(this.props.input,e)}},{key:"render",value:function(){var e=Object(_components_field_Field__WEBPACK_IMPORTED_MODULE_6__.c)(this.props.value);return react__WEBPACK_IMPORTED_MODULE_5__.createElement(_components_field_TextField__WEBPACK_IMPORTED_MODULE_7__.a,{value:e,validator:this.props.validator||validatePythonLiteralText,size:36,placeholder:this.props.placeholder||"Enter constant (Python) literal",onChange:this.onChange,style:n.TEXT_FIELD_STYLE})}}]),n}(react__WEBPACK_IMPORTED_MODULE_5__.Component);function validatePythonLiteralText(value){if(value&&""!==value.trim()){var None=null,True=!0,False=!1;eval(value)}}LiteralValueEditor.TEXT_FIELD_STYLE={flexGrow:1}},428:function(module,__webpack_exports__,__webpack_require__){"use strict";var D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(19),D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(20),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),react_redux__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(26),_actions__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(7),_selectors__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(10),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(5),_common_types__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(18);function mapStateToProps(e,t){return{view:t.view,baseUrl:_selectors__WEBPACK_IMPORTED_MODULE_8__.fc(e),baseDir:_selectors__WEBPACK_IMPORTED_MODULE_8__.kc(e),animationResources:_selectors__WEBPACK_IMPORTED_MODULE_8__.g(e),mplWebSocketUrl:_selectors__WEBPACK_IMPORTED_MODULE_8__.N(e)}}var AnimationView=function(_React$Component){Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__.a)(AnimationView,_React$Component);var _super=Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__.a)(AnimationView);function AnimationView(e){var t;return Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,AnimationView),(t=_super.call(this,e)).divElement=void 0,t.state={},t.divElement=null,t.onRef=t.onRef.bind(Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_2__.a)(t)),t}return Object(D_Projects_cate_app_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(AnimationView,[{key:"componentWillMount",value:function(){var e=this;this.props.view.data.innerHTML||this.state.loading||this.setState({loading:!0},(function(){e.props.dispatch(_actions__WEBPACK_IMPORTED_MODULE_7__.Zb(e.props.view.id,e.props.view.data.resourceId))}))}},{key:"onRef",value:function onRef(divElement){if(this.divElement=divElement,divElement&&this.props.view.data.innerHTML)for(var elements=divElement.getElementsByTagName("script"),i=0;i<elements.length;i++){var script=elements[i].innerHTML;try{eval("eval")(script)}catch(e){console.error(e)}}}},{key:"render",value:function(){if(!this.getAnimationResource())return react__WEBPACK_IMPORTED_MODULE_5__.createElement(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_9__.Card,null,"Animation not found.");var e=this.props.view.data,t=e.innerHTML,n=e.status;return t?react__WEBPACK_IMPORTED_MODULE_5__.createElement("div",{style:AnimationView.DIV_STYLE,dangerouslySetInnerHTML:{__html:t},ref:this.onRef}):Object(_common_types__WEBPACK_IMPORTED_MODULE_10__.d)(n)&&(n<200||n>=300)?react__WEBPACK_IMPORTED_MODULE_5__.createElement(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_9__.Card,null,"`Error loading animation (status $",e.status,"`)"):this.state.loading?react__WEBPACK_IMPORTED_MODULE_5__.createElement(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_9__.Card,null,"Loading animation..."):react__WEBPACK_IMPORTED_MODULE_5__.createElement(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_9__.Card,null,"???")}},{key:"getAnimationResource",value:function(){var e=this.props.view.data;return this.props.animationResources.find((function(t){return t.id===e.resourceId}))}}]),AnimationView}(react__WEBPACK_IMPORTED_MODULE_5__.Component);AnimationView.DIV_STYLE={width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},__webpack_exports__.a=Object(react_redux__WEBPACK_IMPORTED_MODULE_6__.b)(mapStateToProps)(AnimationView)},429:function(e,t,n){e.exports=n.p+"static/media/cate-icon-512.bf0a1397.png"},449:function(e,t,n){e.exports=n(798)},45:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"m",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"s",(function(){return i})),n.d(t,"o",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"r",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"p",(function(){return f})),n.d(t,"q",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"t",(function(){return v})),n.d(t,"u",(function(){return y})),n.d(t,"w",(function(){return g})),n.d(t,"v",(function(){return E})),n.d(t,"i",(function(){return O})),n.d(t,"h",(function(){return _})),n.d(t,"g",(function(){return C})),n.d(t,"j",(function(){return k})),n.d(t,"n",(function(){return w})),n.d(t,"x",(function(){return S}));var a="bool",r="int",o="float",i="str",l="numpy.ndarray",c="xarray.core.dataset.Dataset",s="xarray.core.dataarray.DataArray",u="pandas.core.frame.DataFrame",d="pandas.core.series.Series",p="cate.core.types.DatasetLike",h="cate.core.types.DataFrameLike",f="cate.core.types.PointLike",m="cate.core.types.PolygonLike",b="cate.core.types.GeometryLike",v="cate.core.types.TimeLike",y="cate.core.types.TimeRangeLike",g="cate.core.types.VarName",E="cate.core.types.VarNamesLike",O="cate.core.types.DimName",_="cate.core.types.DimNamesLike",C="cate.core.types.DictLike",k="cate.core.types.FileLike",w="cate.core.types.Literal";function S(e,t){if(!e||!t)return!1;if(e===t)return!0;switch(e){case"object":case"cate.core.types.Arbitrary":return!0;case w:return t===i;case a:return t===r||t===o;case r:return t===a;case o:return t===a||t===r;case l:return t===s;case u:return t===h||"geopandas.geodataframe.GeoDataFrame"===t||"cate.core.types.GeoDataFrame"===t;case h:return t===u||"geopandas.geodataframe.GeoDataFrame"===t||"cate.core.types.GeoDataFrame"===t||t===c||t===p;case"geopandas.geodataframe.GeoDataFrame":return"cate.core.types.GeoDataFrame"===t;case c:return t===p;case p:return t===c||t===u;case d:return"geopandas.geoseries.GeoSeries"===t;case g:case E:case O:case _:case C:case k:case v:case y:return t===i;case f:return t===i||"shapely.geometry.point.Point"===t;case m:return t===i||"shapely.geometry.polygon.Polygon"===t;case b:return t===i||t===f||t===m||"shapely.geometry.base.BaseGeometry"===t||"shapely.geometry.point.Point"===t||"shapely.geometry.multipoint.MultiPoint"===t||"shapely.geometry.linestring.LineString"===t||"shapely.geometry.multilinestring.MultiLineString"===t||"shapely.geometry.polygon.Polygon"===t||"shapely.geometry.multipolygon.multiPolygon"===t||"shapely.geometry.collection.GeometryCollection"===t}return!1}},46:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var a,r=n(15),o=n(16),i=n(19),l=n(20),c=n(2);!function(e){e[e.SINGLE=0]="SINGLE",e[e.MULTIPLE=1]="MULTIPLE"}(a||(a={}));var s=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"handleClick",value:function(e,t,n){if(2!==e.detail){if(this.props.onSelection){var r,o=d(this.props.selection);if(this.props.selection){var i=this.props.selectionMode||a.SINGLE,l=o.findIndex((function(e){return e===n}));l>=0?(r=o.slice()).splice(l,1):i===a.SINGLE?r=[n]:i===a.MULTIPLE&&(r=o.slice()).push(n)}else r=[n];this.props.onSelection(r,o)}this.props.onItemClick&&this.props.onItemClick(this.props.items[t],t)}}},{key:"handleDoubleClick",value:function(e,t){this.props.onItemDoubleClick&&this.props.onItemDoubleClick(this.props.items[t],t)}},{key:"render",value:function(){var e=this,t=this.props.items;if(!t)return null;for(var n=new Set(d(this.props.selection)),a=this.props.getItemKey||function(e,t){return t},r=this.props.renderItem,o=[],i=function(i){var l=t[i],s=a(l,i),u=r(l,i),d=n.has(s)?"cate-selected":null;o.push(c.createElement("li",{key:s,onClick:function(t){return e.handleClick(t,i,s)},onDoubleClick:function(t){return e.handleDoubleClick(t,i)},className:d,style:e.props.itemStyle},u))},l=0;l<t.length;l++)i(l);return c.createElement("ul",{className:"cate-list-box",style:this.props.style},o)}}]),n}(c.PureComponent),u=[];function d(e){return null===e||"undefined"===typeof e?u:e.constructor===Array?e:[e]}},473:function(e,t){},475:function(e,t){},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"m",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return y})),n.d(t,"l",(function(){return g}));var a=n(70),r=n(6),o=n(66),i=(n(18),{name:"All files",extensions:["*"]});function l(e,t,n){return""===t?Object(r.a)(Object(r.a)(Object(r.a)({},e),n),{},{status:"ready"}):function(e,t,n){if(!e.childNodes)return console.error("_updateFileNode: root node without child nodes"),e;n=n.status?n:Object(r.a)(Object(r.a)({},n),{},{status:"ready"});for(var o=Object(r.a)(Object(r.a)({},e),{},{childNodes:Object(a.a)(e.childNodes)}),i=o,l=function(o){if(!i.childNodes)return console.error("_updateFileNode: no child nodes at index ".concat(o,' in "').concat(t.join("/"),'"')),{v:e};var l=t[o],c=i.childNodes.findIndex((function(e){return 0===l.localeCompare(e.name)}));if(c<0)return console.error('_updateFileNode: invalid path component "'.concat(l,'" at index ').concat(o,' in "').concat(t.join("/"),'"')),{v:e};if(o===t.length-1)i.childNodes[c]=n;else{var s,u=i.childNodes[c];s=u.childNodes?Object(r.a)(Object(r.a)({},u),{},{childNodes:Object(a.a)(u.childNodes)}):Object(r.a)({},u),i.childNodes[c]=s,i=s}},c=0;c<t.length;c++){var s=l(c);if("object"===typeof s)return s.v}return o}(e,t.split("/"),n)}function c(e,t){if(""===t)return[];var n=t.split("/"),a=s(e.childNodes,n);return n.length===a.length?a:null}function s(e,t){for(var n=e,a=[],r=function(e){if(!n)return{v:a};var r=t[e],o=n.find((function(e){return 0===e.name.localeCompare(r)}));if(!o)return{v:a};a.push(o),n=o.childNodes},o=0;o<t.length;o++){var i=r(o);if("object"===typeof i)return i.v}return a}function u(e,t){if(""===t)return e;var n=c(e,t);return n?0===n.length?e:n[n.length-1]:null}function d(e){return e.isDir?"folder-close":"document"}function p(e,t){if(e.isDir){if(!t.isDir)return-1}else if(t.isDir)return 1;return e.name.localeCompare(t.name)}function h(e,t){var n=Object(o.c)(t),r=e.filter((function(e){return!(e===t||e===n||t.startsWith(e+"/"))}));return[].concat(Object(a.a)(r),[t])}function f(e,t){var n=Object(o.c)(t),r=e.filter((function(e){return!(e===t||e===n||e.startsWith(t+"/"))}));return""!==n?[].concat(Object(a.a)(r),[n]):r}function m(e,t,n){return t<e.length&&e[t]===n}function b(e,t){var n=new Set(t.extensions);return n.has("*")?e:e.filter((function(e){if(e.isDir)return!0;var t=Object(o.b)(e.name);return n.has(t)}))}function v(e,t,n,a){if(""===(e=e.trim()))return[];var r;if(n){var i="Windows"===a;r=[];for(var l=null,c="",s=0;s<e.length;s++){var u=e[s];'"'===u||"'"===u?null===l?(l=u,c=""):l===u?l=null:c+=u:" "===u?null===l?""!==c&&(r.push(c),c=""):c+=u:(i||"\\"!==u)&&(c+=u)}""!==c&&r.push(c)}else r=[e];return r.map((function(e){return function(e,t,n){var a=Object(o.d)(e,n);if(e=function(e,t){var n;if("Windows"===t){for(;e.indexOf("\\")>=0;)e=e.replace("\\","/");e.startsWith("//")&&(n="//",e=e.substring(2))}else for(;e.indexOf("\\")>=0;)e=e.replace("\\","");for(;e.startsWith("/");)e=e.substring(1);for(;e.endsWith("/");)e=e.substring(0,e.length-1);for(;e.indexOf("//")>0;)e=e.replace("//","/");return n?n+e:e}(e,n),a)return e;if(""===t)return e;return t+"/"+e}(e,t,a)}))}function y(e,t){return"Windows"===t?(e=e.split("/").join("\\"),Object(o.e)(e)?e:"\\"+e):"/"+e}function g(e,t){return 0===e.length?"":t?e.map((function(e){return function(e){if(e.indexOf(" ")>=0)return e.indexOf('"')>=0?"'".concat(e,"'"):'"'.concat(e,'"');return e}(Object(o.a)(e))})).join(" "):Object(o.a)(e[0])}},52:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(15),r=n(16),o=n(99),i=n(71),l=n(19),c=n(20),s=function(e){Object(l.a)(n,e);var t=Object(c.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"validateValue",value:function(e){if(Object(o.a)(Object(i.a)(n.prototype),"validateValue",this).call(this,e),!e&&!this.props.nullable)throw new Error("Text value expected.")}}]),n}(n(55).a)},55:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f}));var a=n(6),r=n(15),o=n(16),i=n(8),l=n(19),c=n(20),s=n(5),u=n(2),d=n(18);function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return f(e)?Object(d.c)(e.textValue)?e.textValue:"".concat(e.value):Object(d.e)(e)?e:Object(d.c)(e)?"".concat(e):t}var h=function(e){Object(l.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e))._fieldValue=void 0,a._fieldValue=a.toFieldValue(e.value),a.props.uncontrolled&&(a.state=a._fieldValue),a.handleKeyPress=a.handleKeyPress.bind(Object(i.a)(a)),a.handleBlur=a.handleBlur.bind(Object(i.a)(a)),a.handleInputChange=a.handleInputChange.bind(Object(i.a)(a)),a}return Object(o.a)(n,[{key:"getValue",value:function(){return this._fieldValue.value}},{key:"setValue",value:function(e){this.setFieldValue(this.newFieldValueFromValue(e))}},{key:"setValueAndTextValue",value:function(e,t){this.setFieldValue(this.newFieldValueFromValueAndTextValue(e,t))}},{key:"getTextValue",value:function(){return this._fieldValue.textValue||""}},{key:"setTextValue",value:function(e){this.setFieldValue(this.newFieldValueFromTextValue(e))}},{key:"getError",value:function(){return this._fieldValue.error}},{key:"setError",value:function(e){this.setFieldValue(Object(a.a)(Object(a.a)({},this._fieldValue),{},{error:e}))}},{key:"componentWillReceiveProps",value:function(e){this._fieldValue=this.toFieldValue(e.value),this.props.uncontrolled&&this.setState(this._fieldValue)}},{key:"parseValue",value:function(e){return e&&""!==e?e:null}},{key:"formatValue",value:function(e){return Object(d.g)(e)?"":Object(d.e)(e)?e:"".concat(e)}},{key:"validateValue",value:function(e){this.props.validator&&this.props.validator(e)}},{key:"handleKeyPress",value:function(e){this.props.uncontrolled&&13===e.charCode&&this.props.onChange(this.state)}},{key:"handleBlur",value:function(){this.props.uncontrolled&&this.props.onChange(this.state)}},{key:"handleInputChange",value:function(e){var t=e.target.value;this.setTextValue(t||"")}},{key:"newFieldValueFromTextValue",value:function(e){var t,n=null;try{n=this.parseValue(e),this.validateValue(n)}catch(a){n=this._fieldValue?this._fieldValue.value:n,t=a}return{textValue:e,value:n,error:t}}},{key:"newFieldValueFromValue",value:function(e){if(f(e))return Object(a.a)({},e);var t,n;try{t=this.formatValue(e)}catch(r){t="",n=r}try{this.validateValue(e)}catch(r){n=r}return{textValue:t,value:e,error:n}}},{key:"newFieldValueFromValueAndTextValue",value:function(e,t){var n;try{this.validateValue(e)}catch(a){n=a}return{textValue:t,value:e,error:n}}},{key:"toFieldValue",value:function(e){return f(e)?e:Object(d.e)(e)?this.newFieldValueFromTextValue(e):this.newFieldValueFromValue(e)}},{key:"setFieldValue",value:function(e){this._fieldValue=e,this.props.uncontrolled?this.setState(e):this.props.onChange(e)}},{key:"render",value:function(){var e=this.getError(),t=n.ERROR_CLASS+" "+this.props.className,a=n.NOMINAL_CLASS+" "+this.props.className;return u.createElement(s.InputGroup,{value:this.getTextValue(),onChange:this.handleInputChange,onBlur:this.handleBlur,onKeyPress:this.handleKeyPress,type:this.props.type||"text",className:e?t:a,style:this.props.style,size:this.props.size,placeholder:this.props.placeholder,disabled:this.props.disabled})}}]),n}(u.PureComponent);function f(e){return Object(d.c)(e)&&(Object(d.b)(e.textValue)||Object(d.b)(e.value))}h.NOMINAL_CLASS="",h.ERROR_CLASS=s.Classes.INTENT_DANGER},56:function(e,t,n){"use strict";n.d(t,"k",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return E})),n.d(t,"h",(function(){return O}));var a=n(33),r=n(23),o=n(18),i=n(65),l={small:24,medium:48,large:64};function c(e,t){var n={};if(Object(o.e)(e.stroke)||Object(o.d)(e.strokeOpacity)||Object(o.d)(e.strokeWidth)){var a=j("stroke",e,t,i.a),c=r.d.fromCssColorString(a),s=S("strokeWidth",e,t,i.a),u=S("strokeOpacity",e,t,i.a);u>=0&&u<1&&(c=r.d.fromAlpha(c,u)),n.stroke=c,n.strokeWidth=s}if(Object(o.e)(e.fill)||Object(o.d)(e.fillOpacity)){var d=j("fill",e,t,i.a),p=r.d.fromCssColorString(d),h=S("fillOpacity",e,t,i.a);h>=0&&h<1&&(p=r.d.fromAlpha(p,h)),n.fill=p}if(Object(o.e)(e.markerSymbol)||Object(o.e)(e.markerColor)||Object(o.e)(e.markerSize)){var f=j("markerSymbol",e,t,i.a),m=j("markerColor",e,t,i.a),b=j("markerSize",e,t,i.a),v=r.d.fromCssColorString(m),y=l[b]||48,g=new r.s;""===f?n.markerCanvas=g.fromColor(v,y):1===f.length?(n.markerSymbol=f,n.markerCanvas=g.fromText(f,v,y)):(n.markerSymbol=f,Promise.resolve(g.fromMakiIconId(f,v,y)).then((function(e){n.markerCanvas=e}))),n.markerSize=y,n.markerColor=v}return Object(o.e)(e.title)&&(n.title=e.title),Object(o.e)(e.description)&&(n.description=e.description),n}function s(e){return e?e.point?function(e){var t,n,a,i,l=r.p.now(),c=e.outlineColor,s=e.outlineWidth,u=e.pixelSize,d=e.color;if(Object(o.b)(u)){var p=u.getValue(l);t=p<=24?"small":p<=48?"medium":"large"}if(Object(o.b)(d)){var f=d.getValue(l);n=h(f.red,f.green,f.blue)}if(Object(o.b)(c)){var m=c.getValue(l);a=h(m.red,m.green,m.blue)}Object(o.b)(s)&&(i=s.getValue(l));return{markerSize:t,markerColor:n,markerSymbol:void 0,stroke:a,strokeWidth:i}}(e.point):e.billboard?function(e){var t,n,a,i=r.p.now(),l=e.image,c=e.scale,s=e.color;if(Object(o.b)(l)){var u=l.getValue(i);Object(o.e)(u)&&(t=u)}if(Object(o.b)(c)){var d=c.getValue(i);n=d<1?"small":d<2?"medium":"large"}if(Object(o.b)(s)){var p=s.getValue(i);a=h(p.red,p.green,p.blue)}return{markerSymbol:t,markerSize:n,markerColor:a}}(e.billboard):e.label?function(e){var t,n,a,i=r.p.now(),l=e.text&&e.text.getValue(i),c=e.scale&&e.scale.getValue(i),s=e.fillColor&&e.fillColor.getValue(i);Object(o.e)(l)&&(t=l);Object(o.d)(c)&&(n=c<1?"small":c<2?"medium":"large");Object(o.b)(s)&&(a=h(s.red,s.green,s.blue));return{title:t,markerSize:n,markerColor:a}}(e.label):e.polyline?function(e){var t,n,a,i=r.p.now(),l=e.width&&e.width.getValue(i),c=e.material&&e.material.getValue(i),s=c&&c.color;Object(o.b)(l)&&(a=l);Object(o.b)(s)&&(t=h(s.red,s.green,s.blue),n=s.alpha);return{stroke:t,strokeOpacity:n,strokeWidth:a}}(e.polyline):e.polygon?function(e){var t,n,a,l,c,s=r.p.now(),u=e.fill&&e.fill.getValue(s),d=e.material&&e.material.getValue(s),p=d&&d.color,f=e.outline&&e.outline.getValue(s),m=e.outlineColor&&e.outlineColor.getValue(s),b=e.outlineWidth&&e.outlineWidth.getValue(s);Object(o.b)(p)?(l=h(p.red,p.green,p.blue),c=p.alpha):(l=i.a.fill,c=i.a.fillOpacity);Object(o.a)(u)&&!Boolean(u)&&(c=0);Object(o.b)(m)&&(t=h(m.red,m.green,m.blue),n=m.alpha);Object(o.b)(f)&&!m&&(n=0);Object(o.b)(b)&&(a=b);return{fill:l,fillOpacity:c,stroke:t,strokeOpacity:n,strokeWidth:a}}(e.polygon):null:null}function u(e,t){var n,r=Object(a.a)(t);try{for(r.s();!(n=r.n()).done;){d(e,n.value)}}catch(o){r.e(o)}finally{r.f()}}function d(e,t){if(t.point){var n=t.point;Object(o.b)(e.markerColor)&&(n.color=new r.f(e.markerColor)),Object(o.d)(e.markerSize)&&(n.pixelSize=new r.f(e.markerSize/24*16))}else if(t.billboard){var a=t.billboard;Object(o.b)(e.markerCanvas)?a.image=new r.f(e.markerCanvas):(Object(o.b)(e.markerColor)&&(a.color=new r.f(e.markerColor)),Object(o.d)(e.markerSize)&&(a.scale=new r.f(e.markerSize/48)))}else if(t.label){var i=t.label;Object(o.b)(e.title)&&(i.text=new r.f(e.title)),Object(o.b)(e.markerColor)&&(i.fillColor=new r.f(e.markerColor)),Object(o.d)(e.markerSize)&&(i.scale=new r.f(e.markerSize/48))}else if(t.polyline){var l=t.polyline;Object(o.b)(e.stroke)&&(l.material=new r.e(e.stroke)),Object(o.d)(e.strokeWidth)&&(l.width=new r.f(e.strokeWidth))}else if(t.polygon){var c=t.polygon;Object(o.b)(e.fill)&&(c.material=new r.e(e.fill)),Object(o.b)(e.stroke)&&(c.outlineColor=new r.f(e.stroke)),Object(o.d)(e.strokeWidth)&&(c.outlineWidth=new r.f(e.strokeWidth))}}function p(e){if(e<=0)return"00";if(e>=1)return"ff";var t=Math.floor(255.9999*e);return t<=0?"00":t>=255?"ff":t<16?"0"+t.toString(16):t.toString(16)}function h(e,t,n){return"#"+p(e)+p(t)+p(n)}function f(e,t,n){if(!e)return null;if(e.position){var o=r.c.fromCartesian(e.position.getValue(r.p.now()));return m(e,t,n,{type:"Point",coordinates:[r.q.toDegrees(o.longitude),r.q.toDegrees(o.latitude)]})}if(e.polyline){var i,l=e.polyline.positions.getValue(r.p.now()),c=[],s=Object(a.a)(l);try{for(s.s();!(i=s.n()).done;){var u=i.value,d=r.c.fromCartesian(u);c.push([r.q.toDegrees(d.longitude),r.q.toDegrees(d.latitude)])}}catch(O){s.e(O)}finally{s.f()}return m(e,t,n,{type:"LineString",coordinates:c})}if(e.polygon){var p=e.polygon.hierarchy.getValue(r.p.now()),h=p.positions||p,f=p.holes;if(f&&f.length)throw new Error("entityToGeoJson() does not yet support polygons with holes");var b,v=[],y=Object(a.a)(h);try{for(y.s();!(b=y.n()).done;){var g=b.value,E=r.c.fromCartesian(g);v.push([r.q.toDegrees(E.longitude),r.q.toDegrees(E.latitude)])}}catch(O){y.e(O)}finally{y.f()}return v.push([v[0][0],v[0][1]]),m(e,t,n,{type:"Polygon",coordinates:[v]})}throw new Error("entityToGeoJson() called with unsupported entity: ".concat(e.toString()))}function m(e,t,n,a){return{type:"Feature",id:t=t||e.id.toString(),geometry:a,properties:n}}function b(e){if(e.polyline){var t=e.polyline.positions.getValue(r.p.now());return"LINESTRING (".concat(function(e){return _(e).join(", ")}(t),")")}if(e.polygon){var n=e.polygon.hierarchy.getValue(r.p.now()),o=n.positions,i=n.holes,l=_(o);l.length>2&&l.push(l[0]);var c=["(".concat(l.join(", "),")")];if(i&&i.length){var s,u=Object(a.a)(i);try{for(u.s();!(s=u.n()).done;){var d=_(s.value.positions);d.length>2&&d.push(d[0]),c.push("(".concat(d.join(", "),")"))}}catch(y){u.e(y)}finally{u.f()}}return"POLYGON (".concat(c.join(", "),")")}if(e.rectangle){var p=e.rectangle.coordinates.getValue(r.p.now()),h=k(p.west),f=k(p.south),m=k(p.east),b=k(p.north);return"POLYGON ((".concat(h," ").concat(f,", ").concat(m," ").concat(f,", ").concat(m," ").concat(b,", ").concat(h," ").concat(b,", ").concat(h," ").concat(f,"))")}if(e.position){var v=e.position.getValue(r.p.now());return"POINT (".concat(C(v),")")}throw new TypeError("can't understand geometry of selected entity")}function v(e,t,n){var a;if(t){var o=e.scene.globe.ellipsoid,i=e.camera.pickEllipsoid(t,o);if(i&&(a=o.cartesianToCartographic(i))&&n){a={longitude:Math.round(1e4*r.q.toDegrees(a.longitude))/1e4,latitude:Math.round(1e4*r.q.toDegrees(a.latitude))/1e4,height:a.height}}}return a}function y(e,t){var n;if(t){var a=e.canvas.getBoundingClientRect(),o=t.x,i=t.y;o>=a.left&&o<=a.right&&i>=a.top&&i<=a.bottom&&(n=new r.b(o-a.left,i-a.top))}return n}function g(e,t){if(t){var n=e.scene.pick(t);return n&&n.id}}function E(e,t){var n;if(null===t)n=r.D();else{var a="Geographic"===t.tilingScheme?new r.k:new r.B,o=t.ellipsoid&&new r.h(t.ellipsoid.x,t.ellipsoid.y,t.ellipsoid.z);n=new r.z({url:t.url,tilingScheme:a,ellipsoid:o,credit:t.credit,minimumLevel:t.minimumLevel,maximumLevel:t.maximumLevel})}if(e.imageryLayers.length>0){var i=e.imageryLayers.get(0);e.imageryLayers.remove(i)}e.imageryLayers.add(new r.m(n),0)}function O(e,t){for(var n=0;n<e.dataSources.length;n++){var a=e.dataSources.get(n).entities.getById(t);if(a)return a}return null}function _(e){return e.map((function(e){return C(e)}))}function C(e){var t=r.c.fromCartesian(e);return"".concat(k(t.longitude)," ").concat(k(t.latitude))}function k(e){return e*(180/Math.PI)}function w(e,t,n){var r,o=Object(a.a)(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i){var l=i[e];if(t(l))return l}}}catch(c){o.e(c)}finally{o.f()}}function S(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return w(e,o.d,n)}function j(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return w(e,o.e,n)}},63:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(5),r=null;function o(e,t){var n,o,i;r||(r=a.Toaster.create({className:"cate-toaster",position:a.Position.BOTTOM})),"info"===e.type?(n="info-sign",o=a.Intent.NONE,t=t||2500):"success"===e.type?(n="tick",o=a.Intent.SUCCESS,t=t||2500):"notification"===e.type?(n="notifications",o=a.Intent.PRIMARY,t=t||2500):"warning"===e.type?(n="warning-sign",o=a.Intent.WARNING,t=t||6e3):"error"===e.type?(n="error",o=a.Intent.DANGER,t=t||1e4):t=t||5e3,e.action&&(i={onClick:e.action.onClick,text:e.action.text,icon:e.action.icon,href:e.action.href,target:e.action.href?"_blank":void 0}),r.show({message:e.text,icon:n,intent:o,action:i,timeout:t})}},65:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return l}));var a=n(33),r=n(18),o={title:"",description:"",markerSize:"medium",markerSymbol:"",markerColor:"#7e7e7e",stroke:"#555555",strokeOpacity:1,strokeWidth:2,fill:"#555555",fillOpacity:.6};function i(e){var t,n={title:e.title,description:e.description,markerSymbol:e["marker-symbol"],markerSize:e["marker-size"],markerColor:e["marker-color"],stroke:e.stroke,strokeOpacity:e["stroke-opacity"],strokeWidth:e["stroke-width"],fill:e.fill,fillOpacity:e["fill-opacity"]},o={},i=Object(a.a)(Object.getOwnPropertyNames(n));try{for(i.s();!(t=i.n()).done;){var l=t.value;Object(r.b)(n[l])&&(o[l]=n[l])}}catch(c){i.e(c)}finally{i.f()}return o}function l(e){var t,n={title:e.title,description:e.description,"marker-symbol":e.markerSymbol,"marker-size":e.markerSize,"marker-color":e.markerColor,stroke:e.stroke,"stroke-opacity":e.strokeOpacity,"stroke-width":e.strokeWidth,fill:e.fill,"fill-opacity":e.fillOpacity},o={},i=Object(a.a)(Object.getOwnPropertyNames(n));try{for(i.s();!(t=i.n()).done;){var l=t.value;Object(r.b)(n[l])&&(o[l]=n[l])}}catch(c){i.e(c)}finally{i.f()}return o}},66:function(e,t,n){"use strict";function a(e,t){return"Windows"===t&&o(e)||r(e)}function r(e){return e.startsWith("/")}function o(e){return i(e)||l(e)}function i(e){return e.startsWith("//")||e.startsWith("\\\\")}function l(e){return e.length>=2&&/^[a-z]+$/i.test(e[0])&&":"===e[1]&&(2===e.length||"/"===e[2]||"\\"===e[2])}function c(e,t,n){var a=p(e,n),r=p(t,n);return a.length>0&&""===a[a.length-1]&&(a=a.slice(0,a.length-1)),r.length>0&&""===r[0]&&(r=r.slice(1)),d(u(a.concat(r)),n)}function s(e,t,n){if(""===e||e===t)return"";for(var a,r=p(e,n),o=p(t,n),i=r.length,l=o.length,c=Math.max(i,l),s=Math.min(i,l),u=0;u<c;u++){if(u<i&&u<l)if(r[u]!==o[u]){s=u;break}}return s===c?"":(a=l>s?new Array(l-s).fill(".."):[],i>s&&(a=a.concat(r.slice(s))),a.join("/"))}function u(e,t){for(var n=Array(e.length),a=0,r=0;r<e.length;r++){var o=e[r];if("."===o);else if(".."===o)a--;else{if(a<0)return e;n[a]=o,a++}}return a<0?e:n.slice(0,a)}function d(e,t){return e.join("Windows"===t?"\\":"/")}function p(e,t){if("Windows"===t){if(i(e)||l(e)){var n=p(e.substring(2));return 0===n.length?n:[e.substr(0,2)+n[0]].concat(n.slice(1))}return e.split(/[/\\]/)}return e.split("/")}function h(e,t){var n=p(e,t);return n.length>0?d(n.slice(0,n.length-1),t):""}function f(e,t){var n=p(e,t);return n.length>0?n[n.length-1]:e}function m(e){var t=e.lastIndexOf(".");return t>0?e.substring(t+1):""}n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m}))},68:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return l}));n(15);var a="off",r="left",o="right",i="entity",l="layer"},7:function(e,t,n){"use strict";n.d(t,"lb",(function(){return x})),n.d(t,"V",(function(){return M})),n.d(t,"R",(function(){return V})),n.d(t,"S",(function(){return B})),n.d(t,"U",(function(){return W})),n.d(t,"T",(function(){return U})),n.d(t,"kb",(function(){return F})),n.d(t,"hb",(function(){return G})),n.d(t,"wb",(function(){return Y})),n.d(t,"A",(function(){return H})),n.d(t,"db",(function(){return K})),n.d(t,"ub",(function(){return z})),n.d(t,"o",(function(){return q})),n.d(t,"P",(function(){return J})),n.d(t,"Yb",(function(){return X})),n.d(t,"dc",(function(){return Q})),n.d(t,"ec",(function(){return $})),n.d(t,"ad",(function(){return ee})),n.d(t,"Kb",(function(){return ae})),n.d(t,"ud",(function(){return re})),n.d(t,"dd",(function(){return ie})),n.d(t,"Tb",(function(){return le})),n.d(t,"sc",(function(){return se})),n.d(t,"Ac",(function(){return ue})),n.d(t,"Xb",(function(){return de})),n.d(t,"Ad",(function(){return fe})),n.d(t,"Wc",(function(){return me})),n.d(t,"Bd",(function(){return be})),n.d(t,"rd",(function(){return ve})),n.d(t,"Eb",(function(){return ye})),n.d(t,"jd",(function(){return ge})),n.d(t,"G",(function(){return Oe})),n.d(t,"H",(function(){return _e})),n.d(t,"Cc",(function(){return Ce})),n.d(t,"Dc",(function(){return we})),n.d(t,"jb",(function(){return Se})),n.d(t,"td",(function(){return Ie})),n.d(t,"a",(function(){return Pe})),n.d(t,"c",(function(){return De})),n.d(t,"z",(function(){return Te})),n.d(t,"qb",(function(){return Le})),n.d(t,"rb",(function(){return Ae})),n.d(t,"sb",(function(){return Re})),n.d(t,"yb",(function(){return Ne})),n.d(t,"Ab",(function(){return xe})),n.d(t,"Bb",(function(){return Me})),n.d(t,"rc",(function(){return Ve})),n.d(t,"xd",(function(){return Be})),n.d(t,"yd",(function(){return We})),n.d(t,"zd",(function(){return Ue})),n.d(t,"cc",(function(){return Fe})),n.d(t,"Qc",(function(){return Ge})),n.d(t,"gb",(function(){return Ye})),n.d(t,"eb",(function(){return He})),n.d(t,"fb",(function(){return Ke})),n.d(t,"Lc",(function(){return Xe})),n.d(t,"Kc",(function(){return Ze})),n.d(t,"Bc",(function(){return Qe})),n.d(t,"mc",(function(){return et})),n.d(t,"zb",(function(){return tt})),n.d(t,"qc",(function(){return nt})),n.d(t,"pb",(function(){return at})),n.d(t,"Pc",(function(){return rt})),n.d(t,"Ic",(function(){return ot})),n.d(t,"Hc",(function(){return it})),n.d(t,"ld",(function(){return lt})),n.d(t,"Ub",(function(){return ct})),n.d(t,"F",(function(){return st})),n.d(t,"xb",(function(){return ut})),n.d(t,"B",(function(){return dt})),n.d(t,"X",(function(){return pt})),n.d(t,"W",(function(){return ht})),n.d(t,"Z",(function(){return ft})),n.d(t,"ic",(function(){return bt})),n.d(t,"nc",(function(){return vt})),n.d(t,"vc",(function(){return gt})),n.d(t,"Nb",(function(){return Et})),n.d(t,"jc",(function(){return Ot})),n.d(t,"oc",(function(){return Ct})),n.d(t,"Ob",(function(){return kt})),n.d(t,"Jb",(function(){return wt})),n.d(t,"Gb",(function(){return St})),n.d(t,"Mb",(function(){return jt})),n.d(t,"xc",(function(){return It})),n.d(t,"wc",(function(){return Pt})),n.d(t,"Vc",(function(){return Lt})),n.d(t,"Uc",(function(){return At})),n.d(t,"bd",(function(){return Rt})),n.d(t,"cd",(function(){return Nt})),n.d(t,"tc",(function(){return xt})),n.d(t,"Sb",(function(){return Mt})),n.d(t,"pd",(function(){return Vt})),n.d(t,"fd",(function(){return Bt})),n.d(t,"uc",(function(){return Wt})),n.d(t,"O",(function(){return Ut})),n.d(t,"N",(function(){return Ft})),n.d(t,"Xc",(function(){return Gt})),n.d(t,"Tc",(function(){return Yt})),n.d(t,"Cb",(function(){return Ht})),n.d(t,"Gc",(function(){return Kt})),n.d(t,"Jc",(function(){return zt})),n.d(t,"Oc",(function(){return qt})),n.d(t,"Nc",(function(){return Jt})),n.d(t,"Sc",(function(){return Xt})),n.d(t,"Rc",(function(){return Zt})),n.d(t,"e",(function(){return Qt})),n.d(t,"d",(function(){return $t})),n.d(t,"D",(function(){return en})),n.d(t,"l",(function(){return tn})),n.d(t,"ab",(function(){return nn})),n.d(t,"f",(function(){return an})),n.d(t,"r",(function(){return rn})),n.d(t,"Db",(function(){return on})),n.d(t,"yc",(function(){return ln})),n.d(t,"Ib",(function(){return cn})),n.d(t,"Hb",(function(){return sn})),n.d(t,"qd",(function(){return un})),n.d(t,"Fb",(function(){return dn})),n.d(t,"hc",(function(){return pn})),n.d(t,"Q",(function(){return hn})),n.d(t,"K",(function(){return fn})),n.d(t,"I",(function(){return mn})),n.d(t,"J",(function(){return bn})),n.d(t,"L",(function(){return vn})),n.d(t,"n",(function(){return yn})),n.d(t,"ib",(function(){return gn})),n.d(t,"ob",(function(){return En})),n.d(t,"Zc",(function(){return On})),n.d(t,"Ec",(function(){return _n})),n.d(t,"Fc",(function(){return Cn})),n.d(t,"kc",(function(){return kn})),n.d(t,"sd",(function(){return wn})),n.d(t,"vb",(function(){return Sn})),n.d(t,"bc",(function(){return In})),n.d(t,"bb",(function(){return Pn})),n.d(t,"Zb",(function(){return Dn})),n.d(t,"M",(function(){return Tn})),n.d(t,"b",(function(){return Ln})),n.d(t,"y",(function(){return An})),n.d(t,"mb",(function(){return Rn})),n.d(t,"nb",(function(){return Nn})),n.d(t,"q",(function(){return xn})),n.d(t,"p",(function(){return Mn})),n.d(t,"C",(function(){return Vn})),n.d(t,"E",(function(){return Bn})),n.d(t,"Mc",(function(){return Wn})),n.d(t,"pc",(function(){return Un})),n.d(t,"gc",(function(){return Fn})),n.d(t,"fc",(function(){return Gn})),n.d(t,"vd",(function(){return Yn})),n.d(t,"wd",(function(){return Kn})),n.d(t,"Yc",(function(){return qn})),n.d(t,"zc",(function(){return Jn})),n.d(t,"cb",(function(){return Xn})),n.d(t,"ac",(function(){return Zn})),n.d(t,"md",(function(){return Qn})),n.d(t,"Vb",(function(){return $n})),n.d(t,"Y",(function(){return ea})),n.d(t,"m",(function(){return ta})),n.d(t,"tb",(function(){return na})),n.d(t,"nd",(function(){return ra})),n.d(t,"od",(function(){return oa})),n.d(t,"s",(function(){return ia})),n.d(t,"lc",(function(){return la})),n.d(t,"t",(function(){return ca})),n.d(t,"g",(function(){return sa})),n.d(t,"ed",(function(){return ua})),n.d(t,"v",(function(){return da})),n.d(t,"i",(function(){return pa})),n.d(t,"gd",(function(){return ha})),n.d(t,"w",(function(){return fa})),n.d(t,"j",(function(){return ma})),n.d(t,"hd",(function(){return ba})),n.d(t,"x",(function(){return va})),n.d(t,"k",(function(){return ya})),n.d(t,"kd",(function(){return ga})),n.d(t,"u",(function(){return Ea})),n.d(t,"h",(function(){return Oa})),n.d(t,"id",(function(){return _a})),n.d(t,"Lb",(function(){return Ca})),n.d(t,"Rb",(function(){return ka})),n.d(t,"Qb",(function(){return wa})),n.d(t,"Cd",(function(){return Sa})),n.d(t,"Pb",(function(){return ja})),n.d(t,"Wb",(function(){return La}));var a=n(6),r=n(33),o=n(44),i=n(59),l=n.n(i),c=n(78),s=n(23),u=n(219),d=n.n(u),p=n(807),h=n(29),f=n(45),m=n(112),b=n(18),v=n(56),y=n(90),g=n(51),E=n(120);function O(e,t){return!!e[t]}function _(e,t,n){return Object(a.a)(Object(a.a)({},e),{},Object(o.a)({},t,{isValueUsed:!0,constantValue:n,resourceName:null}))}function C(e,t,n){return Object(a.a)(Object(a.a)({},e),{},Object(o.a)({},t,{isValueUsed:!1,constantValue:null,resourceName:n}))}var k=n(223),w=n(226),S=n(117),j=n(10),I=n(25),P=n(63),D=n(38),T=n(224),L=n(170),A=n(118),R=n(73),N=Object(S.b)(),x="UPDATE_INITIAL_STATE",M="SET_WEBAPI_STATUS",V="SET_WEBAPI_AUTO_STOP_INFO",B="SET_WEBAPI_CLIENT",W="SET_WEBAPI_SERVICE_URL",U="SET_WEBAPI_SERVICE_INFO",F="UPDATE_HUB_STATUS",G="UPDATE_DIALOG_STATE",Y="UPDATE_TASK_STATE",H="REMOVE_TASK_STATE",K="UPDATE_CONTROL_STATE",z="UPDATE_SESSION_STATE",q="INVOKE_CTX_OPERATION",J="SET_USER_PROFILE";function X(e){return function(){var t=Object(c.a)(l.a.mark((function t(n){var a,r,o,i,s,u,d,p;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=function(e){return e&&"Running"===e.phase},n(ee("login")),e.authenticated){t.next=5;break}return t.next=5,e.login({redirectUri:window.location.origin+"/hub",prompt:"login",maxAge:86400});case 5:return t.next=7,e.loadUserProfile();case 7:return a=t.sent,n(Z(a)),r=e.token,o=new L.a,t.prev=11,t.next=14,o.getServiceCount();case 14:i=t.sent,t.next=22;break;case 17:return t.prev=17,t.t0=t.catch(11),n(ee("error")),Pa(t.t0,"Failed fetching server status."),t.abrupt("return");case 22:if(!(i>=R.b.webApi.maxNumUsers)){t.next=26;break}return Object(P.a)({type:"error",text:"Too many concurrent users. Please try again later!"}),n(ee("error")),t.abrupt("return");case 26:return n(ee("launching")),t.prev=27,t.next=30,o.startService(a.username,r);case 30:s=t.sent,t.next=38;break;case 33:return t.prev=33,t.t1=t.catch(27),n(ee("error")),Pa(t.t1,"Launching of Cate service failed."),t.abrupt("return");case 38:return t.next=40,o.getPodStatus(a.username,r);case 40:d=t.sent,u(d)?n(ae(s)):(p=function(e){Pa(e,"Launching of Cate service failed."),n(ee("error"))},Da(function(){var e=Object(c.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.getPodStatus(a.username,r);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),u,(function(){return n(ae(s))}),p,2e3,3e5));case 42:case"end":return t.stop()}}),t,null,[[11,17],[27,33]])})));return function(e){return t.apply(this,arguments)}}()}function Z(e){return{type:J,payload:e}}function Q(e,t){return function(){var n=Object(c.a)(l.a.mark((function n(a,r){var o,i;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=r().communication.userProfile,!Boolean(o)){n.next=28;break}return n.prev=3,console.debug("Shutting down service..."),a(ee("shuttingDown")),i=new L.a,n.next=9,i.stopServiceInstance(o.username);case 9:n.next=13;break;case 11:n.prev=11,n.t0=n.catch(3);case 13:if(!e.authenticated){n.next=25;break}return n.prev=14,a(ee("loggingOut")),n.next=18,e.logout({redirectUri:window.location.origin});case 18:n.next=23;break;case 20:n.prev=20,n.t1=n.catch(14),t.replace("/");case 23:n.next=26;break;case 25:t.replace("/");case 26:n.next=29;break;case 28:t.replace("/");case 29:case"end":return n.stop()}}),n,null,[[3,11],[14,20]])})));return function(e,t){return n.apply(this,arguments)}}()}function $(e){return function(){var t=Object(c.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n(he((function(){var t=e.createAccountUrl(),n=window.open(t,"_blank");n&&"function"===typeof n.focus&&n.focus()})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function ee(e){return{type:M,payload:{webAPIStatus:e}}}function te(e){return{type:B,payload:{webAPIClient:e}}}function ne(e){return{type:W,payload:{webAPIServiceURL:e}}}function ae(e){return function(){var t=Object(c.a)(l.a.mark((function t(n,a){var r,o,i,c,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(ne(e)),n(ee("connecting")),t.prev=2,t.next=5,(new T.a).getServiceInfo(e);case 5:r=t.sent,t.next=13;break;case 8:return t.prev=8,t.t0=t.catch(2),Pa(t.t0,"Failed to retrieve service information"),n(ee("error")),t.abrupt("return");case 13:console.log("Cate WebAPI server version ".concat(r.version)),n({type:U,payload:{webAPIServiceInfo:r}}),o=Object(D.o)(j.h(a())),i=function(e,t){return t.message?"".concat(e," (").concat(t.message,")"):e},c=function(){o.isOpen&&o.call("keep_alive",[]).then((function(e){if(e){var t={availableTime:e.available_time,inactivityTime:e.inactivity_time,remainingTime:e.remaining_time};n({type:V,payload:{webAPIAutoStopInfo:t}})}}))},s=null,5,o.onOpen=function(){n(te(o)),n((function(e,t){Ee({title:"Load configuration",dispatch:e,call:function(){return j.i(t()).getBackendConfig()},action:function(t){e(function(e){return be({backendConfig:e})}(t))}})})),n(Zn()),n((function(e,t){Ee({title:"Loading Preferences",dispatch:e,call:function(){return j.X(t()).loadPreferences()},action:function(n){e(be(n)),e(ze()),e((a=t().session.reopenLastWorkspace,r=t().session.lastWorkspacePath,function(e){e(a&&r?vt(r):bt(null))}));var a,r},planB:function(t){e(ga({type:"error",title:"Loading Preferences",message:"Failed to load preferences.",detail:t.message}))},requireDoneNotification:!0})})),n((function(e,t){Ee({title:"Load operations",dispatch:e,call:function(){return j.Q(t()).getOperations()},action:function(t){e(function(e){return{type:at,payload:{operations:e}}}(t))}})})),s=setInterval(c,5e3)},o.onClose=function(e){null!==s&&clearInterval(s);var t=a().communication.webAPIStatus;if("shuttingDown"!==t&&"loggingOut"!==t){console.error("webAPIClient.onClose:",e);var r="reason=".concat(e.reason,", code=").concat(e.code,", clean=").concat(e.wasClean);Object(P.a)({type:"notification",text:i("Connection to Cate service closed: ".concat(r),e)},12e4),n(ee("closed"))}},o.onError=function(e){console.error("webAPIClient.onError:",e),n(ee("error")),Object(P.a)({type:"error",text:i("Error connecting to Cate service",e)})},o.onWarning=function(e){console.warn("webAPIClient.onWarning:",e),Object(P.a)({type:"warning",text:i("Warning from Cate service",e)})};case 24:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e,n){return t.apply(this,arguments)}}()}function re(e){return{type:F,payload:e}}function oe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return{type:G,payload:{dialogId:e,dialogState:Object.assign.apply(Object,[{}].concat(n))}}}function ie(e,t){return oe(e,t,{isOpen:!0})}function le(e,t){return oe(e,t,{isOpen:!1})}function ce(e,t){return{type:Y,payload:{jobId:e,taskState:t}}}function se(e){return{type:H,payload:{jobId:e}}}function ue(e,t){return pe(Object(o.a)({},e,t))}function de(e,t){return function(n,a){var o=j.Bb(a());if(o){var i,l=Object(r.a)(e.inputs);try{for(l.s();!(i=l.n()).done;){var c=i.value;if(!O(t,c.name)&&Object(f.x)(c.dataType,o.dataType)){t=C(t,c.name,o.name);break}}}catch(h){l.e(h)}finally{l.f()}}var s=j.Kb(a());if(s){var u,d=Object(r.a)(e.inputs);try{for(d.s();!(u=d.n()).done;){var p=u.value;if(!O(t,p.name)&&(p.dataType===f.w||p.dataType===f.v)){t=_(t,p.name,s.name);break}}}catch(h){d.e(h)}finally{d.f()}}n(function(e,t){return{type:q,payload:{selectedCtxOperationName:e,inputAssignments:t}}}(e.name,t))}}function pe(e){return{type:K,payload:e}}function he(e){return function(t,n){t(fe(n().session,e))}}function fe(e,t){return function(n,a){Ee({title:"Update Preferences",dispatch:n,call:function(){return j.X(a()).updatePreferences(e)},action:function(){t&&n(t)},planB:function(e){n(ga({type:"error",title:"Update Preferences",message:"Failed to update preferences.",detail:e.message})),t&&n(t)},requireDoneNotification:!0})}}function me(e,t){return be(Object(o.a)({},e,t))}function be(e){return{type:z,payload:e}}function ve(e){return function(t,n){Ee({title:"Store configuration",dispatch:t,call:function(){return j.i(n()).setBackendConfig(e)}})}}function ye(e){return function(t,n){j.ec(n()).cancel(e)}}function ge(e,t){return ie("jobFailureDialog",{jobTitle:e,jobFailure:t})}function Ee(e){var t,n=e.call,a=e.title,r=e.dispatch,o=e.action,i=e.requestLock,l=e.planB,c=e.disableNotifications,s=void 0!==c&&c,u=e.requireDoneNotification,d=void 0!==u&&u,p=e.startToastDelay,h=void 0===p?500:p,f=n((function(e){s||r(function(e){return ce(e.id,{status:D.g.IN_PROGRESS,progress:e})}(e))})),m=!1;s||(t=setTimeout((function(){Object(P.a)({type:"notification",text:"Started: "+a}),m=!0}),h),r(function(e,t,n){return ce(e,{status:D.g.SUBMITTED,title:t,requestLock:n})}(f.getJobId(),a,i)));f.then((function(e){s||(clearTimeout(t),(m||d)&&Object(P.a)({type:"success",text:"Done: "+a}),r(ce(f.getJobId(),{status:D.g.DONE}))),o&&o(e)}),(function(e){s||m||clearTimeout(t),function(e,t,n,a,r){var o,i,l,c=n.code===D.d?D.g.CANCELLED:D.g.FAILED;c===D.g.CANCELLED?(o="notification",i="Cancelled: ".concat(t)):(o="error",i=n.message||"Failed: ".concat(t),l={text:"Details",onClick:function(){a(ge(t,n))}}),a(ce(e,{status:c,failure:n})),r||(n.code===D.e?a(ge(t,n)):Object(P.a)({type:o,text:i,action:l}))}(f.getJobId(),a,e,r,s),l&&l(e)}))}var Oe="SET_GLOBE_MOUSE_POSITION",_e="SET_GLOBE_VIEW_POSITION";function Ce(e){return{type:Oe,payload:{position:e}}}function ke(e,t){return{type:_e,payload:{position:e,positionData:t}}}function we(e){return function(t,n){if(e){if("variables"===j.Eb(n())){var a=j.kc(n());if(!a)return;var r=j.Bb(n()),o=j.Ib(n());if(o&&r){var i=Object(I.K)(r,o);return void Ee({title:"Load cell values",dispatch:t,call:function(){return j.v(n()).extractPixelValues(a,r.name,[e.longitude,e.latitude],i)},action:function(n){t(ke(e,n))},disableNotifications:!0})}}}else t(ke(null,null))}}var Se="UPDATE_FS_ROOT_NODE";function je(e,t){return{type:Se,payload:{path:e,updatedFileNode:t}}}function Ie(e,t){var n=e.split("/");return function(e,r){if(null!==j.B(r())){var o=[];n.forEach((function(e,a){var i=n.slice(0,a+1).join("/");if(0===o.length){var l=Object(g.g)(r().data.fsRootNode,i);l?l.status&&!t||o.push(i):(o.push(""),o.push(i))}else o.push(i)})),e(function e(t,n){return function(r,o){if(0!==t.length){var i=j.B(o());if(null!==i){var l=t[0],c=Object(g.g)(o().data.fsRootNode,l);if(c){if(!c.status||n){r(je(l,Object(a.a)(Object(a.a)({},c),{},{status:"updating"})));var s=function(a){r(je(l,a)),t.length>1&&r(e(t.slice(1),n))};Ee({title:"Updating Files",dispatch:r,call:function(){return i.updateFileNode(l)},action:s,planB:function(e){r(ga({type:"error",title:"File System Update",message:"Failed updating file in file system.",detail:e.message}))},requireDoneNotification:!1})}}else console.error('sub-path not found in file system root node: "'.concat(l,'"'))}else console.error("fileSystemAPI not ready")}}}(o,t))}else console.error("fileSystemAPI not ready")}}var Pe="ACTIVATE_NEW_PLACEMARK_TOOL",De="ADD_PLACEMARK",Te="REMOVE_PLACEMARK",Le="UPDATE_PLACEMARK_GEOMETRY",Ae="UPDATE_PLACEMARK_PROPERTIES",Re="UPDATE_PLACEMARK_STYLE";function Ne(e){return{type:Pe,payload:{newPlacemarkToolType:e}}}function xe(e){return{type:De,payload:{placemark:e}}}function Me(e,t,n){return xe({id:Object(I.w)(I.i),type:"Feature",geometry:{type:"Point",coordinates:[e,t]},properties:n})}function Ve(e){return{type:Te,payload:{placemarkId:e}}}function Be(e,t){return{type:Le,payload:{placemarkId:e,geometry:t}}}function We(e,t){return{type:Ae,payload:{placemarkId:e,properties:t}}}function Ue(e,t){return{type:Re,payload:{placemarkId:e,style:t}}}function Fe(e){return function(){var t=Object(c.a)(l.a.mark((function t(n,a){var r,o,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=j.Qb(a()))){t.next=7;break}if(!(o=Object(v.h)(r,e))){t.next=7;break}return o.position&&(0,-1.570795,25e5,i=new s.l(0,-1.570795,25e5)),t.next=7,r.zoomTo(o,i);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}function Ge(e){return be({selectedPlacemarkId:e})}var Ye="UPDATE_DATA_STORES",He="UPDATE_DATA_SOURCES",Ke="UPDATE_DATA_SOURCE_META_INFO";function ze(){return function(e,t){Ee({title:"Loading data stores",dispatch:e,call:function(){return j.v(t()).getDataStores()},action:function(n){if(j.P(t())&&(n=n.filter((function(e){return e.isLocal}))),e(function(e){return{type:Ye,payload:{dataStores:e}}}(n)),n&&n.length){var a=j.kb(t()),r=n.find((function(e){return e.id===a}));a=r?r.id:n[0].id,e(Xe(a))}}})}}function qe(e,t){return function(n,a){var r=Object(I.H)(e);if(!j.c(a()).has(r)){var o=a().data.dataStores.find((function(t){return t.id===e}));Ee({title:'Load data sources for store "'.concat(o?o.id:"?",'"'),dispatch:n,call:function(t){return j.v(a()).getDataSources(e,t)},action:function(r){if(n(Je(e,r)),t){var o=j.gb(a());if(r&&r.length){var i=r.find((function(e){return e.id===o}));o=i?i.id:o}n(Ze(o))}},requestLock:r})}}}function Je(e,t){return{type:He,payload:{dataStoreId:e,dataSources:t}}}function Xe(e){return function(t,n){(n().session.selectedDataStoreId,t(function(e){return be({selectedDataStoreId:e})}(e)),null!==e)&&(n().data.dataStores.find((function(t){return t.id===e})).dataSources||t(qe(e,!0)))}}function Ze(e){return function(t,n){t(be({selectedDataSourceId:e}));var a=n().session.selectedDataStoreId;a&&e&&t(function(e,t){return function(n,a){var r=a().data.dataStores;if(r){var o=Object(I.q)(r,e,t);o&&"init"===o.metaInfoStatus&&(n($e(e,t,void 0,"loading")),Ee({title:"Loading metadata for ".concat(t),dispatch:n,call:function(n){return j.v(a()).getDataSourceMetaInfo(e,t,n)},action:function(a){n($e(e,t,a,"ok"))},planB:function(){n($e(e,t,void 0,"error"))}}))}}}(a,e))}}function Qe(e){return be({dataSourceFilterExpr:e})}function $e(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ok";return{type:Ke,payload:{dataStoreId:e,dataSourceId:t,metaInfo:n,metaInfoStatus:a}}}function et(e,t,n,r){return function(o){var i,l=Object(a.a)({ds_id:t,data_store_id:e},n),c={};Object.keys(l).forEach((function(e){c[e]={value:l[e]}})),r&&(i=function(e){e(qe("local",!1))}),o(Rt("open_dataset",c,null,!1,'Opening data source "'.concat(t,'"'),i))}}function tt(e,t){return function(n,a){Ee({title:'Add file data source "'.concat(e,'"'),dispatch:n,call:function(n){return j.v(a()).addLocalDataSource(e,t,n)},action:function(e){n(Je("local",e))},requireDoneNotification:!0})}}function nt(e,t){return function(n,a){Ee({title:'Remove copy of file data source "'.concat(e,'"'),dispatch:n,call:function(n){return j.v(a()).removeLocalDataSource(e,t,n)},action:function(e){n(Je("local",e))},requireDoneNotification:!0})}}var at="UPDATE_OPERATIONS";function rt(e){return be({selectedOperationName:e})}function ot(e){return be({operationFilterTags:e})}function it(e){return be({operationFilterExpr:e})}function lt(e){return ie(e)}function ct(e,t){return function(n,r){if(t){var o=r().control.dialogs[e];t=Object(a.a)(Object(a.a)({},o.inputAssignments),t)}n(le(e,{inputAssignments:t}))}}var st="SET_CURRENT_WORKSPACE",ut="UPDATE_WORKSPACE_NAMES",dt="RENAME_RESOURCE",pt="SHOW_FIGURE_VIEW",ht="SHOW_ANIMATION_VIEW",ft="SHOW_TABLE_VIEW";function mt(e){return{type:ut,payload:{workspaceNames:e}}}function bt(e){return function(t,n){Ee({title:"New workspace"+(e?' "'.concat(e,'"'):""),dispatch:t,call:function(){return j.jc(n()).newWorkspace(e)},action:function(e){t(Tt(e)),t(yt()),e&&e.workflow.steps.length>0?t(Lt(e.workflow.steps[0].id)):t(Lt(null)),t(he())},planB:function(e){t(ga({type:"error",title:"New Workspace",message:"Failed to create new workspace.",detail:e.message}))},requireDoneNotification:!0})}}function vt(e){return function(t,n){Ee({title:'Open workspace "'.concat(e,'"'),dispatch:t,call:function(t){return j.jc(n()).openWorkspace(e,t)},action:function(e){t(Tt(e)),e&&e.workflow.steps.length>0?t(Lt(e.workflow.steps[0].id)):t(Lt(null)),t(he())},planB:function(){n().data.workspace||t(bt(null))},requireDoneNotification:!0})}}function yt(){return function(e,t){var n=t().data.workspace;if(h.a(n),n.isScratch)return gt;var a=n.baseDir;Ee({title:"Save workspace",dispatch:e,call:function(e){return j.jc(t()).saveWorkspace(a,e)},action:function(t){e(Tt(t)),e(he())},planB:function(t){e(ga({type:"error",title:"Save Workspace",message:"Failed to save workspace.",detail:t.message}))},requireDoneNotification:!0})}}function gt(e){return function(t,n){var a=j.kc(n());h.a(a),Ee({title:'Save workspace as "'.concat(e,'"'),dispatch:t,call:function(t){return j.jc(n()).saveWorkspaceAs(a,e,t)},action:function(e){t(Tt(e)),t(he())},planB:function(e){t(ga({type:"error",title:"Save Workspace As",message:"Failed to save workspace.",detail:e.message}))},requireDoneNotification:!0})}}function Et(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n,a){Ee({title:'Delete step/workspace "'.concat(e,'"'),dispatch:n,call:function(){return j.jc(a()).deleteWorkspace(e,t)},requireDoneNotification:!0})}}function Ot(){return ie("newWorkspaceDialog")}function _t(e,t){e(function(e,t){var n=new Set(e.properties);return n.delete("multiSelections"),ha(e=Object(a.a)(Object(a.a)({},e),{},{properties:Array.from(n)}),(function(e){t(!e.canceled&&e.filePaths.length>0?e.filePaths[0]:null)}))}({title:"Open Workspace - Select Directory",buttonLabel:"Open",properties:["openDirectory"]},(function(n){if(n){var a=t().data.workspace,r=!0;if(a){if(a.baseDir===n)return void Object(P.a)({type:"warning",text:"Workspace is already open."});r=Dt(e,t,"Open Workspace","Would you like to save the current workspace before opening the new one?",'Press "Cancel" to cancel opening a new workspace.')}r&&e(vt(n))}})))}function Ct(){return function(e,t){j.I(t())?_t(e,t):function(e,t){j.jc(t()).listWorkspaces().then((function(t){e(mt(t)),e(ie(E.b))}))}(e,t)}}function kt(){return function(e,t){j.I(t())||function(e,t){j.jc(t()).listWorkspaces().then((function(t){e(mt(t)),e(ie(E.a))}))}(e,t)}}function wt(){return function(e,t){Dt(e,t,"Close Workspace","Would you like to save the current workspace before closing it?",'Press "Cancel" to cancel closing the workspace.')&&e((function(e,t){var n=j.kc(t());h.a(n),Ee({title:"Close workspace",dispatch:e,call:function(){return j.jc(t()).closeWorkspace(n)},action:function(){e(bt(null))},requireDoneNotification:!0})}))}}function St(){return function(e){e(ga({type:"question",title:"Clean Workspace",message:"Do you really want to clean this workspace?",detail:"This will delete all resources and workflow steps.\nYou will not be able to undo this operation.",buttons:["Yes","No"],defaultId:1,cancelId:1},(function(t){t&&0===t.buttonIndex&&e((function(e,t){var n=t().data.workspace;h.a(n);var a=n.baseDir;Ee({title:'Clean workspace "'.concat(a,'"'),dispatch:e,call:function(){return j.jc(t()).cleanWorkspace(a)},action:function(t){e(Tt(t))},requireDoneNotification:!0})}))})))}}function jt(e){return function(t){t(ga({type:"question",title:"Remove Resource and Workflow Step",message:'Do you really want to delete resource and step "'.concat(e,'"?'),detail:"This will also delete the workflow step that created it.\nYou will not be able to undo this operation.",buttons:["Yes","No"],defaultId:1,cancelId:1},(function(n){n&&0===n.buttonIndex&&t(function(e){return function(t,n){var a=n().data.workspace;h.a(a);var r=a.baseDir;Ee({title:'Delete step/resource "'.concat(e,'"'),dispatch:t,call:function(){return j.jc(n()).deleteWorkspaceResource(r,e)},action:function(e){t(Tt(e))},requireDoneNotification:!0})}}(e))})))}}function It(){return function(e,t){t().data.workspace.isScratch?e(Pt()):e(yt())}}function Pt(){return ie("saveWorkspaceAsDialog")}function Dt(e,t,n,a,r){var o=t().data.workspace;o&&(o.workflow.steps.length&&(o.isModified||!o.isSaved)&&e(ga({type:"question",title:n,message:a,detail:r,buttons:["Yes","No","Cancel"],defaultId:0,cancelId:2},(function(t){if(!t)return!1;if(0===t.buttonIndex)o.isScratch?e(Pt()):e(yt());else if(2===t.buttonIndex)return!1}))));return!0}function Tt(e){return function(t,n){t(function(e){return{type:st,payload:{workspace:e}}}(e));var a=e.baseDir;n().session.lastWorkspacePath!==a&&(e.isScratch?t(be({lastWorkspacePath:null})):t(be({lastWorkspacePath:a})))}}function Lt(e){return function(t,n){if(t(function(e){return pe({selectedWorkspaceResourceName:e})}(e)),e&&n().data.workspace){var a=n().data.workspace.resources;if(a){var r=a.find((function(t){return t.name===e}));if(r&&r.variables&&r.variables.length){var o=r.variables.find((function(e){return!!e.isDefault}));t(Yt(r,o||r.variables[0],j.db(n())))}}}}}function At(e){return function(t,n){if(e){var a=j.Z(n())[e];a&&t(Lt(a.name))}t(function(e){return pe({selectedWorkflowStepId:e})}(e))}}function Rt(e,t,n,a,r,o){return function(i,l){var c=j.kc(l());h.a(c),Ee({dispatch:i,title:r,call:function(r){return j.jc(l()).setWorkspaceResource(c,e,t,n,a,r)},action:function(e){var t=e[0],n=e[1];i(Tt(t));var a=Object(I.t)(j.bb(l()),n),r=Object(I.U)(a),c=Object(I.S)(a);r||c||i(Lt(n)),(r||c)&&l().session.autoShowNewFigures&&(r?i(Bt(a,j.d(l()))):c&&i(function(e,t){return{type:ht,payload:{resource:e,placeAfterViewId:t}}}(a,j.d(l())))),o&&i(o)},requireDoneNotification:!0})}}function Nt(e,t){return function(n,a){var r=j.kc(a());h.a(r),Ee({title:"Change resource persistence",dispatch:n,call:function(){return j.jc(a()).setWorkspaceResourcePersistence(r,e,t)},action:function(e){n(Tt(e))}})}}function xt(e,t){return function(n,a){var r=j.kc(a());h.a(r),Ee({title:"Rename resource",dispatch:n,call:function(){return j.jc(a()).renameWorkspaceResource(r,e,t)},action:function(a){n(Tt(a)),n(function(e,t){return{type:dt,payload:{resName:e,newResName:t}}}(e,t))}})}}function Mt(e,t,n,a){return function(r,o){var i=j.kc(o());h.a(i);var l='Computing statistics for variable "'.concat(t,'"'),c=Object(I.G)(e,t,n);Ee({title:l,dispatch:r,call:function(a){return j.jc(o()).getWorkspaceVariableStatistics(i,e,t,n,a)},action:function(e){r(a(e))},requestLock:c})}}function Vt(e,t,n){return{type:ft,payload:{resName:e,varName:t,placeAfterViewId:n}}}function Bt(e,t){return{type:pt,payload:{resource:e,placeAfterViewId:t}}}function Wt(e,t){return function(){N&&N.shell.openExternal(e+"/png")}}var Ut="SET_SHOW_SELECTED_VARIABLE_LAYER",Ft="SET_SELECTED_VARIABLE";function Gt(e){return{type:Ut,payload:{showSelectedVariableLayer:e}}}function Yt(e,t,n){return{type:Ft,payload:{resource:e,selectedVariable:t,savedLayers:n}}}function Ht(e,t,n,a,r){return function(e,t,n){return{type:Ln,payload:{viewId:e,layer:t,selectLayer:n}}}(e,Object(I.eb)(t,n,r),a)}function Kt(e){return be({leftPanelContainerLayout:e})}function zt(e){return be({rightPanelContainerLayout:e})}function qt(e){return be({selectedLeftTopPanelId:e})}function Jt(e){return be({selectedLeftBottomPanelId:e})}function Xt(e){return be({selectedRightTopPanelId:e})}function Zt(e){return be({selectedRightBottomPanelId:e})}var Qt="ADD_WORLD_VIEW",$t="ADD_TABLE_VIEW",en="SELECT_VIEW",tn="CLOSE_VIEW",nn="SPLIT_VIEW_PANEL",an="CHANGE_VIEW_SPLIT_POS",rn="MOVE_VIEW";function on(e,t){return{type:Qt,payload:{placeAfterViewId:e,baseMapId:t}}}function ln(e,t){return{type:en,payload:{viewPath:e,viewId:t}}}function cn(e,t){return{type:tn,payload:{viewPath:e,viewId:t}}}function sn(e){return{type:"CLOSE_ALL_VIEWS",payload:{viewPath:e}}}function un(e,t,n){return{type:nn,payload:{viewPath:e,dir:t,pos:n}}}function dn(e,t){return{type:an,payload:{viewPath:e,delta:t}}}function pn(e,t,n){return{type:rn,payload:{sourceViewId:e,placement:t,targetViewId:n}}}var hn="SET_VIEW_MODE",fn="SET_PROJECTION_CODE",mn="SET_LAYER_SPLIT_MODE",bn="SET_LAYER_SPLIT_POSITION",vn="SET_SELECTED_ENTITY_ID",yn="INC_ENTITY_UPDATE_COUNT",gn="UPDATE_ENTITY_STYLE",En="UPDATE_MOUSE_IDLE_STATE";function On(e,t){return{type:hn,payload:{viewId:e,viewMode:t}}}function _n(e,t,n){return{type:mn,payload:{viewId:e,layerId:t,splitMode:n}}}function Cn(e,t){return{type:bn,payload:{viewId:e,layerSplitPosition:t}}}function kn(e,t,n){return function(a,r){var o=n&&n.id;if((a(function(e,t){return{type:vn,payload:{viewId:e,selectedEntityId:t}}}(e,Object(b.b)(o)?o:null)),n&&Object(b.d)(n._simp)&&Object(b.d)(n._resId)&&Object(b.d)(n._idx))&&0!==(1&n._simp)){var i=j.nc(r());if(i){var l=n._resId,c=+n._idx,s=j.fc(r()),u=i.baseDir,d=Object(I.A)(s,u,{resId:l},c);Object(w.b)(n,d,t.style)}}}}function wn(e,t,n){return function(a){var r=Object(I.P)(e,t);r&&(r.id===I.h?a(Ue(t.id,n)):a(function(e,t,n,a){return{type:gn,payload:{viewId:e,layerId:t,entityId:n,style:a}}}(e.id,r.id,t.id,n))),a({type:yn})}}var Sn="UPDATE_TABLE_VIEW_DATA";function jn(e,t,n,a,r,o){return{type:Sn,payload:{viewId:e,resName:t,varName:n,dataRows:a=a||null,error:r=r||null,isLoading:o=o||!1}}}function In(e,t,n){return function(a,r){var o=j.fc(r()),i=j.kc(r()),l=j.bb(r()).find((function(e){return e.name===t}));if(l){var c=Object(I.x)(o,i,{resId:l.id},n);a(jn(e,t,n,null,null,!0)),p.a(c).then((function(r){a(jn(e,t,n,r,null,!1))})).catch((function(r){a(jn(e,t,n,null,r,!1))}))}}}var Pn="UPDATE_ANIMATION_VIEW_DATA";function Dn(e,t){return function(n,a){var r=j.fc(a()),o=j.kc(a()),i=Object(I.D)(r,o,t),l=new XMLHttpRequest;l.onreadystatechange=function(){4===l.readyState&&n(function(e,t,n){return{type:Pn,payload:{viewId:e,innerHTML:t,status:n}}}(e,l.responseText,l.status))},l.open("GET",i,!0),l.send(null)}}var Tn="SET_SELECTED_LAYER_ID",Ln="ADD_LAYER",An="REMOVE_LAYER",Rn="UPDATE_LAYER",Nn="UPDATE_LAYER_STYLE",xn="MOVE_LAYER_UP",Mn="MOVE_LAYER_DOWN",Vn="SAVE_LAYER",Bn="SET_BASE_MAP_ID";function Wn(e,t){return{type:Tn,payload:{viewId:e,selectedLayerId:t}}}function Un(e,t){return{type:An,payload:{viewId:e,id:t}}}function Fn(e,t){return{type:xn,payload:{viewId:e,id:t}}}function Gn(e,t){return{type:Mn,payload:{viewId:e,id:t}}}function Yn(e,t){for(var n=arguments.length,a=new Array(n>2?n-2:0),r=2;r<n;r++)a[r-2]=arguments[r];return function(n){if(a.length&&(t=m.a.apply(void 0,[{},t].concat(a))),n(Hn(e,t)),t.id===I.a){var r=t.varName;r&&n(zn(r,t))}}}function Hn(e,t){return{type:Rn,payload:{viewId:e,layer:t}}}function Kn(e,t,n){return{type:Nn,payload:{viewId:e,layerId:t,style:n}}}function zn(e,t){return{type:Vn,payload:{key:e,layer:t}}}function qn(e){return be({styleContext:e})}function Jn(e,t){return{type:Bn,payload:{viewId:e,baseMapId:t}}}var Xn="UPDATE_COLOR_MAPS";function Zn(){return function(e,t){Ee({title:"Load color maps",dispatch:e,call:function(){return j.r(t()).getColorMaps()},action:function(t){e(function(e){return{type:Xn,payload:{colorMaps:e}}}(t))}})}}function Qn(){return ie("preferencesDialog")}function $n(){return le("preferencesDialog")}var ea="SHOW_PWA_INSTALL_PROMOTION",ta="HIDE_PWA_INSTALL_PROMOTION",na="UPDATE_PWA_DISPLAY_MODE",aa=null;function ra(e){return(aa=e).preventDefault(),{type:ea}}var oa=function(){return function(e){e({type:ta}),aa.prompt(),aa.userChoice.then((function(e){"accepted"===e.outcome?console.debug("User accepted the install prompt"):console.debug("User dismissed the install prompt")}))}};var ia="OBTAIN_COOKIE_CONSENT";function la(e){return{type:ia,payload:{trackingConsentObtained:e}}}var ca="OPEN_DIRECTORY_SELECT_DIALOG",sa="CLOSE_DIRECTORY_SELECT_DIALOG";function ua(e,t){var n=new Set(e.properties);return n.delete("openFile"),n.delete("multiSelections"),n.add("openDirectory"),e=Object(a.a)(Object(a.a)({},e),{},{title:e.title||"Select Directory",buttonLabel:e.buttonLabel||"Select",properties:Array.from(n)}),function(n){var a=function(e){n(function(e){return{type:sa,payload:{result:e}}}(e)),t(!e.canceled&&e.filePaths&&e.filePaths.length>0?e.filePaths[0]:null)};n(function(e,t){return{type:ca,payload:{options:e,onClose:t}}}(e,a)),y.a.showFileOpenDialog(e,a)}}var da="OPEN_FILE_OPEN_DIALOG",pa="CLOSE_FILE_OPEN_DIALOG";function ha(e,t){return function(n){var a=function(e){n(function(e){return{type:pa,payload:{result:e}}}(e)),t(e)};n(function(e,t){return{type:da,payload:{options:e,onClose:t}}}(e,a)),y.a.showFileOpenDialog(e,a)}}var fa="OPEN_FILE_SAVE_DIALOG",ma="CLOSE_FILE_SAVE_DIALOG";function ba(e,t){return function(n){var a=function(e){n(function(e){return{type:ma,payload:{result:e}}}(e)),t(e)};n(function(e,t){return{type:fa,payload:{options:e,onClose:t}}}(e,a)),y.a.showFileSaveDialog(e,a)}}var va="OPEN_MESSAGE_BOX",ya="CLOSE_MESSAGE_BOX";function ga(e,t){return function(n){var a=function(e){n(function(e){return{type:ya,payload:{result:e}}}(e)),t&&t(e)};n(function(e,t){return{type:va,payload:{options:e,onClose:t}}}(e,a)),y.a.showMessageBox(e,a)}}var Ea="OPEN_FILE_BROWSE_DIALOG",Oa="CLOSE_FILE_BROWSE_DIALOG";function _a(e){return function(t){t({type:Ea,payload:{options:{defaultPath:e},onClose:function(){t({type:Oa})}}}),y.a.showItemInFolder(e)}}function Ca(e){Ia("copyTextToClipboard")?N.clipboard.writeText(e):d()(e)}function ka(){return ie("fileUploadDialog")}function wa(){return ie("fileDownloadDialog")}function Sa(e,t){return function(n,a){var r=a(),o=r.communication.webAPIServiceURL;j.A(r).uploadFiles(e,t,o).then((function(a){n(Ie(e+"/"+t.name,!0)),Object(P.a)({type:a.status,text:"Upload finished: "+a.message})})).catch((function(e){Object(P.a)({type:"error",text:e.toString()}),console.error(e)}))}}function ja(e){return function(t,n){var a=n(),r=a.communication.webAPIServiceURL;j.A(a).downloadFiles(e,"ignore",r).then((function(){Object(P.a)({type:"success",text:"Zip ready for download."})})).catch((function(e){Object(P.a)({type:"error",text:e.toString()}),console.error(e)}))}}function Ia(e){return N?!!N.ipcRenderer||(console.warn("".concat(e,"() cannot be executed, module electron.ipcRenderer not available")),!1):(console.warn("".concat(e,"() cannot be executed, module electron not available")),!1)}function Pa(e,t){console.info("fetch error: ",t,e);var n="";e instanceof A.a?n=e.statusText?" (HTTP status ".concat(e.status,": ").concat(e.statusText,")"):" (HTTP status ".concat(e.status,")"):e instanceof TypeError?n=" (wrong URL or no internet)":e instanceof Error&&e.message&&(n=" (".concat(e.message,")")),Object(P.a)({type:"error",text:t+n})}function Da(e,t,n,a,r,o){var i,s=(new Date).getTime(),u=null,d=function(){var d=Object(c.a)(l.a.mark((function c(){var d;return l.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,e();case 3:d=l.sent,l.next=9;break;case 6:l.prev=6,l.t0=l.catch(0),u=l.t0;case 9:t(d)?n(d):(new Date).getTime()-s>o?a(u||new Error("Timeout")):setTimeout(i,r);case 10:case"end":return l.stop()}}),c,null,[[0,6]])})));return function(){return d.apply(this,arguments)}}();i=d,setTimeout(d,r)}var Ta=!1;function La(){return function(e,t){if(!Ta){if(N&&N.ipcRenderer){var n=N.ipcRenderer;n.on("update-initial-state",(function(t,n){e(function(e){return{type:x,payload:e}}(n))})),n.on("new-workspace",(function(){e(Ot())})),n.on("open-workspace",(function(){e(Ct())})),n.on("close-workspace",(function(){e(wt())})),n.on("save-workspace",(function(){e(It())})),n.on("save-workspace-as",(function(){e(Pt())})),n.on("delete-workspace",(function(){e(kt())})),n.on("show-preferences-dialog",(function(){e(Qn())})),n.on("logout",(function(){}))}document.addEventListener("drop",(function(t){t.preventDefault(),t.stopPropagation();var n,a=Object(r.a)(t.dataTransfer.files);try{for(a.s();!(n=a.n()).done;){Aa(n.value,e)}}catch(o){a.e(o)}finally{a.f()}})),document.addEventListener("dragover",(function(e){e.preventDefault(),e.stopPropagation()})),window.addEventListener("beforeunload",(function(n){return n.preventDefault(),t().communication.webAPIClient&&e(he()),null})),Ta=!0}}}function Aa(e,t){var n,a;e.name.endsWith(".nc")?n="read_netcdf":e.name.endsWith(".txt")?n="read_text":e.name.endsWith(".json")?n="read_json":e.name.endsWith(".csv")?n="read_csv":(e.name.endsWith(".geojson")||e.name.endsWith(".shp")||e.name.endsWith(".gml"))&&(n="read_geo_data_frame"),a||(a={file:{value:e.name}}),n?t(function(e,t,n,a,r,o,i){return function(l,c){var s=c(),u=j.x(k.a)(s),d=s.communication.webAPIServiceURL,p=j.kc(c());u.isOpen||j.A(s).uploadFiles(p,t,d).then((function(t){Object(P.a)({type:t.status,text:"Upload finished: "+t.message}),l(Rt(e,n,a,r,o,i))})).catch((function(e){Object(P.a)({type:"error",text:e.toString()}),console.error(e)}))}}(n,e,a,null,!1,"Reading dropped file ".concat(e.name))):console.warn("Dropped file of unrecognized type: ",e.name)}},73:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var a="3.1.5-dev.0",r=function(){var e="https://dev.catehub.brockmann-consult.de/api/v2/";e||(e=window.location.host.indexOf("stage")>=0?"https://stage.catehub.climate.esa.int/api/v2":window.location.host.indexOf("dev")>=0?"https://dev.catehub.brockmann-consult.de/api/v2/":"https://catehub.climate.esa.int/api/v2");return e.endsWith("/")?e.substr(0,e.length-1):e}(),o={version:a,auth:{url:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CATEHUB_ENDPOINT:"https://dev.catehub.brockmann-consult.de/api/v2/"}).REACT_APP_KEYCLOAK_URL||"https://192-171-169-159.sslip.io/auth",realm:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CATEHUB_ENDPOINT:"https://dev.catehub.brockmann-consult.de/api/v2/"}).REACT_APP_KEYCLOAK_REALM||"cate",clientId:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CATEHUB_ENDPOINT:"https://dev.catehub.brockmann-consult.de/api/v2/"}).REACT_APP_KEYCLOAK_CLIENT_ID||"cate-webui"},webApi:{endpointUrl:r,managApiUrl:r+"/users/{username}/webapis",closeApiUrl:r+"/users/{username}/webapis",countApiUrl:r+"/webapis",maxNumUsers:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CATEHUB_ENDPOINT:"https://dev.catehub.brockmann-consult.de/api/v2/"}).REACT_APP_MAX_NUM_USERS?parseInt(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CATEHUB_ENDPOINT:"https://dev.catehub.brockmann-consult.de/api/v2/"}).REACT_APP_MAX_NUM_USERS):50}};console.debug("CONFIG:",o)},796:function(e,t,n){},797:function(e,t,n){},798:function(e,t,n){"use strict";n.r(t);var a=n(6),r=n(2),o=n(57),i=n(26),l=n(129),c=(n(458),n(414)),s=n(415),u=n.n(s),d=n(119),p=n(7),h=n(132),f=n(64),m=n(50),b=n(809),v=n(805),y=n(15),g=n(16),E=n(8),O=n(19),_=n(20),C=n(811),k=n(5);var w=Object(i.b)((function(e){return{cookieConsentObtained:e.session.cookieConsentObtained,trackingConsentObtained:e.session.trackingConsentObtained}}))((function(e){var t=e.cookieConsentObtained,n=e.trackingConsentObtained,a=e.dispatch,o=r.useState(!1),i=Object(m.a)(o,2),l=i[0],c=i[1],s=r.useState(n),u=Object(m.a)(s,2),d=u[0],h=u[1];if(t)return null;return r.createElement(k.Drawer,{title:"Data Protection Notice",icon:"info-sign",position:k.Position.BOTTOM,isOpen:!0,isCloseButtonShown:!1,canOutsideClickClose:!1,canEscapeKeyClose:!1,size:240},r.createElement("div",{className:k.Classes.DRAWER_BODY},r.createElement("div",{className:k.Classes.DIALOG_BODY},"We use cookies so you can optimally use this website. Some cookies that are necessary for the operation of Cate App. In addition, we use cookies for statistical purposes. You can adjust the data protection settings or agree to all cookies directly. ",r.createElement("a",{href:"https://climate.esa.int/en/privacy/"},"Privacy Statement")),r.createElement("div",{className:k.Classes.DIALOG_FOOTER},r.createElement("div",{className:k.Classes.DIALOG_FOOTER_ACTIONS},r.createElement(k.Button,{intent:k.Intent.PRIMARY,onClick:function(){a(Object(p.lc)(!l||d))}},l?"I agree to selected Cookies":"I agree to all Cookies"),r.createElement(k.Button,{rightIcon:l?"caret-up":"caret-down",onClick:function(){return c(!l)}},"Settings"))),r.createElement(k.Collapse,{isOpen:l},r.createElement("div",{className:k.Classes.DIALOG_BODY},r.createElement(k.Checkbox,{checked:!0},r.createElement("strong",null,"Functional"),": Cate does not work without functional cookies. We'll just save your consent with this notice and possibly auto-login information if you use the Cate cloud services."),r.createElement(k.Checkbox,{checked:d,onChange:function(e){h(e.currentTarget.checked)}},r.createElement("strong",null,"Tracking"),": Cate uses the open source software tool ",r.createElement("a",{href:"https://matomo.org/"},"Matomo"),", which uses cookies. With these cookies we count Cate App visits - of course anonymously. Matomo fully complies to the EU General Data Protection Regulation (GDPR).")))))})),S=n(117),j=n(420),I=n.n(j);var P=Object(i.b)((function(e){return{}}))(Object(d.c)((function(e){var t=e.dispatch,n=e.keycloak,a=e.keycloakInitialized,o=Object(f.g)();return r.createElement("div",null,r.createElement(k.Menu,null,r.createElement(k.MenuItem,{text:"Account",icon:"user",onClick:function(){t(p.ec(n))},disabled:!a}),r.createElement(k.MenuItem,{text:"Logout",icon:"log-out",onClick:function(){t(p.dc(n,o))},disabled:!a})))})));var D=Object(i.b)((function(e){return{}}))((function(e){return r.createElement(k.Menu,null,r.createElement(k.MenuItem,{text:"New Workspace",icon:"folder-new",onClick:function(){e.dispatch(Object(p.jc)())}}),r.createElement(k.MenuItem,{text:"Open Workspace",icon:"folder-shared-open",onClick:function(){e.dispatch(Object(p.oc)())}}),r.createElement(k.MenuItem,{text:"Close Workspace",icon:"folder-close",onClick:function(){e.dispatch(Object(p.Jb)())}}),r.createElement(k.MenuDivider,null),r.createElement(k.MenuItem,{text:"Save Workspace",icon:"add-to-folder",onClick:function(){e.dispatch(Object(p.xc)())}}),r.createElement(k.MenuItem,{text:"Save Workspace As...",onClick:function(){e.dispatch(Object(p.wc)())}}),r.createElement(k.MenuDivider,null),r.createElement(k.MenuItem,{text:"Delete Workspace",icon:"trash",onClick:function(){e.dispatch(Object(p.Ob)())}}))}));var T=Object(i.b)((function(e){return{}}))((function(e){return r.createElement("div",null,r.createElement(k.Menu,null,r.createElement(k.MenuItem,{text:"Upload Files...",icon:"upload",onClick:function(){e.dispatch(Object(p.Rb)())}}),r.createElement(k.MenuDivider,null),r.createElement(k.MenuItem,{text:"Download Files...",icon:"download",onClick:function(){e.dispatch(Object(p.Qb)())}}),r.createElement(k.MenuDivider,null),r.createElement(k.MenuItem,{text:"Browse Files...",icon:"folder-close",onClick:function(){e.dispatch(Object(p.id)(""))}})))}));var L=Object(i.b)((function(e){return{}}))((function(){var e=function(e){window.open(e,"_blank")};return r.createElement("div",null,r.createElement(k.Menu,null,r.createElement(k.MenuItem,{text:"Cate Documentation",onClick:function(){return e("http://cate.readthedocs.io")}}),r.createElement(k.MenuItem,{text:"Cate Website",onClick:function(){return e("https://climate.esa.int/en/explore/analyse-climate-data")}}),r.createElement(k.MenuItem,{text:"Cate on GitHub",onClick:function(){return e("https://github.com/CCI-Tools/cate")}}),r.createElement(k.MenuItem,{text:"ESA Climate Office Helpdesk",onClick:function(){return e("https://climate.esa.int/en/helpdesk")}})))})),A={marginLeft:10};var R=Object(i.b)((function(e){return{userProfile:e.communication.userProfile,pwaInstallPromotionVisible:e.control.pwaInstallPromotionVisible}}))((function(e){var t=e.userProfile,n=e.pwaInstallPromotionVisible,a=e.dispatch;return r.createElement(k.Navbar,null,r.createElement(k.NavbarGroup,null,r.createElement("img",{src:I.a,width:32,height:32,alt:"Cate icon"}),r.createElement("h2",{style:A},"Cate - ESA CCI Toolbox")),r.createElement(k.NavbarGroup,{align:"right"},n&&r.createElement(r.Fragment,null,r.createElement(k.Button,{className:"bp3-minimal",icon:"desktop",intent:"success",onClick:function(){a(p.od())}},"Install App"),r.createElement(k.NavbarDivider,null)),r.createElement(k.Popover,{content:r.createElement(D,null),position:k.PopoverPosition.BOTTOM},r.createElement(k.Button,{className:"bp3-minimal",rightIcon:"caret-down"},"Workspaces")),r.createElement(k.Popover,{content:r.createElement(T,null),position:k.PopoverPosition.BOTTOM},r.createElement(k.Button,{className:"bp3-minimal",rightIcon:"caret-down"},"Files")),r.createElement(k.Popover,{content:r.createElement(L,null),position:k.PopoverPosition.BOTTOM},r.createElement(k.Button,{className:"bp3-minimal",rightIcon:"caret-down"},"Help")),r.createElement(k.NavbarDivider,null),null!==t&&r.createElement(k.Popover,{content:r.createElement(P,null),position:k.PopoverPosition.BOTTOM},r.createElement(k.Tooltip,{content:r.createElement(M,{userProfile:t})},r.createElement(k.Button,{className:"bp3-minimal",icon:r.createElement(x,{userProfile:t})}))),r.createElement(k.Button,{className:"bp3-minimal",icon:"cog",onClick:function(){a(p.md())}})))})),N={width:28,height:28,flex:"none",borderRadius:14,color:"white",display:"flex",textAlign:"center",justifyContent:"center",alignItems:"center",backgroundColor:"#29A634"};function x(e){var t=e.userProfile,n=t.firstName||t.username||t.email,a=(n&&n.length&&n[0]||"U").toUpperCase();return r.createElement("div",{style:N},a)}function M(e){var t=e.userProfile,n=[];return t.username&&n.push(r.createElement("b",null,t.username)),t.firstName?t.lastName?n.push("".concat(t.firstName," ").concat(t.lastName)):n.push(t.firstName):t.lastName&&n.push(t.lastName),t.email&&(t.emailVerified?n.push(t.email):n.push("".concat(t.email," (not verified)"))),r.createElement("div",null,n.map((function(e,t){return r.createElement("div",{key:t},e)})))}var V=n(120),B=n(44),W=n(33),U=n(68),F=n(10),G=r.createElement("span",null,"This is very likely a configuration error."),Y=r.createElement(k.NonIdealState,{title:"No workspace",description:r.createElement("span",null,"Try ",r.createElement("strong",null,"File / New")," or ",r.createElement("strong",null,"File / Open")," from the main menu."),icon:"circle"}),H=r.createElement(k.NonIdealState,{title:"No workspace resources",icon:"database",description:r.createElement("span",null,"Open a dataset in DATA SOURCES panel or add a ",r.createElement("code",null,"read_")," operation step from the OPERATIONS panel.")}),K=r.createElement(k.NonIdealState,{title:"No workflow steps",icon:"flows",description:r.createElement("span",null,"Open a dataset in DATA SOURCES panel or add a ",r.createElement("code",null,"read_")," operation step from the OPERATIONS panel.")}),z=r.createElement(k.NonIdealState,{title:"No data stores found",icon:"offline",description:G}),q=r.createElement(k.NonIdealState,{title:"No data sources",icon:"circle",description:r.createElement("span",null,'You can add a new data source using the "+" button below.')}),J=r.createElement(k.NonIdealState,{title:"Loading data sources...",icon:r.createElement("div",{style:{marginTop:14}},r.createElement(k.Spinner,{intent:k.Intent.PRIMARY})),description:r.createElement("div",{className:"bp3-text-small bp3-text-muted"},"Note: If loading seems to take forever, try switching to another data store in between, then come back to the desired one.")}),X=r.createElement(k.NonIdealState,{title:"No data sources found",icon:"circle",description:G}),Z=r.createElement(k.NonIdealState,{title:"No operations found",description:G,icon:"circle"}),Q=r.createElement(k.NonIdealState,{title:"No variables",icon:"circle",description:"Select a resource in the WORKSPACE panel first."}),$=r.createElement(k.NonIdealState,{title:"No active view",description:"Add a new view first.",icon:"circle"}),ee=r.createElement(k.NonIdealState,{title:"Can't open world view",description:"Cate's world view component requires WebGL, which doesn't seem to be supported by your environment. This is likely on virtualized HW with low graphics capabilities. Sorry!",icon:"disable"}),te=r.createElement(k.NonIdealState,{title:"No places",description:r.createElement("span",null,"Press the tool buttons below to add a new place."),icon:"circle"}),ne=r.createElement(k.NonIdealState,{title:"No place selected",description:"Select a place to show and edit its details.",icon:"circle"}),ae=r.createElement(k.NonIdealState,{title:"No layers",description:"To show layers, activate a world view",icon:"circle"}),re=r.createElement(k.NonIdealState,{title:"No layers",description:r.createElement("span",null,"Press the ",r.createElement(k.Icon,{icon:"add"})," button to add a layer."),icon:"circle"}),oe=r.createElement(k.NonIdealState,{title:"No layer selected",description:"Select a layer to browse and edit its details.",icon:"circle"}),ie=r.createElement(k.NonIdealState,{title:"Styles unavailable",description:"Select a layer in the LAYERS panel to modify its style.",icon:"circle"}),le=r.createElement(k.NonIdealState,{title:"Styles unavailable",description:"Select an entity in the World View to modify its style.",icon:"circle"}),ce=(k.NonIdealState,k.Icon,r.createElement(k.NonIdealState,{title:"No table data",description:r.createElement("span",null,"The resource seems to be empty or an error occurred."),icon:"circle"})),se=n(23),ue=n(272),de=n(29);var pe=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).parentContainer=void 0,n.checkProps(e),a.parentContainer=null,a.onRef=a.onRef.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"getExternalObjectRef",value:function(){return this.externalObjectStore[this.props.id]||null}},{key:"propsToExternalObjectState",value:function(e,t){return Object(a.a)(Object(a.a)({},t),e)}},{key:"externalObjectMounted",value:function(e,t,n,a){}},{key:"externalObjectUnmounted",value:function(e,t,n,a){}},{key:"componentWillUpdate",value:function(e){this.props.debug&&console.log("ExternalObjectComponent.componentWillUpdate nextProps.id =",e.id),n.checkProps(e),this.props.id===e.id?this.updateExternalComponentAndSaveProps(e):this.parentContainer&&this.remountExternalObject(this.parentContainer,e)}},{key:"onRef",value:function(e){this.props.debug&&console.log("ExternalObjectComponent.onRef: this.props =",this.props),this.remountExternalObject(e,this.props)}},{key:"render",value:function(){return r.createElement("div",{id:this.props.id,className:this.props.className,style:this.props.style,ref:this.onRef},this.renderChildren())}},{key:"renderChildren",value:function(){return null}},{key:"forceRegeneration",value:function(){var e=this.externalObjectStore,t=e[this.props.id];t&&(delete e[this.props.id],this.parentContainer&&t.container&&this.parentContainer.removeChild(t.container),this.remountExternalObject(this.parentContainer,this.props))}},{key:"remountExternalObject",value:function(e,t){t.debug&&console.log("ExternalObjectComponent.remountExternalObject: props.id =",t.id),e?(e.id!==t.id&&this.unmountExternalObject(e,this.props),t.id in this.externalObjectStore?this.mountExistingExternalObject(e,t):this.mountNewExternalObject(e,t)):this.parentContainer&&this.unmountExternalObject(this.parentContainer,t)}},{key:"mountNewExternalObject",value:function(e,t){t.debug&&console.log("ExternalObjectComponent.mountNewExternalObject: props.id =",t.id);var n=this.newContainer(t.id);n&&(t.debug&&console.log("ExternalObjectComponent: attaching new external object with id =",t.id),e.appendChild(n));var a=this.newExternalObject(e,n);this.externalObjectStore[t.id]={object:a,container:n},this.parentContainer=e,this.externalObjectMounted(a,t,e,n),this.updateExternalComponentAndSaveProps(t)}},{key:"mountExistingExternalObject",value:function(e,t){t.debug&&console.log("ExternalObjectComponent.mountExistingExternalObject: props.id =",t.id);var n=this.externalObjectStore[t.id];de.a(n);var a=n.container;a&&!e.contains(a)&&(t.debug&&console.log("ExternalObjectComponent: attaching existing external object with id =",t.id),e.appendChild(a)),this.parentContainer=e,this.externalObjectMounted(n.object,t,e,a),this.updateExternalComponentAndSaveProps(t)}},{key:"unmountExternalObject",value:function(e,t){this.props.debug&&console.log("ExternalObjectComponent.unmountExternalObject: parentContainer.id =",e.id);var n=this.externalObjectStore[e.id];de.a(n);var a=n.container;a&&e.contains(a)&&(t.debug&&console.log("ExternalObjectComponent: detaching external object with id =",a.id),e.removeChild(a)),this.parentContainer=null,this.externalObjectUnmounted(n.object,t,e,a)}},{key:"updateExternalComponentAndSaveProps",value:function(e){var t=this.externalObjectStore[e.id];de.a(t);var n=t.state,a=this.propsToExternalObjectState(e,n);this.props.debug&&(console.log("ExternalObjectComponent: updating existing external object"),console.log("  this.props.id =",this.props.id),console.log("  nextProps.id  =",e.id),console.log("  prevState     =",n),console.log("  nextState     =",a)),this.shouldExternalObjectUpdate(n,a)&&this.updateExternalObject(t.object,n,a,this.parentContainer,t.container),t.state=a}},{key:"shouldExternalObjectUpdate",value:function(e,t){return!function(e,t){if(e===t)return!0;if(e&&t){var n=typeof e;if(n!==typeof t)return!1;if("Array"===n){if(!e.length!==!t.length)return!1;if(!e.length&&!t.length)return!0;for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}if("object"===n){var r=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(!r.length!==!o.length)return!1;if(!r.length&&!o.length)return!0;var i,l=Object(W.a)(r);try{for(l.s();!(i=l.n()).done;){var c=i.value;if(e[c]!==t[c])return!1}}catch(p){l.e(p)}finally{l.f()}var s,u=Object(W.a)(o);try{for(u.s();!(s=u.n()).done;){var d=s.value;if(e[d]!==t[d])return!1}}catch(p){u.e(p)}finally{u.f()}return!0}}return!1}(e,t)}},{key:"externalObjectStore",get:function(){return this.props.externalObjectStore||n.DEFAULT_EXTERNAL_OBJECT_STORE}}],[{key:"checkProps",value:function(e){if(!e.id)throw new Error("cannot construct ExternalObjectComponent without id")}}]),n}(r.PureComponent);pe.DEFAULT_EXTERNAL_OBJECT_STORE={};var he=n(18),fe=n(109),me=n.n(fe);function be(e,t,n){for(var a=[],r=e.slice(),o=new Set(t.map((function(e){return e.id}))),i=e.length-1;i>=0;i--){var l=e[i];o.has(l.id)||(a.push({type:"REMOVE",index:i,oldElement:l}),r.splice(i,1))}de.a(r.length<=t.length);for(var c=0;c<t.length;c++){var s=t[c];de.a(!!s);var u=r[c];if(u)if(s.id!==u.id){for(var d=-1,p=c+1;p<r.length;p++)if(r[p].id===s.id){d=p;break}if(-1===d)a.push({type:"ADD",index:c,newElement:s}),r.splice(c,0,s);else{a.push({type:"MOVE",index:d,numSteps:c-d});var h=r[d];r.splice(d,1),r.splice(c,0,h),c-=1}}else if(n){var f=n(u,s);null!==f&&"undefined"!==typeof f&&a.push({type:"UPDATE",index:c,oldElement:u,newElement:s,change:f})}else me()(u,s)||a.push({type:"UPDATE",index:c,oldElement:u,newElement:s});else a.push({type:"ADD",index:c,newElement:s}),r.push(s)}return a}var ve=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).sliderElement=void 0,a.dragStartX=void 0,a.handleRef=a.handleRef.bind(Object(E.a)(a)),a.mouseDown=a.mouseDown.bind(Object(E.a)(a)),a.mouseUp=a.mouseUp.bind(Object(E.a)(a)),a.sliderMove=a.sliderMove.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"mouseDown",value:function(e){this.dragStartX=e.clientX-this.sliderElement.offsetLeft,window.addEventListener("mousemove",this.sliderMove,!0)}},{key:"mouseUp",value:function(){window.removeEventListener("mousemove",this.sliderMove,!0)}},{key:"sliderMove",value:function(e){var t=(e.clientX-this.dragStartX)/this.sliderElement.parentElement.offsetWidth;this.props.onChange(t)}},{key:"handleRef",value:function(e){e?(e.addEventListener("mousedown",this.mouseDown,!1),window.addEventListener("mouseup",this.mouseUp,!1),this.dragStartX=0):this.sliderElement&&this.sliderElement.removeEventListener("mousedown",this.mouseDown,!1),this.sliderElement=e}},{key:"render",value:function(){var e=100*this.props.splitPos+"%";return r.createElement("div",{style:Object(a.a)(Object(a.a)({},n.DIV_STYLE),{},{left:e}),ref:this.handleRef})}}]),n}(r.PureComponent);ve.DIV_STYLE={position:"absolute",left:"50%",top:"0px",backgroundColor:"rgba(255, 255, 0, 0.5)",width:"2px",height:"100%",zIndex:5,cursor:"col-resize"};var ye=n(56),ge=new se.e(se.d.CHARTREUSE.withAlpha(.9)),Ee=new se.e(se.d.YELLOW.withAlpha(.9)),Oe=new se.e(se.d.AQUA.withAlpha(.7)),_e=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e,a){var r;Object(y.a)(this,n),(r=t.call(this))._viewer=void 0,r._ellipsoid=void 0,r._toolDataSource=void 0,r._handler=void 0,r._onNewEntity=void 0,r._viewer=e,r._ellipsoid=e.scene.globe.ellipsoid,r._toolDataSource=new se.g("Tool Data Source"),e.dataSources.add(r._toolDataSource);var o=new se.v(e.scene.canvas);return o.setInputAction((function(e){r.tool.isActive()&&(r.onLeftClick(e),r._viewer.scene.requestRender())}),se.w.LEFT_CLICK),o.setInputAction((function(e){r.tool.isActive()&&(r.onLeftDoubleClick(e),r._viewer.scene.requestRender())}),se.w.LEFT_DOUBLE_CLICK),o.setInputAction((function(e){r.tool.isActive()&&(r.onMouseMove(e),r._viewer.scene.requestRender())}),se.w.MOUSE_MOVE),r._handler=o,r._onNewEntity=a,r}return Object(g.a)(n,[{key:"newEntity",value:function(e){this._onNewEntity?this._onNewEntity(new se.i(e)):this._viewer.entities.add(e)}},{key:"addToolEntity",value:function(e){this._toolDataSource.entities.add(e)}},{key:"removeAllToolEntities",value:function(){this._toolDataSource.entities.removeAll()}},{key:"pickEllipsoid",value:function(e){return this._viewer.camera.pickEllipsoid(e,this._ellipsoid)}},{key:"cartesianWithHeightDelta",value:function(e,t){var n=this._ellipsoid.cartesianToCartographic(e);return n.height+=t,this._ellipsoid.cartographicToCartesian(n)}},{key:"cartesianToCartographic",value:function(e){return this._ellipsoid.cartesianToCartographic(e)}},{key:"cartographicToCartesian",value:function(e){return this._ellipsoid.cartographicToCartesian(e)}},{key:"destroy",value:function(){this._handler.destroy()}}]),n}(function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){var e;return Object(y.a)(this,n),(e=t.call(this))._tool=void 0,e._tool=ke,e}return Object(g.a)(n,[{key:"onLeftClick",value:function(e){this._tool.handleLeftClick(e)}},{key:"onLeftDoubleClick",value:function(e){this._tool.handleLeftDoubleClick(e)}},{key:"onMouseMove",value:function(e){this._tool.handleMouseMove(e)}},{key:"tool",set:function(e){e!==this._tool&&(this._tool.deactivate(),this._tool.context=null,this._tool=e,this._tool.context=this,this._tool.activate())},get:function(){return this._tool}}]),n}((function e(){Object(y.a)(this,e)}))),Ce=function(){function e(t){Object(y.a)(this,e),this.type=void 0,this._context=null,this.type=t}return Object(g.a)(e,[{key:"isActive",value:function(){return null!==this._context}},{key:"activate",value:function(){}},{key:"deactivate",value:function(){}},{key:"handleLeftClick",value:function(e){}},{key:"handleLeftDoubleClick",value:function(e){}},{key:"handleMouseMove",value:function(e){}},{key:"context",set:function(e){this._context=e},get:function(){return this._context}}]),e}(),ke=new(function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.call(this,"NoTool")}return n}(Ce)),we=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.call(this,"PointTool")}return Object(g.a)(n,[{key:"handleLeftClick",value:function(e){var t=this.context.pickEllipsoid(e.position);Object(he.b)(t)&&this.context.newEntity(new se.i({position:t,point:{pixelSize:6,outlineWidth:1}}))}}]),n}(Ce),Se=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e,a){var r;return Object(y.a)(this,n),(r=t.call(this,e)).genPolygon=void 0,r.polylinePositions=null,r.polygonPositions=null,r.polylineEntity=null,r.polygonEntity=null,r.hasRubberband=!1,r.genPolygon=a,r}return Object(g.a)(n,[{key:"deactivate",value:function(){this.reset()}},{key:"handleLeftClick",value:function(e){this.addPoint(e.position)}},{key:"handleMouseMove",value:function(e){this.moveLastPoint(e.endPosition)}},{key:"handleLeftDoubleClick",value:function(e){this.endInteraction()}},{key:"addPoint",value:function(e){var t=this.context.pickEllipsoid(e);Object(he.b)(t)&&(t=this.context.cartesianWithHeightDelta(t,10),this.updatePositions(t)&&this.context.addToolEntity(new se.i({position:t,point:{show:!0,outlineColor:se.d.BLACK,outlineWidth:1,color:ge,pixelSize:10}})),this.hasRubberband=!1)}},{key:"endInteraction",value:function(){null!==this.polygonEntity?this.context.newEntity(new se.i({polygon:{hierarchy:new se.t(this.polygonPositions),material:Oe}})):null!==this.polylineEntity&&this.context.newEntity(new se.i({polyline:{positions:this.polylinePositions,material:Ee}})),this.reset()}},{key:"moveLastPoint",value:function(e){if(this.polylinePositions){var t=this.context.pickEllipsoid(e);Object(he.b)(t)&&(this.updatePositions(t),this.hasRubberband=!0)}}},{key:"updatePositions",value:function(e){var t=this.context.cartesianWithHeightDelta(e,5),n=!0;if(null===this.polylinePositions)this.polylinePositions=[t];else{var a=this.polylinePositions.length;this.hasRubberband?this.polylinePositions[a-1]=t:t.equals(this.polylinePositions[a-1])?n=!1:this.polylinePositions.push(t)}if(this.polylinePositions.length>1){var r=this.polylinePositions.slice();this.polylineEntity?n&&(this.polylineEntity.polyline.positions=new se.f(r)):(this.polylineEntity=new se.i({polyline:{positions:r,width:2,material:Ee}}),this.context.addToolEntity(this.polylineEntity))}if(n&&this.genPolygon){var o=this.context.cartesianWithHeightDelta(e,0);if(this.polygonPositions){var i=this.polygonPositions.length;this.hasRubberband?this.polygonPositions[i-1]=o:this.polygonPositions.push(o)}else this.polygonPositions=[o];if(this.polygonPositions.length>2){var l=this.polygonPositions.slice();this.polygonEntity?this.polygonEntity.polygon.hierarchy=new se.f(new se.t(l)):(this.polygonEntity=new se.i({polygon:{hierarchy:new se.t(l),material:Oe}}),this.context.addToolEntity(this.polygonEntity))}}return n}},{key:"reset",value:function(){this.polylinePositions=null,this.polygonPositions=null,this.polylineEntity=null,this.polygonEntity=null,this.hasRubberband=!1,null!==this.context&&this.context.removeAllToolEntities()}}]),n}(Ce),je=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.call(this,"PolylineTool",!1)}return n}(Se),Ie=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.call(this,"PolygonTool",!0)}return n}(Se),Pe=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){var e;return Object(y.a)(this,n),(e=t.call(this,"BoxTool")).position1=null,e.position2=null,e.polygonEntity=null,e}return Object(g.a)(n,[{key:"deactivate",value:function(){this.reset()}},{key:"handleLeftClick",value:function(e){this.setPosition(e.position,!0)}},{key:"handleLeftDoubleClick",value:function(e){this.setPosition(e.position,!0)}},{key:"handleMouseMove",value:function(e){this.position1&&this.setPosition(e.endPosition,!1)}},{key:"setPosition",value:function(e,t){var n=this.context.pickEllipsoid(e);if(Object(he.b)(n))if(null===this.position1)this.position1=n;else{this.position2=n;var a=this.getPositions();if(t)return this.context.newEntity(new se.i({polygon:{hierarchy:new se.t(a),material:Oe}})),void this.reset();null===this.polygonEntity?(this.polygonEntity=new se.i({polygon:{hierarchy:new se.t(a),material:Oe}}),this.context.addToolEntity(this.polygonEntity)):this.polygonEntity.polygon.hierarchy=new se.f(new se.t(a))}}},{key:"getPositions",value:function(){var e=this.context.cartesianToCartographic(this.position1),t=this.context.cartesianToCartographic(this.position2),n=e.longitude,a=e.latitude,r=t.longitude,o=t.latitude,i=.5*(e.height+t.height);return[this.context.cartographicToCartesian(new se.c(n,a,i)),this.context.cartographicToCartesian(new se.c(r,a,i)),this.context.cartographicToCartesian(new se.c(r,o,i)),this.context.cartographicToCartesian(new se.c(n,o,i))]}},{key:"reset",value:function(){this.position1=null,this.position2=null,this.polygonEntity=null,null!==this.context&&this.context.removeAllToolEntities()}}]),n}(Ce);se.o.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJhNzYzYzJjYS00YzY5LTQzN2ItOWQzNy03NWZmZTQyMjU1ZDgiLCJpZCI6MjAwNTAsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJpYXQiOjE1NzY2NjU5ODN9.f-uN5Ocljn77-O2aDNEGPSr8HRHym5RA0aqSWKMgYYk";var De=se.u.fromDegrees(-30,20,40,80),Te=[];se.a.DEFAULT_VIEW_RECTANGLE=De,se.a.DEFAULT_VIEW_FACTOR=0;var Le=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).cesiumEventHandler=void 0,a.selectedEntityChangeHandler=void 0,a.toolContext=void 0,a.handleRemoteBaseLayerError=a.handleRemoteBaseLayerError.bind(Object(E.a)(a)),a.state={isContextMenuOpen:!1},a}return Object(g.a)(n,[{key:"renderChildren",value:function(){return Object(he.d)(this.props.splitLayerPosition)?r.createElement(ve,{splitPos:this.props.splitLayerPosition,onChange:this.props.onLayerSplitPosChange}):null}},{key:"newContainer",value:function(e){var t=document.createElement("div");return t.setAttribute("id","cesium-container-"+e),t.setAttribute("style","width: 100%; height: 100%; overflow: hidden;"),t}},{key:"newExternalObject",value:function(e,t){var a,r=this;this.props.offlineMode&&(a=n.getStaticNaturalEarthImageryProvider());var o={animation:!1,baseLayerPicker:!1,selectionIndicator:!0,fullscreenButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!0,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,automaticallyTrackDataSourceClocks:!1,imageryProvider:a,requestRenderMode:!0,maximumRenderTimeChange:1/0},i=new se.A(t,o);t.oncontextmenu=function(e){return r.handleContextMenu(i,e)},this.props.debug&&(i.scene.debugShowFramesPerSecond=!0),this.props.offlineMode||Object(ye.j)(i,this.props.baseMapOptions);var l=i.selectionIndicator.viewModel,c=l.update;return l.update=function(){var e=l;c.apply(this);var t="top : ".concat(e._screenPositionY,"; left : ").concat(e._screenPositionX,";");e._selectionIndicatorElement.setAttribute("style",t)},i}},{key:"handleRemoteBaseLayerError",value:function(e){console.error("CesiumGlobe: error: ",e.message,e.timesRetried,e.error);var t=this.getExternalObjectRef();if(t){var a=t.object,r=a.imageryLayers.get(0);a.imageryLayers.remove(r,!0);var o=n.getStaticNaturalEarthImageryProvider();a.imageryLayers.addImageryProvider(o,0)}}},{key:"handleContextMenu",value:function(e,t){var n=this,a=this.props.renderContextMenu;if(a){var r=new se.b(t.clientX,t.clientY),o=Object(ye.d)(e,r),i=a(Object(ye.c)(e,o,!0),o,Object(ye.i)(e,o));i&&(t.preventDefault(),k.ContextMenu.show(i,{left:t.clientX,top:t.clientY},(function(){return n.setState({isContextMenuOpen:!1})})),this.setState({isContextMenuOpen:!0}))}}},{key:"propsToExternalObjectState",value:function(e,t){return{selectedPlacemarkId:e.selectedPlacemarkId,baseMapOptions:e.baseMapOptions,imageLayerDescriptors:e.imageLayerDescriptors||Te,vectorLayerDescriptors:e.vectorLayerDescriptors||Te,overlayHtml:e.overlayHtml||null,geometryToolType:e.geometryToolType,splitLayerPosition:e.splitLayerPosition,dataSourceMap:t&&t.dataSourceMap||{}}}},{key:"updateExternalObject",value:function(e,t,a){var r=t&&t.baseMapOptions||null,o=t&&t.selectedPlacemarkId||null,i=t&&t.imageLayerDescriptors||Te,l=t&&t.vectorLayerDescriptors||Te,c=t&&t.overlayHtml||null,s=t&&t.splitLayerPosition,u=t&&t.geometryToolType||"NoTool",d=a.baseMapOptions,p=a.selectedPlacemarkId||null,h=a.imageLayerDescriptors||Te,f=a.vectorLayerDescriptors||Te,m=a.overlayHtml,b=a.splitLayerPosition,v=a.geometryToolType||"NoTool",y=!1;r===d||this.props.offlineMode||Object(ye.j)(e,d),i!==h&&(this.updateImageLayers(e,i,h),y=!0),l!==f&&(this.updateVectorLayers(e,l,f,a.dataSourceMap,p),y=!0),o!==p&&(this.updatePlacemarkSelection(e,p),y=!0),c!==m&&(n.updateOverlayHtml(e,c,m),y=!0),s!==b&&(Object(he.d)(b)&&(e.scene.imagerySplitPosition=b),y=!0),u!==v&&this.activateGeometryTool(e,v),y&&e.scene.requestRender()}},{key:"externalObjectMounted",value:function(e,t){function n(t,n,a){if(a){var r=Object(ye.c)(e,t,!0);n?a(r,t,Object(ye.i)(e,t)):a(r,t)}}this.cesiumEventHandler=new se.v(e.scene.canvas),this.cesiumEventHandler.setInputAction((function(e){return n(e.position,!0,t.onLeftUp)}),se.w.LEFT_UP),this.cesiumEventHandler.setInputAction((function(e){return n(e.position,!0,t.onLeftClick)}),se.w.LEFT_CLICK),this.cesiumEventHandler.setInputAction((function(e){return n(e.position,!0,t.onRightClick)}),se.w.RIGHT_CLICK),this.cesiumEventHandler.setInputAction((function(e){return n(e.endPosition,!1,t.onMouseMove)}),se.w.MOUSE_MOVE),this.selectedEntityChangeHandler=function(e){t.onSelectedEntityChanged&&t.onSelectedEntityChanged(e)},e.selectedEntityChanged.addEventListener(this.selectedEntityChangeHandler),this.toolContext=new _e(e,t.onNewEntityAdded),this.activateGeometryTool(e,t.geometryToolType),e.scene.requestRender(),t.onViewerMounted&&t.onViewerMounted(t.id,e)}},{key:"externalObjectUnmounted",value:function(e,t){this.cesiumEventHandler&&(this.cesiumEventHandler.destroy(),this.cesiumEventHandler=null),this.selectedEntityChangeHandler&&(e.selectedEntityChanged.removeEventListener(this.selectedEntityChangeHandler),this.selectedEntityChangeHandler=null),this.toolContext&&(this.toolContext.destroy(),this.toolContext=null),t.onViewerUnmounted&&t.onViewerUnmounted(t.id,e)}},{key:"updatePlacemarkSelection",value:function(e,t){var n=t&&Object(ye.h)(e,t)||null,a=e.selectedEntity||null;this.props.debug&&console.log("CesiumGlobe: updating selected placemark: ",a,n),a!==n&&(e.selectedEntity=n)}},{key:"updatePlacemarks",value:function(e,t,a,r){this.props.debug&&console.log("CesiumGlobe: updating placemarks");var o,i=be(t&&t.features||Te,a&&a.features||Te),l=[],c=Object(W.a)(i);try{for(c.s();!(o=c.n()).done;){var s=o.value;this.props.debug&&console.log("CesiumGlobe: next placemark action",s),function(){switch(s.type){case"ADD":var t=s.newElement,a=t.properties.visible,o=se.j.load(t,Object(ye.k)(r));l.push(o.then((function(t){return n.moveEntities(t.entities,e,!Object(he.a)(a)||a),t})));break;case"REMOVE":var i=s.oldElement;e.removeById(i.id);break;case"UPDATE":var c=s.oldElement,u=s.newElement,d=u.properties.visible,p=se.j.load(u,Object(ye.k)(r));l.push(p.then((function(t){return e.removeById(c.id),n.moveEntities(t.entities,e,!Object(he.a)(d)||d),t})));break;default:console.error('CesiumGlobe: unhandled placemark action type "'.concat(s.type,'"'))}}()}}catch(u){c.e(u)}finally{c.f()}return Promise.all(l)}},{key:"updateImageLayers",value:function(e,t,a){this.props.debug&&console.log("CesiumGlobe: updating image layers");var r,o,i,l,c=be(t,a),s=Object(W.a)(c);try{for(s.s();!(l=s.n()).done;){var u=l.value;this.props.debug&&console.log("CesiumGlobe: next image layer action",u);var d=u.index+1;switch(u.type){case"ADD":if(!(r=this.addLayer(e,u.newElement,d))){console.error("CesiumGlobe: no imageryLayer at index "+d);break}n.setLayerProps(r,u.newElement);break;case"REMOVE":if(!(r=e.imageryLayers.get(d))){console.error("CesiumGlobe: no imageryLayer at index "+d);break}this.removeLayer(e,r,d);break;case"UPDATE":if(!(r=e.imageryLayers.get(d))){console.error("CesiumGlobe: no imageryLayer at index "+d);break}i=u.oldElement,o=u.newElement,i.imageryProviderOptions.url!==o.imageryProviderOptions.url&&(this.removeLayer(e,r,d),(r=this.addLayer(e,o,d)).minificationFilter=se.y.NEAREST,r.magnificationFilter=se.x.NEAREST),n.setLayerProps(r,o);break;case"MOVE":if(!(r=e.imageryLayers.get(d))){console.error("CesiumGlobe: no imageryLayer at index "+d);break}if(u.numSteps<0)for(var p=0;p<-u.numSteps;p++)e.imageryLayers.lower(r);else for(var h=0;h<u.numSteps;h++)e.imageryLayers.raise(r);break;default:console.error('CesiumGlobe: unhandled layer action type "'.concat(u.type,'"'))}}}catch(f){s.e(f)}finally{s.f()}}},{key:"updateVectorLayers",value:function(e,t,n,a,r){this.props.debug&&console.log("CesiumGlobe: updating vector layers");var o,i=be(t,n),l=Object(W.a)(i);try{for(l.s();!(o=l.n()).done;){var c=o.value;switch(this.props.debug&&console.log("CesiumGlobe: next vector layer action",c),c.type){case"ADD":this.addDataSource(e,c.newElement,a);break;case"REMOVE":this.removeDataSource(e,c.oldElement,a);break;case"UPDATE":this.updateDataSource(e,c.oldElement,c.newElement,a,r);break;case"MOVE":break;default:console.error('CesiumGlobe: unhandled layer action type "'.concat(c.type,'"'))}}}catch(s){l.e(s)}finally{l.f()}}},{key:"addDataSource",value:function(e,t,a){var r=this,o=n.getDataSource(e,t);e.dataSources.add(o).then((function(n){r.props.debug&&console.log("CesiumGlobe: added data source: ".concat(t.name)),a[t.id]=n,r.setDataSourceProps(e,n,t)}))}},{key:"removeDataSource",value:function(e,t,n){var a=n[t.id];a&&(delete n[t.id],e.dataSources.remove(a,!0),this.props.debug&&console.log("CesiumGlobe: removed data source: ".concat(t.name)),e.scene.requestRender())}},{key:"updateDataSource",value:function(e,t,n,a,r){var o=n.id,i=a[o];if(i){var l=t.dataSourceOptions.data,c=n.dataSourceOptions.data;l!==c&&(Object(he.e)(c)?(this.removeDataSource(e,t,a),this.addDataSource(e,n,a)):this.updatePlacemarks(i.entities,l,c,n.style).then((function(){if(r){var t=i.entities.getById(r);t&&t!==e.selectedEntity&&(e.selectedEntity=t)}})));var s=t.style,u=n.style;if(s!==u){var d=Object(ue.diff)(s,u);if(Object.getOwnPropertyNames(d).length>0){var p=Object(ye.k)(d,u);Object(ye.b)(p,i.entities.values)}}var h=t.entityStyles,f=n.entityStyles;if(h!==f){var m,b=Object(ue.diff)(h,f),v=Object(W.a)(Object.getOwnPropertyNames(b));try{for(v.s();!(m=v.n()).done;){var y=m.value,g=i.entities.getById(y);if(g){var E=b[y];if(Object.getOwnPropertyNames(E).length>0){var O=Object(ye.k)(E,f[y]);Object(ye.a)(O,g)}}}}catch(_){v.e(_)}finally{v.f()}}this.setDataSourceProps(e,i,n)}else console.warn("CesiumGlobe: dataSource for vector layer not ready yet, layerId =",o)}},{key:"addLayer",value:function(e,t,a){var r=n.getImageryProvider(e,t),o=e.imageryLayers.addImageryProvider(r,a);return this.props.debug&&console.log("CesiumGlobe: added imagery layer #".concat(a,": ").concat(t.name)),o}},{key:"removeLayer",value:function(e,t,n){e.imageryLayers.remove(t,!0),this.props.debug&&console.log("CesiumGlobe: removed imagery layer #".concat(n))}},{key:"setDataSourceProps",value:function(e,t,n){Promise.resolve(t).then((function(t){t.show=n.visible,e.scene.requestRender()}))}},{key:"activateGeometryTool",value:function(e,t){t!==this.toolContext.tool.type&&("NoTool"===t?this.toolContext.tool=ke:"PointTool"===t?this.toolContext.tool=new we:"PolylineTool"===t?this.toolContext.tool=new je:"PolygonTool"===t?this.toolContext.tool=new Ie:"BoxTool"===t&&(this.toolContext.tool=new Pe))}},{key:"viewer",get:function(){var e=this.getExternalObjectRef();return e?e.object:null}}],[{key:"getStaticNaturalEarthImageryProvider",value:function(){var e={url:se.C("")+"Assets/Textures/NaturalEarthII/{z}/{x}/{reverseY}.jpg",tilingScheme:new se.k,minimumLevel:0,maximumLevel:2,credit:"Natural Earth II: Tileset Copyright \xa9 2012-2014 Analytical Graphics, Inc. (AGI). Original data courtesy Natural Earth and in the public domain."};return new se.z(e)}},{key:"updateOverlayHtml",value:function(e,t,n){if(n)if(t){if(!e.container.contains(t))return void console.warn("CesiumGlobe: previous HTML element is not a child",t);e.container.replaceChild(n,t)}else e.container.appendChild(n);else if(t){if(!e.container.contains(t))return void console.warn("CesiumGlobe: previous HTML element is not a child",t);e.container.removeChild(t)}}},{key:"getImageryProvider",value:function(e,t){return t.imageryProvider?"function"===typeof t.imageryProvider?t.imageryProvider(e,t.imageryProviderOptions):t.imageryProvider:null}},{key:"getDataSource",value:function(e,t){return"function"===typeof t.dataSource?t.dataSource(e,t.dataSourceOptions):t.dataSource}},{key:"setLayerProps",value:function(e,t){e.show=t.visible,e.alpha=t.opacity,e.brightness=t.brightness,e.contrast=t.contrast,e.hue=t.hue,e.saturation=t.saturation,e.gamma=t.gamma,e.minificationFilter=se.y.NEAREST,e.magnificationFilter=se.x.NEAREST,"left"===t.splitMode?e.splitDirection=se.n.LEFT:"right"===t.splitMode?e.splitDirection=se.n.RIGHT:e.splitDirection=se.n.NONE}},{key:"moveEntities",value:function(e,t,n){var a,r=Object(W.a)(e.values.slice());try{for(r.s();!(a=r.n()).done;){var o=a.value;o.show=n,t.add(o),e.remove(o)}}catch(i){r.e(i)}finally{r.f()}}}]),n}(pe),Ae=n(25),Re=n(226),Ne=n(65),xe=n(45),Me=new Set(["POINT","LINESTRING","POLYGON","MULTIPOINT","MULTILINESTRING","MULTIPOLYGON","GEOMETRYCOLLECTION"]),Ve=new Array(Me.values()).map((function(e){return'"'.concat(e,'"')})).join(", ");function Be(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function We(e,t){var n=parseFloat(e);if(isNaN(n)&&"nan"!==e.toLowerCase())throw new Error(t||"Value must be a number.");return n}function Ue(e,t){if(e&&""!==(e=e.trim())){var n=!1;if(Be(e)){n=!0;for(var a=1;a<e.length&&Be(e[a]);a++);var r=e.substr(0,a).toUpperCase();e=e.substr(a),function(e,t){var n=t.toUpperCase();if("Geometry"===t){if(!Me.has(e))throw new Error("".concat(t," WKT must start with one of ").concat(Ve,"."))}else if(!e.startsWith(n))throw new Error("".concat(t,' WKT must start with "').concat(n,'".'))}(r,t),function(e,t){var n,a,r;"POINT"===t?(n=0,a=1,r=1):"LINESTRING"===t?(n=1,a=1,r=1):"POLYGON"===t?(n=3,a=2,r=2):"MULTIPOINT"===t?(n=1,a=1,r=2):"MULTILINESTRING"===t?(n=1,a=2,r=2):"MULTIPOLYGON"===t?(n=3,a=3,r=3):"GEOMETRYCOLLECTION"===t&&(n=0,a=1,r=3);for(var o=0,i=0,l=0,c=0;c<e.length;c++){var s=e[c];if("("===s){if(++i>r)throw new Error('Invalid WKT, too many "(".');l=Math.max(l,i)}else if(")"===s){if(--i<0)throw new Error('Invalid WKT, too many ")".');if(0===i){if(o<n)throw new Error("Invalid WKT, too few coordinates.");o=0}}else","===s&&o++}if(0!==i)throw new Error('Invalid WKT, too many "(".');if(l<a)throw new Error('Invalid WKT, too few "(".')}(e,r)}var o,i,l=e.split(/[\s,()]+/);if(l.length&&""===l[0]&&(o=1),l.length&&""===l[l.length-1]&&(i=l.length-1),o>0&&i>0?l=l.slice(o,i):o>0?l=l.slice(o):i>0&&(l=l.slice(0,i)),l.length%2!==0)throw new Error("Illegal number of coordinates.");if(!n)if("Point"===t){if(2!==l.length)throw new Error('Point must have "<Longitude>, <Latitude>" syntax.')}else{if("Polygon"!==t)throw new Error("Invalid WKT.");if(4!==l.length)throw new Error('Bounding box must have "<E>, <S>, <W>, <N>" syntax.')}for(var c=0;c<l.length;c+=2){Fe(We(l[c],"Longitude value must be a number."),We(l[c+1],"Latitude value must be a number."))}}}function Fe(e,t){if(e<-180||e>180)throw new Error("Longitude must be in the range -180 to +180 degrees.");if(t<-90||t>90)throw new Error("Latitude must be in the range -90 to +90 degrees.")}function Ge(e){if("Polygon"===e.type&&1===e.coordinates.length){var t=e.coordinates[0];if(5===t.length){var n=t[0][0],a=t[0][1],r=t[1][0],o=t[1][1],i=t[2][0],l=t[2][1],c=t[3][0],s=t[3][1],u=t[4][0],d=t[4][1];return 0===r-n&&0===l-o&&0===c-i&&0===d-s||0===o-a&&0===i-r&&0===s-l&&0===u-c}}return!1}function Ye(e){if("Point"===e.type){var t=e.coordinates;return"POINT (".concat(t[0]," ").concat(t[1],")")}if("LineString"===e.type){var n,a=e.coordinates,r=[],o=Object(W.a)(a);try{for(o.s();!(n=o.n()).done;){var i=n.value;r.push("".concat(i[0]," ").concat(i[1]))}}catch(b){o.e(b)}finally{o.f()}return"LINESTRING (".concat(r.join(", "),")")}if("Polygon"===e.type){var l,c=e.coordinates,s=[],u=Object(W.a)(c);try{for(u.s();!(l=u.n()).done;){var d,p=l.value,h=[],f=Object(W.a)(p);try{for(f.s();!(d=f.n()).done;){var m=d.value;h.push("".concat(m[0]," ").concat(m[1]))}}catch(b){f.e(b)}finally{f.f()}s.push("(".concat(h.join(", "),")"))}}catch(b){u.e(b)}finally{u.f()}return"POLYGON (".concat(s.join(", "),")")}return""}var He=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).intervalHandle=void 0,a.lastPosition=void 0,a.positionChanged=void 0,a.intervalHandle=null,a.lastPosition=null,a.positionChanged=!1,a.handleMouseMove=a.handleMouseMove.bind(Object(E.a)(a)),a.handleSelectedEntityChanged=a.handleSelectedEntityChanged.bind(Object(E.a)(a)),a.handleNewEntityAdded=a.handleNewEntityAdded.bind(Object(E.a)(a)),a.handleSplitLayerPosChange=a.handleSplitLayerPosChange.bind(Object(E.a)(a)),a.handlePosDataUpdate=a.handlePosDataUpdate.bind(Object(E.a)(a)),a.renderContextMenu=a.renderContextMenu.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){this.intervalHandle=window.setInterval(this.handlePosDataUpdate,n.POS_UPDATE_PERIOD)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.intervalHandle)}},{key:"handlePosDataUpdate",value:function(){this.positionChanged&&(this.props.dispatch(p.Dc(this.lastPosition)),this.positionChanged=!1)}},{key:"handleMouseMove",value:function(e){var t=this.lastPosition;e!==t&&(e&&t&&e.longitude===t.longitude&&e.latitude===t.latitude||(this.props.dispatch(p.Cc(e)),this.lastPosition=e,this.positionChanged=!0))}},{key:"handleSelectedEntityChanged",value:function(e){this.props.dispatch(p.kc(this.props.view.id,this.props.selectedLayer,e))}},{key:"handleNewEntityAdded",value:function(e){var t=this.newPlacemarkProperties(),n=Object(ye.e)(e,"".concat(Ae.i).concat(e.id),t);this.props.dispatch(p.Ab(n))}},{key:"handleSplitLayerPosChange",value:function(e){this.props.dispatch(p.Fc(this.props.view.id,e))}},{key:"renderContextMenu",value:function(e,t,n){var a=this;if(!e&&!n)return null;var o,i,l=n&&n.id;l&&l.startsWith(Ae.i)&&this.props.placemarks&&(o=this.props.placemarks.features.find((function(e){return e.id===l}))),o?i=Ye(o.geometry):n?i=Object(ye.f)(n):e&&(i="POINT (".concat(e.longitude," ").concat(e.latitude,")"));var c=0,s=[];if(e){var u=this.newPlacemarkProperties(),d=p.Bb(e.longitude,e.latitude,u);s.push(r.createElement(k.MenuItem,{key:c,icon:"map-marker",text:"Place point marker here",onClick:function(){return a.props.dispatch(d)}})),c++}i&&(s.push(r.createElement(k.MenuItem,{key:c,icon:"clipboard",text:"Copy geometry WKT",onClick:function(){return p.Lb(i)}})),c++);var h,f=this.props.operations;if(n&&f&&(i.startsWith("POINT ")?h=xe.p:i.startsWith("POLYGON ")&&(h=xe.q),h)){var m,b=!1,v=Object(W.a)(f);try{for(v.s();!(m=v.n()).done;){var y,g=m.value,E=void 0,O=Object(W.a)(g.inputs);try{for(O.s();!(y=O.n()).done;){var _=y.value,C=_.dataType;if(C===h||C===xe.l){E=_;break}}}catch(w){O.e(w)}finally{O.f()}E&&function(){b||(s.push(r.createElement(k.MenuDivider,{key:c})),b=!0,c++);var e=Object(B.a)({},E.name,{isValueUsed:!0,constantValue:i,resourceName:null}),t=p.Xb(g,e),n="".concat(g.name,"()");s.push(r.createElement(k.MenuItem,{key:c,icon:"function",text:n,onClick:function(){return a.props.dispatch(t)}})),c++}()}}catch(w){v.e(w)}finally{v.f()}}return r.createElement(k.Menu,null,s)}},{key:"newPlacemarkProperties",value:function(){return Object(a.a)({visible:!0},Object(Ne.b)(this.props.defaultPlacemarkStyle))}},{key:"render",value:function(){if(!this.props.hasWebGL)return ee;var e,t=this.props.view,a=this.props.view.id,o=t.data.layers,i=this.props.placemarks,l=this.props.showLayerTextOverlay,c=this.props.workspace,s=c&&c.resources||F.a,u=null;if(c){var d=this.props.baseUrl,p=c.baseDir;e=Object(Re.a)(o,s,i,d,p),u=this.props.selectedPlacemarkId}else e=F.b;var h,f=e.imageLayerDescriptors||F.a,m=e.vectorLayerDescriptors||F.a;(function(e){var t,n=Object(W.a)(e);try{for(n.s();!(t=n.n()).done;){if((t.value.splitMode||U.b)!==U.b)return!0}}catch(a){n.e(a)}finally{n.f()}return!1})(f)&&(h=t.data.layerSplitPosition);var b=function(e,t,n,a){var r=null;if(!t)return r;for(var o=0;o<e.length;o++){var i=e[o];if("VariableImage"===i.type&&i.visible){var l=Object(Ae.v)(a,i);r||((r=document.createElement("div")).id="CesiumGlobeOverlay-"+n,r.style.position="absolute",r.style["z-index"]=10,r.style["pointer-events"]="none",r.style.padding="1em",r.style["background-color"]="rgba(0, 0, 0, 0.25)");var c=void 0;c=l&&l.length?i.name+" at "+l.map((function(e){return e.join(" = ")})).join(", "):i.name;var s=document.createElement("div");s.style["font-size"]="1.4em",s.innerText=c,r.appendChild(s),r.style.top="0",r.style.width="100%"}}return r}(o,l,a,s);return r.createElement(Le,{id:"CesiumGlobe-"+t.id,debug:this.props.debugWorldView,externalObjectStore:this.props.externalObjectStore,selectedPlacemarkId:u,baseMapOptions:this.props.baseMapOptions,imageLayerDescriptors:f,vectorLayerDescriptors:m,splitLayerPosition:h,overlayHtml:b,onLayerSplitPosChange:this.handleSplitLayerPosChange,offlineMode:this.props.offlineMode,style:n.CESIUM_GLOBE_STYLE,onMouseMove:this.props.isDialogOpen?null:this.handleMouseMove,onSelectedEntityChanged:this.handleSelectedEntityChanged,onNewEntityAdded:this.handleNewEntityAdded,geometryToolType:this.props.newPlacemarkToolType,renderContextMenu:this.renderContextMenu})}}]),n}(r.Component);He.CESIUM_GLOBE_STYLE={position:"relative",width:"100%",height:"100%",overflow:"hidden"},He.POS_UPDATE_PERIOD=500;var Ke=Object(i.b)((function(e,t){return{view:t.view,baseUrl:F.fc(e),operations:F.T(e),workspace:F.nc(e),offlineMode:F.P(e),placemarks:F.W(e),selectedLayer:F.rb(e),selectedLayerId:F.pb(e),selectedPlacemarkId:F.xb(e),baseMapOptions:F.k(e),isDialogOpen:F.H(e),showLayerTextOverlay:e.session.showLayerTextOverlay,debugWorldView:e.session.debugWorldView,hasWebGL:e.data.hasWebGL,externalObjectStore:F.y(e),newPlacemarkToolType:F.O(e),defaultPlacemarkStyle:F.w(e)}}))(He);var ze=function(){function e(){Object(y.a)(this,e),this.listenersMap=void 0,this.listenersMap={},this.dispatchCommand=this.dispatchCommand.bind(this)}return Object(g.a)(e,[{key:"addCommandListener",value:function(e,t){var n=this.listenersMap[e];n||(n=new Set,this.listenersMap[e]=n),n.add(t)}},{key:"removeCommandListener",value:function(e,t){var n=this.listenersMap[e];n&&(n.delete(t),0===n.size&&delete this.listenersMap[e])}},{key:"removeCommandListeners",value:function(e){delete this.listenersMap[e]}},{key:"dispatchCommand",value:function(e,t){var n=this.listenersMap[e];n&&n.forEach((function(n){n(e,t)}))}}]),e}(),qe=function(){function e(t,n,a,r,o){var i=this;Object(y.a)(this,e),this.id=void 0,this.webSocket=void 0,this.commandSource=void 0,this.onMessage=void 0,this.parentElement=void 0,this.figureImageCanvas=void 0,this.rubberBandCanvas=void 0,this.imageObj=void 0,this.imageMode=void 0,this.waiting=void 0,this.lastKey=void 0,this.resizeTimer=void 0,this.lastSize=void 0,this.id=t,this.parentElement=a,this.commandSource=r,this.onMessage=o,this.imageMode="full",this.imageObj=new Image,this.lastSize={width:0,height:0},this.handleCommand=this.handleCommand.bind(this),this.processMessage=this.processMessage.bind(this),this.initCanvas(),this.waiting=!1,this.imageObj.onload=function(){var e=i.figureImageCanvas.getContext("2d");"full"===i.imageMode&&e.clearRect(0,0,i.figureImageCanvas.width,i.figureImageCanvas.height),e.drawImage(i.imageObj,0,0)},this.imageObj.onunload=function(){this.webSocket.removeEventListener("message",this.processMessage)},this.webSocket=new WebSocket(n),this.webSocket.onopen=function(){i.commandSource&&i.commandSource.addCommandListener(i.id,i.handleCommand),i.webSocket.addEventListener("message",i.processMessage);var e=!!i.webSocket.binaryType;e||console.warn("This browser does not support binary websocket messages. Figure update performance may be slow."),i.sendMessage("supports_binary",{value:e}),i.sendMessage("send_image_mode"),i.sendRefresh(),i.sendResize(),i.resizeTimer=window.setInterval((function(){var e=i.parentElement.clientWidth,t=i.parentElement.clientHeight,n=e>0&&t>0,a=i.lastSize.width!==e||i.lastSize.height!==t;n&&a&&(i.lastSize={width:e,height:t},i.sendResize(e,t))}),500)},this.webSocket.onclose=function(){i.commandSource&&i.commandSource.removeCommandListener(i.id,i.handleCommand),i.resizeTimer&&window.clearInterval(i.resizeTimer)}}return Object(g.a)(e,[{key:"handleCommand",value:function(e,t){e===this.id?this.sendMessage("toolbar_button",t):console.warn("received invalid figure ID: expected #".concat(this.id,", got #").concat(e," for data ").concat(t))}},{key:"initCanvas",value:function(){var e=this,t=this.handleKeyboardEvent.bind(this);this.parentElement.onkeydown=Je("key_press",t),this.parentElement.onkeyup=Je("key_release",t),this.parentElement.onwheel=function(t){var n=t.deltaY<0?1:-1;e.handleMouseEvent(t,{name:"scroll",step:n})};var n=document.createElement("canvas");n.id="mpl-figure-image-"+this.id,n.setAttribute("style","left: 0; top: 0; z-index: 0; outline: 0"),this.figureImageCanvas=n;var a=document.createElement("canvas");a.id="mpl-rubber-band-"+this.id,a.setAttribute("style","position: absolute; left: 0; top: 0; z-index: 1;");var r=this.handleMouseEvent.bind(this);a.onmousedown=Je("button_press",r),a.onmouseup=Je("button_release",r),a.onmousemove=Je("motion_notify",r),a.onmouseenter=Je("figure_enter",r),a.onmouseleave=Je("figure_leave",r),a.getContext("2d").strokeStyle="#000000",this.rubberBandCanvas=a,this.parentElement.appendChild(n),this.parentElement.appendChild(a)}},{key:"resizeCanvas",value:function(e,t){this.figureImageCanvas.setAttribute("width",e),this.figureImageCanvas.setAttribute("height",t),this.rubberBandCanvas.setAttribute("width",e),this.rubberBandCanvas.setAttribute("height",t)}},{key:"sendResize",value:function(e,t){e=e||this.parentElement.clientWidth,t=t||this.parentElement.clientHeight,this.sendMessage("resize",{width:e,height:t})}},{key:"sendDrawMessage",value:function(){this.waiting||(this.waiting=!0,this.sendMessage("draw"))}},{key:"sendRefresh",value:function(){this.sendMessage("refresh")}},{key:"sendCanvasUpdated",value:function(){this.sendMessage("ack")}},{key:"sendMessage",value:function(e,t){var n=JSON.stringify(Object(a.a)(Object(a.a)({},t),{},{type:e,figure_id:this.id}));this.webSocket.send(n)}},{key:"processMessage",value:function(e){if(e.data instanceof Blob){var t=e.data;return this.imageObj.src&&(window.URL||window.webkitURL).revokeObjectURL(this.imageObj.src),this.imageObj.src=(window.URL||window.webkitURL).createObjectURL(t),this.sendCanvasUpdated(),void(this.waiting=!1)}if("string"===typeof e.data&&"data:image/png;base64"===e.data.slice(0,21))return this.imageObj.src=e.data,this.sendCanvasUpdated(),void(this.waiting=!1);var n=e.data,a=JSON.parse(n),r=a.type;try{var o=this["handle_"+r];if(o)try{o.bind(this)(a)}catch(i){console.error("Exception inside the 'handler_"+r+"' callback:",i,i.stack,a)}}catch(i){console.error("No handler for the '"+r+"' message type: ",a)}}},{key:"handle_resize",value:function(e){var t=e.size;t[0]===this.figureImageCanvas.width&&t[1]===this.figureImageCanvas.height||(this.resizeCanvas(t[0],t[1]),this.sendRefresh())}},{key:"handle_rubberband",value:function(e){var t=e.x0,n=this.figureImageCanvas.height-e.y0,a=e.x1,r=this.figureImageCanvas.height-e.y1;t=Math.floor(t)+.5,n=Math.floor(n)+.5,a=Math.floor(a)+.5,r=Math.floor(r)+.5;var o=Math.min(t,a),i=Math.min(n,r),l=Math.abs(a-t),c=Math.abs(r-n),s=this.rubberBandCanvas.getContext("2d");s.clearRect(0,0,this.figureImageCanvas.width,this.figureImageCanvas.height),s.strokeRect(o,i,l,c)}},{key:"handle_figure_label",value:function(e){}},{key:"handle_message",value:function(e){this.onMessage&&this.onMessage(e.message)}},{key:"handle_cursor",value:function(e){var t=e.cursor;this.rubberBandCanvas.style.cursor={0:"pointer",1:"default",2:"crosshair",3:"move"}[t]}},{key:"handle_draw",value:function(){this.sendDrawMessage()}},{key:"handle_image_mode",value:function(e){this.imageMode=e.mode}},{key:"handleMouseEvent",value:function(e,t){var n=t.name,a=t.step,r=function(e){var t;e.target?t=e.target:e.srcElement&&(t=e.srcElement);3===t.nodeType&&(t=t.parentNode);var n=document.body.getBoundingClientRect(),a=t.getBoundingClientRect(),r=a.left-n.left,o=a.top-n.top,i=e.pageX-r,l=e.pageY-o;return{x:i,y:l}}(e);"button_press"===n&&(this.figureImageCanvas.focus(),this.parentElement.focus());var o=r.x,i=r.y;return this.sendMessage(n,{x:o,y:i,button:e.button,step:a,guiEvent:Xe(e)}),e.preventDefault(),!1}},{key:"handleKeyboardEvent",value:function(e,t){var n=t.name;if("key_press"===n){if(e.which===this.lastKey)return;this.lastKey=e.which}"key_release"===n&&(this.lastKey=null);var a="";e.ctrlKey&&17!==e.which&&(a+="ctrl+"),e.altKey&&18!==e.which&&(a+="alt+"),e.shiftKey&&16!==e.which&&(a+="shift+"),a+="k",a+=e.which.toString(),this.sendMessage(n,{key:a,guiEvent:Xe(e)})}}]),e}();function Je(e,t){return function(n){t(n,{name:e})}}function Xe(e){return Object.keys(e).reduce((function(t,n){return"object"!==typeof e[n]&&(t[n]=e[n]),t}),{})}var Ze=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"propsToExternalObjectState",value:function(e,t){return{figureUpdateCount:e.figureUpdateCount}}},{key:"newContainer",value:function(e){var t=document.createElement("div");return t.setAttribute("id","mpl-figure-container-"+e),t.setAttribute("style","width: 100%; position: relative;"),this.props.figureHeight&&(t.style.height=this.props.figureHeight),this.props.debug&&console.log("MplFigureContainer.newContainer:",t),t}},{key:"newExternalObject",value:function(e,t){return new qe(this.props.figureId,this.props.webSocketUrl,t,this.props.commandSource,this.props.onMessage)}},{key:"updateExternalObject",value:function(e,t,n,a,r){this.props.debug&&console.log("MplFigureContainer.updateExternalObject: ",e,t,n),t&&t.figureUpdateCount!==n.figureUpdateCount&&(e.sendRefresh(),e.sendResize())}}]),n}(pe);function Qe(e){var t;e.large||(t="bp3-small"),e.className&&""!==e.className&&(t="".concat(t," ").concat(e.className));var n=r.createElement(k.AnchorButton,{className:t,onClick:e.onClick,disabled:e.disabled,icon:e.icon,intent:e.intent,style:e.style,text:e.text,active:e.active});return e.tooltipContent?r.createElement(k.Tooltip,{content:e.tooltipContent,position:e.tooltipPosition||k.PopoverPosition.AUTO},n):n}var $e=new ze,et=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).state={},a.handleFigureMessage=a.handleFigureMessage.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"handleFigureMessage",value:function(e){this.setState({message:e})}},{key:"render",value:function(){return r.createElement("div",{style:n.DIV_STYLE},r.createElement(Ze,{figureId:this.props.figureId,figureUpdateCount:this.props.figureUpdateCount,figureHeight:this.props.figureHeight||"30em",id:this.props.id,debug:!1,webSocketUrl:this.props.webSocketUrl,style:n.CONTAINER_DIV_STYLE,commandSource:$e,onMessage:this.handleFigureMessage}),r.createElement(tt,{figureId:this.props.figureId,message:this.state.message,onCommand:$e.dispatchCommand,onDownload:this.props.onDownload}))}}],[{key:"handleClose",value:function(e){$e.removeCommandListeners(e)}}]),n}(r.Component);et.DIV_STYLE={width:"100%",overflow:"auto"},et.CONTAINER_DIV_STYLE={width:"100%",overflow:"hidden",padding:"0.2em 0.2em 0 0.2em"};var tt=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;Object(y.a)(this,n),(a=t.call(this,e)).commands=void 0,a.commands=[{label:"Home",tooltip:"Reset original view",icon:"home",name:"home"},{label:"Back",tooltip:"Back to  previous view",icon:"chevron-left",name:"back"},{label:"Forward",tooltip:"Forward to next view",icon:"chevron-right",name:"forward"},{label:"Pan",tooltip:"Pan axes with left mouse, zoom with right",icon:"move",name:"pan"},{label:"Zoom",tooltip:"Zoom to rectangle",icon:"zoom-in",name:"zoom"},{label:"Save As",tooltip:"Save as image",icon:"download",name:"download"}];var r,o=Object(W.a)(a.commands);try{var i=function(){var e=r.value,t=e.name,n=void 0;n="download"===t?function(){a.props.onDownload(a.props.figureId,{name:t})}:function(){a.props.onCommand(a.props.figureId,{name:t})},e.callback=n};for(o.s();!(r=o.n()).done;)i()}catch(l){o.e(l)}finally{o.f()}return a}return Object(g.a)(n,[{key:"render",value:function(){var e,t=[];for(var a in this.commands){var o=this.commands[a];if(o.name){var i=o.tooltip,l=o.icon,c=o.callback;t.push(r.createElement(Qe,{key:a,tooltipContent:i,icon:l,onClick:c}))}}return this.props.message&&(e=r.createElement(k.Tag,{className:"bp3-minimal"},this.props.message)),r.createElement("div",{style:n.DIV_STYLE},e,r.createElement("span",{style:{flex:"auto"}}),r.createElement(k.ButtonGroup,null,t))}}]),n}(r.PureComponent);tt.DIV_STYLE={display:"flex",alignItems:"center",padding:"0.2em"};var nt=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onDownload=a.onDownload.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onDownload",value:function(e){var t=Object(Ae.I)(this.props.baseUrl,this.props.baseDir,e);this.props.dispatch(p.uc(t,e))}},{key:"render",value:function(){var e=this.props.view,t=this.getFigureResource();if(!t)return r.createElement(k.Card,null,"Figure not found.");var n="MplFigurePanel-".concat(t.id,"-").concat(e.id);return r.createElement(et,{key:n,id:n,figureId:t.id,figureUpdateCount:t.updateCount,figureName:t.name,webSocketUrl:Object(Ae.J)(this.props.mplWebSocketUrl,this.props.baseDir,t.id),onDownload:this.onDownload})}},{key:"getFigureResource",value:function(){var e=this.props.view.data;return this.props.figureResources.find((function(t){return t.id===e.resourceId}))}}]),n}(r.Component);nt.DIV_STYLE={width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"};var at=Object(i.b)((function(e,t){return{view:t.view,baseUrl:F.fc(e),baseDir:F.kc(e),figureResources:F.z(e),mplWebSocketUrl:F.N(e)}}))(nt),rt=n(41),ot=n(224);var it=Object(i.b)((function(e){return{webAPIServiceInfo:F.gc(e),webAPIServiceURL:F.hc(e)}}))((function(e){var t=e.webAPIServiceInfo,n=e.webAPIServiceURL;if(!t)return null;var a=t.autoStopInfo;if(!a)return null;var o=a.availableTime,i=a.remainingTime,l=a.inactivityTime;if(!o||!i||!l)return null;var c=Math.max(900,.75*o);if(!(i>1&&i<c))return null;var s=function(){try{(new ot.a).getServiceInfo(n)}catch(e){console.error(e)}};return r.createElement(rt.a,{isOpen:!0,title:"Service Shutdown Ahead",icon:"offline",noCancelButton:!0,confirmTitle:"Keep Alive",confirmIconName:"link",confirmTooltip:"Requests keeping the service available.",onCancel:s,onConfirm:s,canConfirm:function(){return!0},renderBody:function(){return r.createElement("div",null,r.createElement("p",null,"The Cate service will shut down soon due to inactivity since ",lt(l),". After the shutdown you will need to reconnect/login first. Unsaved changes will be lost."),r.createElement("p",null,"The remaining time is ",r.createElement("strong",null,lt(i)),"."),r.createElement("p",null,'Press "Keep Alive" to prevent the shutdown.'))}})}));function lt(e){var t=Math.floor(e/3600),n=e-3600*t,a=Math.floor(n/60),r=Math.round(n-60*a),o=[];return t>0&&o.push("".concat(t," hour").concat(1!==t?"s":"")),a>0&&o.push("".concat(a," minute").concat(1!==a?"s":"")),o.push("".concat(r," second").concat(1!==r?"s":"")),o.join(", ")}var ct=n(173),st=n(421),ut=n(806);var dt=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"componentWillMount",value:function(){var e=this.props.viewData;e.dataRows||e.isLoading||e.error||this.props.dispatch(p.bc(this.props.viewId,e.resName,e.varName))}},{key:"render",value:function(){return r.createElement("div",{style:n.TABLE_CONTAINER_STYLE},this.renderDataTable())}},{key:"renderDataTable",value:function(){var e,t=this.props.viewData;if(de.a(t),t.isLoading)return r.createElement("div",{style:n.LOADING_CONTAINER_STYLE},r.createElement(k.Spinner,{className:"bp3-large"}),r.createElement("p",null,"Loading table data..."));if(t.error)return e=t.error,r.createElement(k.NonIdealState,{title:"Loading table data failed",description:r.createElement("span",null,"".concat(e)),icon:"circle"});var a=t.dataRows;if(!a||!a.length)return ce;var o=a[0],i=Object.getOwnPropertyNames(o).filter((function(e){return""!==e})),l=function(e,t){return a[e][i[t]]},c=[];for(var s in i){c.push(r.createElement(st.a,{key:s,name:i[s],cellRenderer:function(e,t){return r.createElement(ct.a,null,l(e,t))}}))}return r.createElement(ut.a,{numRows:a.length,enableRowHeader:!0,getCellClipboardData:l,children:c})}}]),n}(r.PureComponent);dt.TABLE_CONTAINER_STYLE={width:"100%",height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"},dt.LOADING_CONTAINER_STYLE={width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"};var pt=Object(i.b)((function(e,t){return{viewId:t.view.id,viewData:t.view.data,resources:F.bb(e),resNames:F.ab(e)}}))(dt),ht=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;if(Object(y.a)(this,n),(a=t.call(this,e)).lastPosition=null,a.bodyEventListeners=void 0,!e.onChange)throw Error("onChange property must be provided");return a.bodyEventListeners=[["mousemove",a.onBodyMouseMove.bind(Object(E.a)(a))],["mouseup",a.onBodyMouseUp.bind(Object(E.a)(a))],["onmouseenter",a.onBodyMouseEnter.bind(Object(E.a)(a))],["onmouseleave",a.onBodyMouseLeave.bind(Object(E.a)(a))]],a}return Object(g.a)(n,[{key:"onMouseDown",value:function(e){this.isButton1Pressed(e)?(this.lastPosition=this.getCurrentPosition(e),this.removeBodyMouseListeners(),this.addBodyMouseListeners()):this.lastPosition=null}},{key:"onBodyMouseMove",value:function(e){if(null!==this.lastPosition&&this.isButton1Pressed(e)){var t=this.getCurrentPosition(e),n=t-this.lastPosition;this.lastPosition=t,0!==n&&this.props.onChange(n)}}},{key:"onBodyMouseUp",value:function(e){this.endDragging()}},{key:"onBodyMouseEnter",value:function(e){this.endDragging()}},{key:"onBodyMouseLeave",value:function(e){this.endDragging()}},{key:"isButton1Pressed",value:function(e){return 0===e.button&&1===e.buttons}},{key:"getCurrentPosition",value:function(e){return"hor"===this.props.dir?e.screenX:e.screenY}},{key:"endDragging",value:function(){this.removeBodyMouseListeners(),this.lastPosition=null}},{key:"addBodyMouseListeners",value:function(){this.bodyEventListeners.forEach((function(e){return document.body.addEventListener(e[0],e[1])}))}},{key:"removeBodyMouseListeners",value:function(){this.bodyEventListeners.forEach((function(e){return document.body.removeEventListener(e[0],e[1])}))}},{key:"componentWillUnmount",value:function(){this.removeBodyMouseListeners()}},{key:"render",value:function(){var e="hor"===this.props.dir?"cate-splitter-hor":"cate-splitter-ver";return r.createElement("div",{className:e,onMouseDown:this.onMouseDown.bind(this)})}}]),n}(r.PureComponent),ft=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleSplitDelta=a.handleSplitDelta.bind(Object(E.a)(a)),a.state={size:e.initialSize},a}return Object(g.a)(n,[{key:"handleSplitDelta",value:function(e){var t=this;this.setState((function(n){var a=n.size,r=a+e;return t.props.onChange&&t.props.onChange(r,a),{size:r}}))}},{key:"render",value:function(){var e,t,n;if("hor"===this.props.dir){var a=this.state.size;e="cate-split-pane-hor",t={flex:"none",width:a,height:"100%"},n={flex:"auto",width:"calc(100% - ".concat(a+4,"px)"),height:"100%"}}else{var o=this.state.size;e="cate-split-pane-ver",t={flex:"none",width:"100%",height:o},n={flex:"auto",width:"100%",height:"calc(100% - ".concat(o+4,"px)")}}return r.createElement("div",{className:e},r.createElement("div",{style:t},this.props.children[0]),r.createElement(ht,{dir:this.props.dir,onChange:this.handleSplitDelta}),r.createElement("div",{style:n},this.props.children[1]))}}]),n}(r.PureComponent),mt=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleSwitchChange=a.handleSwitchChange.bind(Object(E.a)(a)),a.handleContentHeightChange=a.handleContentHeightChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"handleSwitchChange",value:function(e){this.props.onShowDetailsChange(e.target.checked)}},{key:"handleContentHeightChange",value:function(e,t){this.props.onContentHeightChange&&this.props.onContentHeightChange(e)}},{key:"render",value:function(){var e,t=this.props.children[0],n=this.props.children[1],a=r.createElement(k.Switch,{checked:this.props.showDetails,style:{alignSelf:"flex-end",marginBottom:0},label:"Details",disabled:!n,onChange:this.handleSwitchChange}),o=this.props.showDetails?n:null;e=this.props.actionComponent?r.createElement("div",{style:{display:"flex",alignItems:"flex-end"}},a,r.createElement("span",{style:{flex:"auto"}}),this.props.actionComponent):a;var i=r.createElement("div",null,e,o);return this.props.isSplitPanel?r.createElement(ft,{dir:"ver",initialSize:this.props.contentHeight||300,onChange:this.handleContentHeightChange},t,i):r.createElement("div",null,t,i)}}]),n}(r.PureComponent),bt=n(171),vt=function(e){var t=e.dataSource,n=e.style,o=Object(Ae.y)(t),i=o.catalogUrl,l=o.infoUrl;return i||l?r.createElement("div",{style:Object(a.a)({display:"flex",justifyContent:"flex-end"},n)},i&&r.createElement(k.AnchorButton,{href:i,target:"_blank",style:{float:"right",margin:4}},"Catalogue"),l&&r.createElement(k.AnchorButton,{href:l,target:"_blank",style:{float:"right",margin:4}},"More Info")):null},yt=n(103),gt=n(422),Et=n.n(gt),Ot=n(423),_t=n.n(Ot),Ct={fontFamily:"Source Code Pro, Consolas, monospace",color:k.Colors.LIGHT_GRAY1},kt={em:function(e){e.node;var t=Object(yt.a)(e,["node"]);return r.createElement("em",Object.assign({className:"user-selectable"},t))},li:function(e){e.node;var t=Object(yt.a)(e,["node"]);return r.createElement("li",Object.assign({className:"user-selectable"},t))},p:function(e){e.node;var t=Object(yt.a)(e,["node"]);return r.createElement("p",Object.assign({className:"user-selectable"},t))},span:function(e){e.node;var t=Object(yt.a)(e,["node"]);return r.createElement("span",Object.assign({className:"user-selectable"},t))},div:function(e){e.node;var t=Object(yt.a)(e,["node"]);return r.createElement("div",Object.assign({className:"user-selectable"},t))},code:function(e){e.node;var t=Object(yt.a)(e,["node"]);return r.createElement("code",Object.assign({className:"user-selectable",style:Ct},t))},pre:function(e){e.node;var t=Object(yt.a)(e,["node"]);return r.createElement("pre",Object.assign({className:"user-selectable",style:Ct},t))}},wt=function(e){var t=e.source;return r.createElement(Et.a,{remarkPlugins:[_t.a],components:kt,linkTarget:"_blank"},t)},St={width:"100%",height:"100%",overflow:"auto"};function jt(e){return r.createElement("div",{style:St},e.children)}var It={display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around"},Pt=function(e){var t,n,a=e.dataSource;if(!a)return null;var o=a.metaInfo;o&&(t=Object.keys(o).filter((function(e){return"data_vars"!==e&&"coords"!==e})),o.data_vars&&(n=o.data_vars));var i=[Dt(a),Tt(n),Lt(o,t),At(o)];return r.createElement(k.Tabs,{id:"dsDetails",renderActiveTabPanelOnly:!0},i.map((function(e){return r.createElement(k.Tab,{key:e.id,id:e.id,title:e.title,panel:e.element})})))};function Dt(e){var t,n,a,o=e.metaInfo;if(o){if(Array.isArray(o.bbox)){var i=Object(m.a)(o.bbox,4),l=i[0],c=i[1],s=i[2],u=i[3];t=r.createElement("div",null,r.createElement("h5",null,"Spatial coverage"),r.createElement("table",null,r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null),r.createElement("td",{className:"user-selectable"},u,"\xb0"),r.createElement("td",null)),r.createElement("tr",null,r.createElement("td",{className:"user-selectable"},l,"\xb0"),r.createElement("td",null),r.createElement("td",{className:"user-selectable"},s,"\xb0")),r.createElement("tr",null,r.createElement("td",null),r.createElement("td",{className:"user-selectable"},c,"\xb0"),r.createElement("td",null)))),r.createElement("br",null))}if(e.metaInfo&&e.metaInfo.time_range){var d=Object(m.a)(e.metaInfo.time_range,2),p=d[0],h=d[1];p||h?p?h||(h="today"):p="unknown":p=h="unknown",n=r.createElement("div",null,r.createElement("h5",null,"Temporal coverage"),r.createElement("table",null,r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,"Start"),r.createElement("td",{className:"user-selectable"},p)),r.createElement("tr",null,r.createElement("td",null,"End"),r.createElement("td",{className:"user-selectable"},h)))),r.createElement("br",null))}o.abstract&&(a=r.createElement("div",null,r.createElement("h5",null,"Summary"),r.createElement(wt,{source:o.abstract})))}return{title:"Abstract",id:"abstract",element:t||n||a?r.createElement(jt,null,r.createElement(k.Card,null,r.createElement(vt,{dataSource:e}),r.createElement("div",{style:It},t,n),a)):r.createElement(k.Card,null,r.createElement(vt,{dataSource:e}),r.createElement("p",null,"No abstract available."))}}function Tt(e){var t;if(e&&e.length>0){t=r.createElement(ut.a,{numRows:e.length,enableRowHeader:!1,getCellClipboardData:function(e,t){console.error("not implemented: getCellClipboardData: ",e,t)}},r.createElement(st.a,{name:"Name",cellRenderer:function(t){var n=e[t];return r.createElement(ct.a,{tooltip:n.long_name},r.createElement(bt.a,{className:"user-selectable"},n.name))}}),r.createElement(st.a,{name:"Units",cellRenderer:function(t){var n=e[t];return r.createElement(ct.a,null,r.createElement(bt.a,{className:"user-selectable"},n.units||"-"))}}))}else t=r.createElement(k.Card,null,"No information about variables available.");return{title:"Variables",id:"var",element:t}}function Lt(e,t){var n;if(e&&t){n=r.createElement(ut.a,{numRows:t.length,enableRowHeader:!1,getCellClipboardData:function(e,t){console.error("not implemented: getCellClipboardData: ",e,t)}},r.createElement(st.a,{name:"Key",cellRenderer:function(e){var n=t[e];return r.createElement(ct.a,null,r.createElement(bt.a,null,n))}}),r.createElement(st.a,{name:"Value",cellRenderer:function(n){var a=t[n];return r.createElement(ct.a,null,r.createElement(bt.a,null,e[a]))}}))}else n=r.createElement(k.Card,null,"No global meta-information available.");return{title:"Meta-Info",id:"meta",element:n}}function At(e){return{title:"Licences",id:"licences",element:e&&e.licences?r.createElement("div",null,r.createElement(wt,{source:e.licences})):r.createElement(k.Card,null,"No license information available.")}}var Rt=n(424),Nt={display:"flex",alignItems:"flex-start"},xt={color:k.Colors.BLUE5,fontSize:"0.8em"},Mt={marginRight:4},Vt={color:k.Colors.GREEN4,fontSize:"0.8em",marginLeft:4},Bt={width:32,height:32,flex:"none",marginRight:6,borderRadius:16,textAlign:"center",color:"white",display:"flex",justifyContent:"center",alignItems:"center"},Wt=function(e){var t,n,o=e.dataSource,i=e.showDataSourceIDs,l=o.metaInfo,c=function(e){var t,n,a=e.id.toLowerCase();if(a.startsWith("esacci.")){var r=a.split(".",2);r.length>1&&(t=r[1])}if(!t&&a.startsWith("esacci-")){var o=a.split("-",2);o.length>1&&(t=o[1])}t||(t=a);var i=Rt.mappings[t];i&&(t=i);var l,c=t&&Rt.ecvs[t];c&&(l=Rt.colors[c.color]||c.color,n=c.label||n);l||(l=Rt.colors.default||"#0BB7A0");n||(n=t&&t.substr(0,3).toUpperCase()||"?");return{backgroundColor:l,label:n}}(o),s=c.backgroundColor,u=c.label,d=r.createElement("div",{style:Object(a.a)(Object(a.a)({},Bt),{},{backgroundColor:s})},u),p=o.title||l&&l.title;return p&&p!==o.id||(p=function(e){var t=e.id.replace(/\./g," ").replace(/-/g," ").replace(/_/g,"-");if(t.startsWith("esacci "))return t.substr("esacci ".length);if(t.startsWith("ESACCI "))return t.substr("ESACCI ".length);return t}(o)),!Object(Ae.o)(o)&&(t=r.createElement(k.Icon,{icon:"warning-sign",intent:k.Intent.WARNING,iconSize:16,style:Mt})),o.dataType&&(n=r.createElement("span",{style:Vt},o.dataType)),r.createElement("div",{style:Nt},d,i?r.createElement("div",null,r.createElement("div",{className:"user-selectable"},t,p,n),r.createElement("div",{className:"user-selectable",style:xt},o.id)):r.createElement("span",{className:"user-selectable"},t,p,n))};var Ut=n(46),Ft=function(e){var t=e.dataSources,n=e.selectedDataSourceId,a=e.setSelectedDataSourceId,o=e.showDataSourceIDs,i=e.doubleClickAction;return r.createElement(jt,null,r.createElement(Ut.a,{key:"DataSourcesList-"+o,items:t,getItemKey:function(e){return e.id},renderItem:function(e){return r.createElement(Wt,{dataSource:e,showDataSourceIDs:o})},selectionMode:Ut.b.SINGLE,selection:n,onItemDoubleClick:i,onSelection:function(e){e.length>0?a(e[0]):a(null)}}))},Gt=function(e){var t,n=e.dataSource;return t=e.isSandboxedMode?r.createElement("p",null,"This data source cannot be opened directly from its data store. You may",r.createElement("ol",null,r.createElement("li",null,"Download it manually to your computer;"),r.createElement("li",null,"Upload it using ",r.createElement("strong",null,"Files / Upload Files"),";"),r.createElement("li",null,"Use one of the available ",r.createElement("code",null,"read_xxx()"),' operations to open the uploaded data. "xxx" is determined by the type and format of the data.'))):r.createElement("p",null,"This data source cannot be opened directly from its data store. You may",r.createElement("ol",null,r.createElement("li",null,"Download it manually to your computer;"),r.createElement("li",null,"Use one of the available ",r.createElement("code",null,"read_xxx()"),' operations to open the downloaded data. "xxx" is determined by the type and format of the data.'))),r.createElement("div",null,r.createElement(k.H5,null,"Manual intervention required"),t,r.createElement(vt,{dataSource:n,style:{marginTop:8}}))},Yt=n(66);var Ht=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).state={dataSourceName:"",filePathPattern:""},a.onCancel=a.onCancel.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.onDataSourceNameChange=a.onDataSourceNameChange.bind(Object(E.a)(a)),a.onFilePathPatternChange=a.onFilePathPatternChange.bind(Object(E.a)(a)),a.showSelectDirectoryDialog=a.showSelectDirectoryDialog.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({dataSourceName:"",filePathPattern:""})}},{key:"onCancel",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID))}},{key:"canConfirm",value:function(){return!!this.state.dataSourceName&&!!this.state.filePathPattern}},{key:"onConfirm",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID,this.state)),this.props.dispatch(p.zb(this.state.dataSourceName,this.state.filePathPattern))}},{key:"onDataSourceNameChange",value:function(e){this.setState({dataSourceName:e.target.value})}},{key:"onFilePathPatternChange",value:function(e){this.setState({filePathPattern:e.target.value})}},{key:"showSelectDirectoryDialog",value:function(){var e=this,t={title:"Select Directory",buttonLabel:"Select",defaultPath:""!==this.state.filePathPattern?Object(Yt.c)(this.state.filePathPattern):void 0};this.props.dispatch(p.ed(t,(function(t){t&&e.setState({filePathPattern:t+"/*.nc"})})))}},{key:"render",value:function(){var e=this.props.isOpen;return e?r.createElement(rt.a,{isOpen:e,title:"Add file data source",icon:"add",confirmTitle:"Add",confirmIconName:"add",confirmTooltip:"Add file data source.",onCancel:this.onCancel,canConfirm:this.canConfirm,onConfirm:this.onConfirm,renderBody:this.renderBody}):null}},{key:"renderBody",value:function(){return this.props.isOpen?r.createElement("div",null,r.createElement("p",null,"Define a new file data source using a file path pattern."),r.createElement("p",{style:{marginTop:"1em"}},"Name:"),r.createElement(k.InputGroup,{type:"text",style:{width:"100%"},value:this.state.dataSourceName,onChange:this.onDataSourceNameChange}),r.createElement("p",{style:{marginTop:"1em"}},"Path pattern",r.createElement("span",{className:"bp3-text-muted"},' (can contain wildcards like "*" or "?")'),":"),r.createElement(k.ControlGroup,{style:{flexGrow:1,width:"100%"}},r.createElement(k.InputGroup,{type:"text",fill:!0,value:this.state.filePathPattern,onChange:this.onFilePathPatternChange}),r.createElement(k.AnchorButton,{intent:k.Intent.PRIMARY,style:{flex:"none"},onClick:this.showSelectDirectoryDialog},"..."))):null}}]),n}(r.Component);Ht.DIALOG_ID="addDatasetDialog";var Kt=Object(i.b)((function(e){return{isOpen:F.x(Ht.DIALOG_ID)(e).isOpen}}))(Ht),zt=n(102);function qt(e){return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,10)}function Jt(e,t){if(e&&!t){var n=e.lastIndexOf(":");n>=1&&(e=e.substr(0,n));var a=e.lastIndexOf(".");a>=0&&(e=e.substr(a+1))}return e}var Xt=n(99),Zt=n(71),Qt=n(55),$t=[new Date("1980-01-01"),new Date(Date.now())],en=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"parseValue",value:function(e){return tn(e,this.props.nullable)}},{key:"formatValue",value:function(e){return nn(e)}},{key:"validateValue",value:function(e){Object(Xt.a)(Object(Zt.a)(n.prototype),"validateValue",this).call(this,e),an(e,this.props.nullable,this.props.min,this.props.max)}}]),n}(Qt.a);function tn(e,t,n){if(!e||""===e.trim()){if(t)return null;throw new Error("Date must be given.")}var a;if(!/^\d\d\d\d-\d\d-\d\d$/.test(e.trim()))throw new Error("Date not valid: >"+e+"<");try{a=Date.parse(e.trim())}catch(r){throw new Error("Invalid ".concat(n||"date","."))}return new Date(a)}function nn(e){return Object(he.g)(e)?"":qt(e)}function an(e,t,n,a,r){if(e){if(n&&e.valueOf()<n.valueOf())throw new Error("".concat(r||"Date"," must not be before ").concat(nn(n),"."));if(a&&e.valueOf()>a.valueOf())throw new Error("".concat(r||"Date"," must not be after ").concat(nn(a),"."))}else if(!t)throw Error("Date value expected.")}en.defaultProps={uncontrolled:!0,placeholder:"YYYY-MM-DD"};var rn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"parseValue",value:function(e){return function(e,t){if(!e||""===e.trim()){if(t)return null;throw new Error("Date range must be given.")}var n=e.split(",");if(2!==n.length||""===n[0].trim()||""===n[1].trim())throw new Error("Invalid date range.");var a=tn(n[0],!0,"first date"),r=tn(n[1],!0,"second date");if(!a&&!r)return null;return[a,r]}(e,this.props.nullable)}},{key:"formatValue",value:function(e){return function(e){if(Object(he.g)(e))return"";var t=e[0],n=e[1];if(!t&&!n)return"";return nn(t)+","+nn(n)}(e)}},{key:"validateValue",value:function(e){Object(Xt.a)(Object(Zt.a)(n.prototype),"validateValue",this).call(this,e),on(e,this.props.nullable,this.props.min,this.props.max)}}]),n}(Qt.a);function on(e,t,n,a){if(e){var r=e[0],o=e[1];if(an(r,t,n,a,"First date"),an(o,t,n,a,"Second date"),r&&o&&r.valueOf()>o.valueOf())throw new Error("First date must not be after second date.")}else if(!t)throw Error("Date range value expected.")}rn.defaultProps={uncontrolled:!0,placeholder:"YYYY-MM-DD, YYYY-MM-DD",size:24};var ln={wordWrap:"break-word"},cn=function(e){var t=e.label,n=e.longId;return r.createElement(r.Fragment,null,r.createElement("p",null,t),r.createElement("div",{style:ln},r.createElement("strong",null,n)))},sn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleNumericInputChange=a.handleNumericInputChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"parseValue",value:function(e){if(!e||""===e.trim())return null;var t=parseFloat(e);if(isNaN(t)&&"nan"!==e.toLowerCase())throw new Error("Please enter a valid number.");return t}},{key:"formatValue",value:function(e){return Object(he.g)(e)?"":e.toString()}},{key:"validateValue",value:function(e){Object(Xt.a)(Object(Zt.a)(n.prototype),"validateValue",this).call(this,e),un(e,this.props.nullable,this.props.min,this.props.max,this.props.isInt)}},{key:"handleNumericInputChange",value:function(e,t){this.setValueAndTextValue(e,t)}},{key:"render",value:function(){return r.createElement(k.NumericInput,{value:this.getTextValue(),onValueChange:this.handleNumericInputChange,onBlur:this.handleBlur,onKeyPress:this.handleKeyPress,style:this.props.style,intent:this.getError()?k.Intent.DANGER:k.Intent.NONE,min:this.props.min,max:this.props.max,size:this.props.size,minorStepSize:this.props.isInt?1:.1,selectAllOnFocus:!0})}}]),n}(Qt.a);function un(e,t,n,a,r){if(Object(he.g)(e)){if(!t)throw Error("Numeric value expected")}else{if(!Object(he.d)(e))throw new Error("Value must be a number.");if(r&&e!==Math.floor(e))throw new Error("Value must be an integer.");if(Object(he.d)(n)&&e<n)throw new Error("Value must be >= ".concat(this.props.min,"."));if(Object(he.d)(a)&&e>a)throw new Error("Value must be <= ".concat(this.props.max,"."))}}var dn={west:{value:-180},south:{value:-90},east:{value:180},north:{value:90}},pn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onEastChange=a.onEastChange.bind(Object(E.a)(a)),a.onSouthChange=a.onSouthChange.bind(Object(E.a)(a)),a.onWestChange=a.onWestChange.bind(Object(E.a)(a)),a.onNorthChange=a.onNorthChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onWestChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.value),{},{west:e}))}},{key:"onEastChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.value),{},{east:e}))}},{key:"onNorthChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.value),{},{north:e}))}},{key:"onSouthChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.value),{},{south:e}))}},{key:"render",value:function(){var e=this.props.value;return r.createElement("div",null,r.createElement("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"flex-start",padding:2}},r.createElement("div",{style:{flexGrow:0,width:"14em"}},"Lon. from"),r.createElement("div",{style:{flexGrow:1,width:"100%"}},this.renderField(e&&e.west||null,-180,180,this.onWestChange)),r.createElement("div",{style:{flexGrow:0,width:"4em"}}," to"),r.createElement("div",{style:{flexGrow:1,width:"100%"}},this.renderField(e&&e.east||null,-180,180,this.onEastChange))),r.createElement("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"flex-start",padding:2}},r.createElement("div",{style:{flexGrow:0,width:"14em"}},"Lat. from"),r.createElement("div",{style:{flexGrow:1,width:"100%"}},this.renderField(e&&e.south||null,-90,90,this.onSouthChange)),r.createElement("div",{style:{flexGrow:0,width:"4em"}},"to"),r.createElement("div",{style:{flexGrow:1,width:"100%"}},this.renderField(e&&e.north||null,-90,90,this.onNorthChange))))}},{key:"renderField",value:function(e,t,a,o){return r.createElement(sn,{value:e,style:n.NUMBER_FIELD_STYLE,min:t,max:a,size:10,onChange:o,disabled:this.props.disabled,nullable:!0,uncontrolled:this.props.uncontrolled})}}]),n}(r.PureComponent);pn.NUMBER_FIELD_STYLE={textAlign:"right"};var hn=n(52),fn={color:"rgba(0,255,0,0.8)",fontSize:"0.8em"},mn={width:"15em"},bn=function(e){var t=e.label,n=e.units,a=e.dataType,o=e.fullyQualified,i=e.tooltipText,l=e.em,c=e.style,s=t,u=Jt(a,o),d=n&&""!==n?" (".concat(n,")"):"",p=r.createElement("span",null,l?r.createElement("em",null,s):s," ",d," ",r.createElement("span",{style:fn},u," "));return i&&""!==i&&(p=r.createElement(k.Tooltip,{content:r.createElement("div",{style:mn},i),position:"top"},p)),r.createElement("span",{style:c},p)},vn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onSelection=a.onSelection.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.state={value:a.props.value},a}return Object(g.a)(n,[{key:"onSelection",value:function(e){this.setState({value:e})}},{key:"onConfirm",value:function(){this.props.onConfirm(this.state.value)}},{key:"render",value:function(){return r.createElement(rt.a,{isOpen:this.props.isOpen,title:this.props.multiSelect?"Select Variables":"Select Variable",icon:"variable",onConfirm:this.onConfirm,onCancel:this.props.onCancel,renderBody:this.renderBody})}},{key:"renderBody",value:function(){if(!this.props.isOpen)return null;var e=this.props.resource.variables;return e?r.createElement(jt,null,r.createElement("p",null,this.props.multiSelect?"Select one or more the variables:":"Select variable:"),r.createElement(Ut.a,{items:e,getItemKey:n.getVariableItemKey,renderItem:n.renderVariableItem,selectionMode:this.props.multiSelect?Ut.b.MULTIPLE:Ut.b.SINGLE,selection:this.state.value,style:{height:"20em"},onSelection:this.onSelection,onItemDoubleClick:this.state.value?this.onConfirm:null})):r.createElement("p",null,'Resource "'.concat(this.props.resource.name,'" does not seem to have any variables.'))}}],[{key:"getVariableItemKey",value:function(e){return e.name}},{key:"renderVariableItem",value:function(e){var t=e.dimNames?"".concat(e.dataType,"[").concat(e.dimNames,"]"):"".concat(e.dataType);return r.createElement("div",null,r.createElement(bn,{label:e.name,dataType:t,units:e.units,tooltipText:e.attributes&&e.attributes.long_name}))}}]),n}(r.Component),yn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(E.a)(a)),a.validate=a.validate.bind(Object(E.a)(a)),a.state={isDetailsEditorOpen:!1},a}return Object(g.a)(n,[{key:"onChange",value:function(e){this.props.onChange(this.props.input,e)}},{key:"validate",value:function(e){!function(e,t,n,a){if(!e||""===e.trim()){if(!t)throw new Error(n?"One or more variable names expected.":"Variable name expected.");return}var r=e.split(",");if(n){var o,i=Object(W.a)(r);try{for(i.s();!(o=i.n()).done;){if(""===o.value.trim())throw new Error("Value must be a comma-separated list of variable names.")}}catch(d){i.e(d)}finally{i.f()}}else{if(1!==r.length)throw new Error("Value must be a single variable name.");if(""===r[0].trim())throw new Error("Value must be a variable name.")}if(a&&a.variables){var l,c=new Set(a.variables.map((function(e){return e.name}))),s=Object(W.a)(r);try{for(s.s();!(l=s.n()).done;){var u=l.value;if(!c.has(u))throw new Error('"'.concat(u,'" is not a name of any variable in resource ').concat(a.name,"."))}}catch(d){s.e(d)}finally{s.f()}}}(e,this.props.input.nullable,this.props.multi,this.props.resource)}},{key:"render",value:function(){var e=this,t=Object(Qt.c)(this.props.value),a=""!==t?t.split(",").map((function(e){return e.trim()})):[],o=this.props.resource&&this.props.resource.variables&&this.props.resource.variables.length;return r.createElement(k.ControlGroup,{fill:!0,style:n.DIV_STYLE},r.createElement(hn.a,{value:this.props.value,validator:this.validate,placeholder:this.props.multi?"Enter variable names, separated by comma":"Enter variable name",onChange:this.onChange,nullable:this.props.input.nullable,style:n.TEXT_FIELD_STYLE}),r.createElement(k.AnchorButton,{intent:k.Intent.PRIMARY,onClick:function(){return e.setState({isDetailsEditorOpen:!0})},disabled:!o,style:n.BUTTON_STYLE},"..."),r.createElement(vn,{isOpen:this.state.isDetailsEditorOpen,resource:this.props.resource,multiSelect:this.props.multi,value:a,onConfirm:function(t){var n=t?t.join(", "):null;e.setState({isDetailsEditorOpen:!1}),e.onChange({textValue:n,value:n})},onCancel:function(){e.setState({isDetailsEditorOpen:!1})}}))}}]),n}(r.Component);yn.DIV_STYLE={display:"flex",justifySelf:"stretch"},yn.TEXT_FIELD_STYLE={flexGrow:1},yn.BUTTON_STYLE={flexGrow:0};var gn={marginTop:8,marginBottom:8},En=r.createElement(k.Icon,{icon:zt.a.WARNING_SIGN,intent:k.Intent.WARNING}),On=r.createElement(k.Icon,{icon:zt.a.ERROR,intent:k.Intent.DANGER}),_n=r.createElement(k.Icon,{icon:zt.a.ISSUE,intent:k.Intent.PRIMARY}),Cn={marginTop:4,marginBottom:4},kn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onHasTimeConstraintChange=a.onHasTimeConstraintChange.bind(Object(E.a)(a)),a.onDateRangeChange=a.onDateRangeChange.bind(Object(E.a)(a)),a.onHasRegionConstraintChange=a.onHasRegionConstraintChange.bind(Object(E.a)(a)),a.onRegionChange=a.onRegionChange.bind(Object(E.a)(a)),a.onHasVariablesConstraintChange=a.onHasVariablesConstraintChange.bind(Object(E.a)(a)),a.onVariableNamesChange=a.onVariableNamesChange.bind(Object(E.a)(a)),a.onMakeLocalSelectedChange=a.onMakeLocalSelectedChange.bind(Object(E.a)(a)),a.onMakeLocalDataSourceIdChange=a.onMakeLocalDataSourceIdChange.bind(Object(E.a)(a)),a.onOpenDatasetResourceNameChange=a.onOpenDatasetResourceNameChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onDateRangeChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{dateRange:e}))}},{key:"onRegionChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{region:e}))}},{key:"onHasTimeConstraintChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{hasTimeConstraint:e.target.checked}))}},{key:"onHasRegionConstraintChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{hasRegionConstraint:e.target.checked}))}},{key:"onHasVariablesConstraintChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{hasVariablesConstraint:e.target.checked}))}},{key:"onVariableNamesChange",value:function(e,t){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{variableNames:t}))}},{key:"onMakeLocalSelectedChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{isCacheDataSourceSelected:e.target.checked}))}},{key:"onMakeLocalDataSourceIdChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{cachedDataSourceId:e.target.value}))}},{key:"onOpenDatasetResourceNameChange",value:function(e){this.props.onChange(Object(a.a)(Object(a.a)({},this.props.options),{},{openDatasetResourceName:e.target.value}))}},{key:"render",value:function(){if(!this.props.dataSource)return null;var e=this.props.options,t=new Date("1970-01-01"),a=new Date(Date.now()),o=this.props.temporalCoverage;o&&(o[0]&&(t=new Date(o[0])),o[1]&&(a=new Date(o[1])));var i,l=o&&r.createElement("div",{style:Cn},"Available time range: ".concat(o.join(", "))),c=e.hasTimeConstraint,s=c?e.dateRange:null,u=r.createElement("div",{style:n.SUB_PANEL_STYLE},r.createElement(k.Checkbox,{disabled:!o||!this.props.canConstrainTime,checked:c,label:"Time constraint",onChange:this.onHasTimeConstraintChange}),r.createElement(k.Collapse,{isOpen:c},r.createElement("div",{style:n.OPTION_DIV_STYLE},r.createElement(rn,{nullable:!0,min:t,max:a,value:s,onChange:this.onDateRangeChange}),l))),d=e.hasRegionConstraint,p=d?e.region||dn:e.region,h=r.createElement("div",{style:n.SUB_PANEL_STYLE},r.createElement(k.Checkbox,{disabled:!this.props.canConstrainRegion,checked:d,label:"Region constraint",onChange:this.onHasRegionConstraintChange}),r.createElement(k.Collapse,{isOpen:this.props.canConstrainRegion&&d},r.createElement("div",{style:n.OPTION_DIV_STYLE},r.createElement(pn,{value:p,disabled:!d,onChange:this.onRegionChange})))),f=e.hasVariablesConstraint,b=n.dataSourceToResource(this.props.dataSource),v=r.createElement("div",{style:n.SUB_PANEL_STYLE},r.createElement(k.Checkbox,{disabled:!this.props.canConstrainVariables,checked:f,label:"Variables constraint",onChange:this.onHasVariablesConstraintChange}),r.createElement(k.Collapse,{isOpen:f},r.createElement("div",{style:n.OPTION_DIV_STYLE},r.createElement(yn,{input:n.VAR_NAMES_INPUT,value:e.variableNames,onChange:this.onVariableNamesChange,resource:b,multi:!0}))));if(this.props.canCache&&!this.props.isLocalDataSource){var y=e.isCacheDataSourceSelected;i=r.createElement("div",{style:n.SUB_PANEL_STYLE},r.createElement(k.Tooltip,{content:"If unchecked, remote data will be accessed using an available protocol, e.g. OPeNDAP."},r.createElement(k.Checkbox,{checked:y,label:"Cache data source (allocates space on disk)",onChange:this.onMakeLocalSelectedChange})),r.createElement(k.Collapse,{isOpen:y},r.createElement("div",{style:n.OPTION_DIV_STYLE},r.createElement(k.Label,null,"Unique identifier for the new local data source",r.createElement("span",{className:"bp3-text-muted"}," (optional)"),r.createElement(k.InputGroup,{style:{width:"100%"},type:"text",value:e.cachedDataSourceId,onChange:this.onMakeLocalDataSourceIdChange})))))}var g,E=[];return"ok"===this.props.dataSource.metaInfoStatus?(this.props.canConstrainTime||E.push([En,"This dataset has no (recognised) temporal coverage."]),this.props.canConstrainRegion||E.push([En,r.createElement("span",null,"This dataset has no (recognised) spatial coverage and hence it will not show up in the ",r.createElement("strong",null,"World View"),".")]),this.props.canConstrainVariables||E.push([En,"This datasets has no (recognised) variables."])):"loading"===this.props.dataSource.metaInfoStatus?E.push([_n,"Please wait while dataset metadata is loaded..."]):"error"===this.props.dataSource.metaInfoStatus&&E.push([On,"Failed to load dataset metadata."]),E.length>0&&(g=r.createElement(k.Card,{style:gn},E.map((function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];return r.createElement("div",null,n,"\xa0\xa0",a)})))),r.createElement("div",null,r.createElement(cn,{label:this.props.isLocalDataSource?"Data source (local):":"Data source:",longId:this.props.dataSource.title}),u,h,v,i,g)}}],[{key:"dataSourceVarToVariable",value:function(e){return{name:e.name,units:e.units||"-",dataType:xe.d}}},{key:"dataSourceToResource",value:function(e){if(e){var t=e.metaInfo;if(t&&t.data_vars&&t.data_vars.length)return{name:e.id,dataType:xe.c,variables:t.data_vars.map((function(e){return n.dataSourceVarToVariable(e)}))}}return null}},{key:"validateOptions",value:function(e,t){if(!t)return!1;var n=!0;t.hasTimeConstraint&&t.dateRange&&(n=!t.dateRange.error);var a=!0;if(t.hasRegionConstraint&&t.region){var r=t.region.west.value,o=t.region.east.value,i=t.region.south.value,l=t.region.north.value,c=l>=-90&&l<=90,s=i>=-90&&i<=90;a=r>=-180&&r<=180&&(o>=-180&&o<=180)&&Math.abs(r-o)>=.009&&(s&&c&&l-i>=.009)}var u=!0;t.hasVariablesConstraint&&t.variableNames&&(u=!t.variableNames.error);var d=!0;if(!e&&t.isCacheDataSourceSelected){var p=t.cachedDataSourceId;p&&!/[^\\/:*?"<>|\r\n]+$/im.test(p)&&(d=!1)}return n&&a&&u&&d}},{key:"optionsToErrors",value:function(e){var t={};return e.hasTimeConstraint&&e.dateRange&&e.dateRange.error&&(t["Time constraint"]=e.dateRange.error),e.hasVariablesConstraint&&e.variableNames&&e.variableNames.error&&(t["Variables constraint"]=e.variableNames.error),t}},{key:"optionsToOperationArguments",value:function(e){var t={};if(e.hasTimeConstraint&&e.dateRange&&e.dateRange.value){var n=qt(e.dateRange.value[0]),r=qt(e.dateRange.value[1]);t={time_range:"".concat(n,",").concat(r)}}if(e.hasRegionConstraint&&e.region){var o=e.region;t=Object(a.a)(Object(a.a)({},t),{},{region:"".concat(o.west.value,",").concat(o.south.value,",").concat(o.east.value,",").concat(o.north.value)})}if(e.hasVariablesConstraint&&e.variableNames){var i=e.variableNames.value;t=Object(a.a)(Object(a.a)({},t),{},{var_names:i})}return e.isCacheDataSourceSelected&&(t=Object(a.a)(Object(a.a)({},t),{},{force_local:!0}),e.cachedDataSourceId&&(t=Object(a.a)(Object(a.a)({},t),{},{local_ds_id:e.cachedDataSourceId}))),t}},{key:"defaultOptions",value:function(e,t){var n=null,a=null;if(t&&t[0])try{n=new Date(t[0])}catch(r){}if(t&&t[1])try{a=new Date(t[1])}catch(r){}return{hasTimeConstraint:!1,dateRange:{value:[n,a]},hasRegionConstraint:!1,region:null,hasVariablesConstraint:!1,variableNames:null,isCacheDataSourceSelected:!e,cachedDataSourceId:"",openDatasetResourceName:""}}},{key:"ensureDateRangeIsValidated",value:function(e,t){if(e.hasTimeConstraint&&e.dateRange&&t)try{var n=t[0]?new Date(t[0]):new Date("1980-01-01"),r=t[1]?new Date(t[1]):new Date(Date.now());return on(e.dateRange.value,!0,n,r),Object(a.a)(Object(a.a)({},e),{},{dateRange:Object(a.a)(Object(a.a)({},e.dateRange),{},{error:null})})}catch(o){return Object(a.a)(Object(a.a)({},e),{},{dateRange:Object(a.a)(Object(a.a)({},e.dateRange),{},{error:o})})}return e}}]),n}(r.Component);kn.VAR_NAMES_INPUT={name:"varNames",dataType:"string",description:null,nullable:!0},kn.SUB_PANEL_STYLE={marginTop:"1em"},kn.OPTION_CHECK_STYLE={marginTop:"1em"},kn.OPTION_DIV_STYLE={marginLeft:"2em"};var wn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"render",value:function(){var e;e=this.isValueEditorShown()?this.props.valueEditor:this.renderResourceNameEditor();var t=this.renderEditorSwitch();return r.createElement(r.Fragment,{key:this.props.name},r.createElement(bn,{style:n.LABEL_STYLE,label:this.props.name,units:this.props.units,dataType:this.props.dataType,tooltipText:this.props.tooltipText}),e,t)}},{key:"handleChange",value:function(e,t){this.props.onChange&&this.props.onChange(e,t)}},{key:"renderResourceNameEditor",value:function(){var e=this,t=r.createElement("option",{key:"__first__",value:"__null__"},"Select resource"),a=(this.props.resources||[]).filter((function(t){return e.isDataTypeCompatible(t)})).map((function(e){return r.createElement("option",{key:e.name,value:e.name},e.name)})),o=[t].concat(a),i=r.createElement("div",{className:"bp3-intent-primary",style:n.RESOURCE_NAME_STYLE},r.createElement(k.HTMLSelect,{fill:!0,style:n.RESOURCE_NAME_STYLE,value:this.props.resourceName||"__null__",disabled:0===a.length,onChange:function(t){return e.handleChange("__null__"===t.target.value?null:t.target.value,!1)}},o));return 0===a.length&&(i=r.createElement(k.Popover,{interactionKind:k.PopoverInteractionKind.HOVER,hoverOpenDelay:0,hoverCloseDelay:0,position:k.PopoverPosition.TOP,fill:!0},i,r.createElement("div",{style:{padding:8}},"This parameter requires a resource of type ",r.createElement("span",{style:{color:"rgba(0,255,0,0.8)"}},Jt(this.props.dataType,!1)),".",r.createElement("br",null),"Currently, no resources of this type are available.",r.createElement("br",null),function(e){switch(e){case xe.c:return r.createElement("span",null,"Datasets can be opened from the ",r.createElement("b",null,"DATA SOURCES")," panel.",r.createElement("br",null),"You can also use operations like ",r.createElement("code",null,"open_dataset")," or ",r.createElement("br",null),r.createElement("code",null,"read_netcdf")," to produce resources of this type.");case xe.b:return r.createElement("span",null,"Datasets can be opened from the ",r.createElement("b",null,"DATA SOURCES")," panel.",r.createElement("br",null),"You can also use operations like ",r.createElement("code",null,"open_dataset"),", ",r.createElement("br",null),"or ",r.createElement("code",null,"read_netcdf")," to produce resources of this type.");case xe.f:return r.createElement("span",null,"You can use operations like ",r.createElement("code",null,"read_csv"),", ",r.createElement("code",null,"read_geo_data"),r.createElement("br",null),"to produce resources of this type.");case xe.e:return r.createElement("span",null,"You can use operations like ",r.createElement("code",null,"read_csv"),", ",r.createElement("code",null,"read_geo_data"),",",r.createElement("br",null),"or ",r.createElement("code",null,"open_dataset")," to produce resources of this type.");case xe.o:case xe.r:return""}return""}(this.props.dataType)))),i}},{key:"renderEditorSwitch",value:function(){var e=this,t=this.isValueEditorShown(),a=this.isValueEditorDisabled(),o=!this.hasCompatibleResources(),i=a||o;return r.createElement("span",null,r.createElement(k.Tooltip,{content:(t?"Switch to resource selection":"Switch to value entry")+(i?" (disabled)":"")},r.createElement(k.Switch,{checked:t,disabled:i,alignIndicator:k.Alignment.LEFT,style:n.EDITOR_SWITCH_STYLE,onChange:function(t){return e.handleChange(e.props.resourceName,t.target.checked)}})))}},{key:"isDataTypeCompatible",value:function(e){return Object(xe.x)(this.props.dataType,e.dataType)}},{key:"hasCompatibleResources",value:function(){var e=this;return(this.props.resources||[]).some((function(t){return e.isDataTypeCompatible(t)}))}},{key:"isValueEditorDisabled",value:function(){return!this.props.valueEditor}},{key:"isValueEditorShown",value:function(){return!(!this.props.isValueEditorShown||!this.props.valueEditor)}}]),n}(r.PureComponent);wn.LABEL_STYLE={justifySelf:"end",justifyContent:"end"},wn.EDITOR_SWITCH_STYLE={margin:0},wn.RESOURCE_NAME_STYLE={justifySelf:"stretch"};var Sn=n(112);function jn(e){return r.createElement(k.Checkbox,{className:"bp3-large",checked:e.value||!1,indeterminate:null===e.value,style:{marginTop:"0",marginBottom:"0"},onChange:function(t){return e.onChange(e.input,t.target.checked)}})}var In=n(70),Pn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"onChange",value:function(e){this.props.onChange(this.props.input,e===n.NULL_VALUE?null:e)}},{key:"render",value:function(){var e=this,t=this.props.input.valueSet;if(!(t&&t.length))return null;var a,o=t.map((function(e,t){return r.createElement("option",{key:t,value:e},e)}));this.props.input.nullable&&(o=(a=[r.createElement("option",{key:-1,value:n.NULL_VALUE})]).concat.apply(a,Object(In.a)(o)));var i=this.props.value||n.NULL_VALUE;return r.createElement("div",{className:"bp3-select"},r.createElement(k.HTMLSelect,{fill:!0,style:n.VALUE_SELECTOR_STYLE,value:i,onChange:function(t){return e.onChange(t.target.value)}},o))}}],[{key:"isValueSetGiven",value:function(e){return e.valueSet&&e.valueSet.length}}]),n}(r.PureComponent);function Dn(e){return Pn.isValueSetGiven(e.input)?r.createElement(Pn,{input:e.input,value:e.value,onChange:e.onChange}):r.createElement(sn,{isInt:!0,size:10,value:e.value,nullable:e.input.nullable,onChange:function(t){return e.onChange(e.input,t)}})}function Tn(e){return Pn.isValueSetGiven(e.input)?r.createElement(Pn,{input:e.input,value:e.value,onChange:e.onChange}):r.createElement(sn,{isInt:!1,size:10,value:e.value,nullable:e.input.nullable,onChange:function(t){return e.onChange(e.input,t)}})}function Ln(e){if(Pn.isValueSetGiven(e.input))return r.createElement(Pn,{input:e.input,value:e.value,onChange:e.onChange});var t=e.input.password?"password":"text";return r.createElement(hn.a,{size:24,value:e.value,nullable:e.input.nullable,onChange:function(t){return e.onChange(e.input,t)},type:t})}Pn.NULL_VALUE="__null__",Pn.VALUE_SELECTOR_STYLE={justifySelf:"stretch"};var An={display:"flex",justifySelf:"stretch"},Rn={flexGrow:1},Nn={flexGrow:0};var xn=Object(i.b)((function(e,t){return Object(a.a)(Object(a.a)({},t),{},{hostOS:e.communication.webAPIServiceInfo.hostOS,workspaceDir:e.data.workspace?e.data.workspace.baseDir:null})}))((function(e){var t=e.input,n=e.value,a=e.onChange,o=e.hostOS,i=e.workspaceDir,l=e.dispatch;n=n||"";var c,s=function(e){return null!==i?Object(Yt.g)(e,i,o):e},u=function(e){return null!==i?Object(Yt.f)(i,e,o):e};return c="w"===t.fileOpenMode?function(e,t,n){var a={defaultPath:u(Object(Qt.c)(t,void 0)),filters:e.fileFilters};l(p.hd(a,(function(t){var a=t.filePath;!t.canceled&&a&&(a=s(a),n(e,a))})))}:function(e,t,n){var a=e.fileProps,r=new Set(a);r.has("openFile")||r.has("openDirectory")||(r.add("openFile"),a=Array.from(r));var o={defaultPath:u(Object(Qt.c)(t,void 0)),filters:e.fileFilters,properties:a};l(p.gd(o,(function(t){var r=t.filePaths;!t.canceled&&r.length>0&&(r=r.map(s),a&&a.find((function(e){return"multiSelection"===e}))&&console.error("multi-file selection is not yet implemented, returning first entry only"),n(e,r[0]))})))},r.createElement(k.ControlGroup,{fill:!0,style:An},r.createElement(hn.a,{style:Rn,value:n,placeholder:"Enter file path",onChange:function(e){return a(t,e)},nullable:t.nullable}),r.createElement(k.Button,{intent:k.Intent.PRIMARY,style:Nn,onClick:function(){return c(t,n,a)}},"..."))})),Mn=r.createElement("a",{href:"https://en.wikipedia.org/wiki/Well-known_text",target:"_blank",rel:"noopener noreferrer"},"Well-Known Text (WKT)"),Vn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).renderBody=a.renderBody.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.onChange=a.onChange.bind(Object(E.a)(a)),a.state=a.toState(a.props.value),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState(this.toState(e.value))}},{key:"onConfirm",value:function(){this.props.onConfirm(this.state.value)}},{key:"onChange",value:function(e){this.setState(this.toState(e.target.value))}},{key:"canConfirm",value:function(){return!this.state.error}},{key:"toState",value:function(e){var t;try{Ue(e,this.props.geometryType)}catch(n){t=n}return{value:e,error:t}}},{key:"render",value:function(){return r.createElement(rt.a,{isOpen:this.props.isOpen,title:"Geometry Editor",onCancel:this.props.onCancel,onConfirm:this.onConfirm,canConfirm:this.canConfirm,renderBody:this.renderBody})}},{key:"renderBody",value:function(){if(!this.props.isOpen)return null;var e=this.state.value,t=!!this.state.error;return r.createElement(k.FormGroup,null,r.createElement(k.Label,{htmlFor:"wkt"},"Enter Geometry of type ".concat(this.props.geometryType),r.createElement("span",{className:"bp3-text-muted"}," (WGS84 coordinates in degree)")),r.createElement("div",{className:"bp3-form-content",style:{width:"100%"}},r.createElement("textarea",{id:"wkt",className:t?n.ERROR_CLASS:n.NOMINAL_CLASS,rows:10,dir:"auto",value:e,onChange:this.onChange}),this.getHelpText()))}},{key:"getHelpText",value:function(){var e,t;return this.state.error&&(e=r.createElement("p",null,"Error: ".concat(this.state.error.message))),t="Point"===this.props.geometryType?r.createElement("p",null,"Use ",r.createElement("code",null,"lon, lat")," or use ",this.props.geometryType," ",Mn," syntax."):"Polygon"===this.props.geometryType?r.createElement("p",null,"Use ",r.createElement("code",null,"west, south, east, north")," or use ",this.props.geometryType," ",Mn," syntax."):r.createElement("p",null,"Use ",this.props.geometryType," ",Mn," syntax."),r.createElement("div",{className:"bp3-form-helper-text"},e,t)}}]),n}(r.Component);Vn.NOMINAL_CLASS="bp3-input bp3-fill",Vn.ERROR_CLASS="bp3-input bp3-fill bp3-intent-danger";var Bn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).validateGeometryText=a.validateGeometryText.bind(Object(E.a)(a)),a.state={isEditorOpen:!1},a.setGeometryWKT=a.setGeometryWKT.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"validateGeometryText",value:function(e){Ue(e,this.props.geometryType)}},{key:"setGeometryWKT",value:function(){var e;try{e=this.props.geometryWKTGetter&&this.props.geometryWKTGetter()}catch(t){console.error(t),e="Error: "+t}this.props.onChange({textValue:e,value:e})}},{key:"render",value:function(){var e=this,t=this.props.placeholder;return t||(t="Point"===this.props.geometryType?"<lon>,<lat> or Point WKT":"Polygon"===this.props.geometryType?"<lon1>,<lat1>,<lon2>,<lat2> or Polygon WKT":"Enter ".concat(this.props.geometryType," WKT")),r.createElement(k.ControlGroup,{style:n.DIV_STYLE,fill:!0},r.createElement(hn.a,{value:this.props.value,onChange:this.props.onChange,placeholder:t,validator:this.validateGeometryText,nullable:this.props.nullable,style:n.TEXT_FIELD_STYLE}),r.createElement(k.AnchorButton,{icon:"selection",style:n.BUTTON_STYLE,disabled:!this.props.geometryWKTGetter,onClick:this.setGeometryWKT}),r.createElement(k.AnchorButton,{intent:k.Intent.PRIMARY,style:n.BUTTON_STYLE,onClick:function(){return e.setState({isEditorOpen:!0})}},"..."),r.createElement(Vn,{isOpen:this.state.isEditorOpen,value:Object(Qt.c)(this.props.value),onConfirm:function(t){e.setState({isEditorOpen:!1}),e.props.onChange({textValue:t,value:t})},onCancel:function(){e.setState({isEditorOpen:!1})},geometryType:this.props.geometryType}))}}]),n}(r.Component);Bn.DIV_STYLE={display:"flex",justifySelf:"stretch"},Bn.TEXT_FIELD_STYLE={flexGrow:1},Bn.BUTTON_STYLE={flexGrow:0};var Wn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onChange",value:function(e){this.props.onChange(this.props.input,e)}},{key:"render",value:function(){return r.createElement(Bn,{value:this.props.value,onChange:this.onChange,placeholder:this.props.placeholder,size:this.props.size,geometryType:this.props.geometryType,nullable:this.props.input.nullable,geometryWKTGetter:this.props.geometryWKTGetter})}}]),n}(r.Component),Un=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onChange",value:function(e){var t=e.textValue,n=e.error;this.props.onChange(this.props.input,{textValue:t,value:t,error:n})}},{key:"render",value:function(){var e=this.getValueMinMax();return r.createElement(rn,{nullable:this.props.input.nullable,min:e[0],max:e[1],value:this.props.value,onChange:this.onChange})}},{key:"getValueMinMax",value:function(){var e,t,n=this.props.input.valueRange;if(n)try{e=tn(n[0],!0),t=tn(n[1],!0)}catch(a){}return[e,t]}}]),n}(r.PureComponent),Fn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onSelection=a.onSelection.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.state={value:a.props.value},a}return Object(g.a)(n,[{key:"onSelection",value:function(e){this.setState({value:e})}},{key:"onConfirm",value:function(){this.props.onConfirm(this.state.value)}},{key:"render",value:function(){return r.createElement(rt.a,{isOpen:this.props.isOpen,title:this.props.multiSelect?"Select Dimensions":"Select Dimension",icon:"variable",onConfirm:this.onConfirm,onCancel:this.props.onCancel,renderBody:this.renderBody})}},{key:"renderBody",value:function(){if(!this.props.isOpen)return null;var e=this.props.dimNames;return e?r.createElement(jt,null,r.createElement("p",null,this.props.multiSelect?"Select one or more dimensions:":"Select dimension:"),r.createElement(Ut.a,{items:e,getItemKey:n.getDimItemKey,renderItem:n.renderDimItem,selectionMode:this.props.multiSelect?Ut.b.MULTIPLE:Ut.b.SINGLE,selection:this.state.value,style:{height:"20em"},onSelection:this.onSelection,onItemDoubleClick:this.state.value?this.onConfirm:null})):r.createElement("p",null,"No dimensions names found for the given source.")}}],[{key:"getDimItemKey",value:function(e){return e}},{key:"renderDimItem",value:function(e){return r.createElement("div",null,e)}}]),n}(r.Component),Gn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(E.a)(a)),a.validate=a.validate.bind(Object(E.a)(a)),a.state={isDetailsEditorOpen:!1},a}return Object(g.a)(n,[{key:"onChange",value:function(e){this.props.onChange(this.props.input,e)}},{key:"validate",value:function(e){!function(e,t,n,a){if(!e||""===e.trim()){if(!t)throw new Error(n?"One or more dimension names expected.":"Dimension name expected.");return}var r=e.split(",");if(n){var o,i=Object(W.a)(r);try{for(i.s();!(o=i.n()).done;){if(""===o.value.trim())throw new Error("Value must be a comma-separated list of dimension names.")}}catch(u){i.e(u)}finally{i.f()}}else{if(1!==r.length)throw new Error("Value must be a single dimension name.");if(""===r[0].trim())throw new Error("Value must be a dimension name.")}if(a){var l,c=Object(W.a)(r);try{for(c.s();!(l=c.n()).done;){var s=l.value;if(!new Set(a).has(s))throw new Error('"'.concat(s,'" is not a valid dimension. Valid dimensions are: "').concat(a,'"'))}}catch(u){c.e(u)}finally{c.f()}}}(e,this.props.input.nullable,this.props.multi,this.props.dimNames)}},{key:"render",value:function(){var e=this,t=Object(Qt.c)(this.props.value),a=""!==t?t.split(",").map((function(e){return e.trim()})):[],o=this.props.dimNames&&this.props.dimNames.length;return r.createElement(k.ControlGroup,{style:n.DIV_STYLE},r.createElement(hn.a,{value:this.props.value,validator:this.validate,size:this.props.multi?36:24,placeholder:this.props.multi?"Enter dimension names, separated by comma":"Enter dimension name",onChange:this.onChange,nullable:this.props.input.nullable,style:n.TEXT_FIELD_STYLE}),r.createElement(k.AnchorButton,{intent:k.Intent.PRIMARY,onClick:function(){return e.setState({isDetailsEditorOpen:!0})},disabled:!o,style:n.BUTTON_STYLE},"..."),r.createElement(Fn,{isOpen:this.state.isDetailsEditorOpen,dimNames:this.props.dimNames,multiSelect:this.props.multi,value:a,onConfirm:function(t){var n=t?t.join(", "):null;e.setState({isDetailsEditorOpen:!1}),e.onChange({textValue:n,value:n})},onCancel:function(){e.setState({isDetailsEditorOpen:!1})}}))}}]),n}(r.Component);Gn.DIV_STYLE={width:"24em",display:"flex",flexGrow:1},Gn.TEXT_FIELD_STYLE={flexGrow:1},Gn.BUTTON_STYLE={flex:"none"};var Yn=n(425),Hn=n(426),Kn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onChange",value:function(e){var t=e.textValue,n=e.error;this.props.onChange(this.props.input,{textValue:t,value:t,error:n})}},{key:"render",value:function(){var e=this.getValueMinMax();return r.createElement(en,{nullable:this.props.input.nullable,min:e[0],max:e[1],value:this.props.value,onChange:this.onChange})}},{key:"getValueMinMax",value:function(){var e,t,n=this.props.input.valueRange;if(n)try{e=tn(n[0],!0),t=tn(n[1],!0)}catch(a){e=$t[0],t=$t[1]}return[e,t]}}]),n}(r.PureComponent),zn=n(427),qn=n.n(zn),Jn=(n(657),n(658),[{href:"http://xarray.pydata.org/en/stable/api.html#top-level-functions",module:"xr",name:"xarray"},{href:"http://xarray.pydata.org/en/stable/api.html#universal-functions",module:"xu",name:"xarray u-funcs"},{href:"http://pandas.pydata.org/pandas-docs/stable/basics.html",module:"pd",name:"Pandas"},{href:"http://pandas.pydata.org/pandas-docs/stable/basics.html",module:"np",name:"numpy"}]),Xn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).renderBody=a.renderBody.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.onChange=a.onChange.bind(Object(E.a)(a)),a.state=a.toState(a.props.value),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState(this.toState(e.value))}},{key:"onConfirm",value:function(){this.props.onConfirm(this.state.value)}},{key:"onChange",value:function(e){this.setState(this.toState(e))}},{key:"canConfirm",value:function(){return!this.state.error}},{key:"toState",value:function(e){var t;return{value:e,error:t}}},{key:"render",value:function(){return r.createElement(rt.a,{isOpen:this.props.isOpen,title:"Script Editor",onCancel:this.props.onCancel,onConfirm:this.onConfirm,canConfirm:this.canConfirm,renderBody:this.renderBody,style:n.DIALOG_STYLE})}},{key:"renderBody",value:function(){if(!this.props.isOpen)return null;var e=this.state.value;return r.createElement(r.Fragment,null,r.createElement(qn.a,{mode:this.props.scriptLang,theme:"monokai",width:"100%",fontSize:14,showGutter:!0,highlightActiveLine:!0,value:e,onChange:this.onChange}),this.getHelpText())}},{key:"getHelpText",value:function(){var e=Jn.map((function(e,t){return r.createElement("span",null,r.createElement("code",null,e.module),"\xa0(",r.createElement("a",{href:e.href,rel:"noopener noreferrer",target:"_blank"},e.name),")",t<Jn.length-1?", ":"")}));return r.createElement("div",{className:"bp3-form-helper-text",style:{marginTop:"0.5em"}},"Please use Python 3.6+ syntax. The following modules are imported by default: ",e,". Other modules can be imported: ",r.createElement("code",null,"dask"),", ",r.createElement("code",null,"gdal"),", ",r.createElement("code",null,"geos")," ",r.createElement("code",null,"pyshp"),",",r.createElement("code",null,"scipy"),", ",r.createElement("code",null,"shapely"),".")}}]),n}(r.Component);Xn.DIALOG_STYLE={width:"54em"};var Zn=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).validateScript=a.validateScript.bind(Object(E.a)(a)),a.state={isEditorOpen:!1},a}return Object(g.a)(n,[{key:"validateScript",value:function(e){}},{key:"render",value:function(){var e=this,t=this.props.placeholder;return r.createElement(k.ControlGroup,{style:n.DIV_STYLE,fill:!0},r.createElement(hn.a,{value:this.props.value,onChange:this.props.onChange,size:this.props.size,placeholder:t,validator:this.validateScript,nullable:this.props.nullable,style:n.TEXT_FIELD_STYLE}),r.createElement(k.AnchorButton,{intent:k.Intent.PRIMARY,style:n.BUTTON_STYLE,onClick:function(){return e.setState({isEditorOpen:!0})}},"..."),r.createElement(Xn,{isOpen:this.state.isEditorOpen,value:Object(Qt.c)(this.props.value),onConfirm:function(t){e.setState({isEditorOpen:!1}),e.props.onChange({textValue:t,value:t})},onCancel:function(){e.setState({isEditorOpen:!1})},scriptLang:this.props.scriptLang}))}}]),n}(r.Component);Zn.DIV_STYLE={display:"flex"},Zn.TEXT_FIELD_STYLE={flexGrow:1},Zn.BUTTON_STYLE={flexGrow:0};var Qn,$n=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onChange",value:function(e){this.props.onChange(this.props.input,e)}},{key:"render",value:function(){return r.createElement(Zn,{value:this.props.value,onChange:this.onChange,placeholder:this.props.placeholder,size:this.props.size,scriptLang:this.props.input.scriptLang,nullable:this.props.input.nullable})}}]),n}(r.Component);function ea(e){var t=ta(e.input.dataType);return t?t(e):null}function ta(e){return e?aa[e]:null}function na(e){return r.createElement(xn,{input:e.input,value:e.value,onChange:e.onChange})}var aa=(Qn={},Object(B.a)(Qn,xe.a,(function(e){return r.createElement(jn,{input:e.input,value:e.value,onChange:e.onChange})})),Object(B.a)(Qn,xe.m,(function(e){return r.createElement(Dn,{input:e.input,value:e.value,onChange:e.onChange})})),Object(B.a)(Qn,xe.k,(function(e){return r.createElement(Tn,{input:e.input,value:e.value,onChange:e.onChange})})),Object(B.a)(Qn,xe.s,(function(e){return e.input.fileOpenMode?na(e):e.input.scriptLang?function(e){return r.createElement($n,{input:e.input,value:e.value,onChange:e.onChange})}(e):function(e){return r.createElement(Ln,{input:e.input,value:e.value,onChange:e.onChange})}(e)})),Object(B.a)(Qn,xe.p,(function(e){return r.createElement(Wn,{input:e.input,value:e.value,onChange:e.onChange,geometryType:"Point",size:16,geometryWKTGetter:e.geometryWKTGetter})})),Object(B.a)(Qn,xe.q,(function(e){return r.createElement(Wn,{input:e.input,value:e.value,onChange:e.onChange,geometryType:"Polygon",size:32,geometryWKTGetter:e.geometryWKTGetter})})),Object(B.a)(Qn,xe.l,(function(e){return r.createElement(Wn,{input:e.input,value:e.value,onChange:e.onChange,geometryType:"Geometry",size:32,geometryWKTGetter:e.geometryWKTGetter})})),Object(B.a)(Qn,xe.t,(function(e){return r.createElement(Kn,{input:e.input,value:e.value,onChange:e.onChange})})),Object(B.a)(Qn,xe.u,(function(e){return r.createElement(Un,{input:e.input,value:e.value,onChange:e.onChange})})),Object(B.a)(Qn,xe.w,(function(e){return r.createElement(yn,{input:e.input,value:e.value,onChange:e.onChange,resource:ra(e),multi:!1})})),Object(B.a)(Qn,xe.v,(function(e){return r.createElement(yn,{input:e.input,value:e.value,onChange:e.onChange,resource:ra(e),multi:!0})})),Object(B.a)(Qn,xe.i,(function(e){return r.createElement(Gn,{input:e.input,value:e.value,onChange:e.onChange,dimNames:oa(e),multi:!1})})),Object(B.a)(Qn,xe.h,(function(e){return r.createElement(Gn,{input:e.input,value:e.value,onChange:e.onChange,dimNames:oa(e),multi:!0})})),Object(B.a)(Qn,xe.g,(function(e){return r.createElement(Yn.a,{input:e.input,value:e.value,onChange:e.onChange})})),Object(B.a)(Qn,xe.j,na),Object(B.a)(Qn,xe.n,(function(e){return r.createElement(Hn.a,{input:e.input,value:e.value,onChange:e.onChange})})),Qn);function ra(e){var t,n=e.input.valueSetSource,a=e.resources,r=e.inputAssignments;if(n&&a&&r){var o=r[n],i=o.resourceName;o&&i&&!o.isValueUsed&&(t=a.find((function(e){return e.name===i})))}return t}function oa(e){var t,n,a,r=e.input.valueSetSource.split("."),o=e.resources,i=e.inputAssignments;if(r[0]&&o&&i){var l=i[r[0]],c=l.resourceName;l&&c&&!l.isValueUsed&&(t=o.find((function(e){return e.name===c})))}if(t){var s=t.variables;if(r[1]&&s&&i){var u=i[r[1]];if(u&&u.constantValue){var d=u.constantValue.textValue;n=s.find((function(e){return e.name===d}))}}}return r[0]&&r[1]&&n?a=n.dimNames:r[0]&&!r[1]&&t&&(a=t.coordVariables.map((function(e){return e.name}))),a}var ia=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onConstantValueChange=a.onConstantValueChange.bind(Object(E.a)(a)),a.onResourceNameChange=a.onResourceNameChange.bind(Object(E.a)(a)),a.onCancel=a.onCancel.bind(Object(E.a)(a)),a.onValidate=a.onValidate.bind(Object(E.a)(a)),a.onDefaults=a.onDefaults.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.hideValidationDialog=a.hideValidationDialog.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.renderExtraActions=a.renderExtraActions.bind(Object(E.a)(a)),a.state=n.mapPropsToState(e),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState(n.mapPropsToState(e))}},{key:"onConfirm",value:function(){var e,t="editOperationStepDialog"===this.props.id,n=!t,a=this.props.operation;n&&(e=Object(B.a)({},a.qualifiedName,this.state.inputAssignments)),this.props.dispatch(p.Ub(this.props.id,e)),this.props.dispatch(p.bd(a.qualifiedName,this.getInputArguments(),this.props.resName,t,'Executing operation "'.concat(a.name,'"')))}},{key:"canConfirm",value:function(){return!this.getInputErrors()}},{key:"onCancel",value:function(){this.props.dispatch(p.Ub(this.props.id))}},{key:"onValidate",value:function(){var e=this.getInputErrors();this.setState({isValidationDialogOpen:!0,inputErrors:e})}},{key:"hideValidationDialog",value:function(){this.setState({isValidationDialogOpen:!1})}},{key:"getInputArguments",value:function(){return function(e,t){var n={};return e.forEach((function(e){var a=t[e.name];if(a){var r;if(a.isValueUsed){var o=a.constantValue;r={value:Object(Qt.b)(o)?o.value:o}}else r={source:a.resourceName};n[e.name]=r}})),n}(this.props.operation.inputs,this.state.inputAssignments)}},{key:"getInputErrors",value:function(){return function(e,t){var n={},a=!1;return e.forEach((function(e){var r=t[e.name];if(r)if(r.isValueUsed){var o=r.constantValue,i=Object(Qt.b)(o)&&o.error;i?(n[e.name]=i,a=!0):Object(he.g)(o)&&!e.nullable&&(n[e.name]=new Error("Value must be given."),a=!0)}else{var l=r.resourceName;Object(he.g)(l)&&!e.nullable&&(n[e.name]=new Error("Resource must be specified."),a=!0)}else n[e.name]=new Error("Value must be specified."),a=!0})),a?n:null}(this.props.operation.inputs,this.state.inputAssignments)}},{key:"onDefaults",value:function(){var e=ca(this.props.operation.inputs,this.state.inputAssignments,!0);this.setState({inputAssignments:e})}},{key:"setInputAssignment",value:function(e,t){var n=Object(Sn.b)(this.state.inputAssignments,e.name,t);this.setState({inputAssignments:n})}},{key:"onResourceNameChange",value:function(e,t,n){""===t&&e.nullable&&(t=null),this.setInputAssignment(e,{resourceName:t,isValueUsed:n})}},{key:"onConstantValueChange",value:function(e,t){this.setInputAssignment(e,{constantValue:t,isValueUsed:!0})}},{key:"render",value:function(){if(!this.props.isOpen)return null;var e,t,a,o=this.props.operation;return"editOperationStepDialog"===this.props.id?(e="Edit Step",t="Edit Operation Step - ".concat(o.name),a="Edit operation step inputs and recompute output."):(e="Add Step",t="Add Operation Step - ".concat(o.name),a="Add a new operation step to the workspace\u2019s workflow."),r.createElement(rt.a,{isOpen:!0,icon:"function",title:t,confirmTooltip:a,confirmTitle:e,confirmIconName:"play",onConfirm:this.onConfirm,onCancel:this.onCancel,canConfirm:this.canConfirm,renderBody:this.renderBody,renderExtraActions:this.renderExtraActions,style:n.DIALOG_STYLE})}},{key:"renderBody",value:function(){if(!this.props.isOpen)return null;var e=this.props.operation,t=r.createElement("p",{key:"header",style:{marginBottom:"1em"}},"Adjustable parameter(s) for operation ",r.createElement("code",null,e.name),":"),n=r.createElement("p",{key:"footer",style:{marginTop:"1em"}},"Pressing ",r.createElement(k.Icon,{icon:"play"})," will add operation ",r.createElement("code",null,e.name)," as a new workflow step to the current workspace. The result of the step is a new ",r.createElement("em",null,"resource")," which can be used as input for other operations. You can remove the step or change its parameters later."),a=this.renderParameterPanel();return r.createElement(k.FormGroup,null,t,r.createElement("div",null,a,r.createElement("div",{className:"bp3-form-helper-text"},n)),r.createElement(sa,{isOpen:this.state.isValidationDialogOpen,inputErrors:this.state.inputErrors,onConfirm:this.hideValidationDialog}))}},{key:"renderExtraActions",value:function(){return this.props.isOpen?[r.createElement(k.Tooltip,{key:"validate",content:"Validate current input values"},r.createElement(k.AnchorButton,{onClick:this.onValidate},"Validate")),r.createElement(k.Tooltip,{key:"defaults",content:"Set all inputs back to default values"},r.createElement(k.AnchorButton,{onClick:this.onDefaults},"Defaults"))]:null}},{key:"renderParameterPanel",value:function(){var e=this.props.operation;if(!e.inputs||!e.inputs.length)return null;var t,a,o,i,l,c,s=(t=e.inputs,a=this.state.inputAssignments,o=this.props.workspace.resources,i=this.props.geometryWKTGetter,l=this.onConstantValueChange,c=this.onResourceNameChange,t.filter((function(e){return!e.noUI})).map((function(e){var t=a[e.name],n=t.constantValue,s=ea({input:e,inputAssignments:a,resources:o,geometryWKTGetter:i,value:n,onChange:l});return r.createElement(wn,{key:e.name,resources:o,name:e.name,dataType:e.dataType,units:e.units,tooltipText:e.description,onChange:function(t,n){return c(e,t,n)},isValueEditorShown:t.isValueUsed,resourceName:t.resourceName,valueEditor:s})})));return r.createElement("div",{key:"parameterPanel",style:n.PARAMETER_PANEL_STYLE},s)}}],[{key:"mapPropsToState",value:function(e){return e.isOpen?{inputAssignments:ca(e.operation.inputs,e.inputAssignments,!1)}:n.NO_STATE}}]),n}(r.Component);ia.DIALOG_STYLE={width:"42em"},ia.NO_STATE={inputAssignments:{}},ia.PARAMETER_PANEL_STYLE={display:"grid",gridTemplateColumns:"auto auto 28px",alignItems:"center",justifyItems:"stretch",rowGap:"1ex",columnGap:"0.5em"};var la=Object(i.b)((function(e,t){var n=t.id,a=F.x(n)(e),r=a.isOpen;if(!r)return{id:n,isOpen:!1};var o,i,l=null;if("newOperationStepDialog"===n){if(!(o=F.wb(e)))return console.error("OperationStepDialog: operation is undefined: dialog id =",n),{id:n,isOpen:!1};var c=a.inputAssignments;i=c&&c[o.qualifiedName]}else if("newCtxOperationStepDialog"===n){if(!(o=F.fb(e)))return console.error("OperationStepDialog: operation is undefined: dialog id =",n),{id:n,isOpen:!1};i=a.inputAssignments}else{if("editOperationStepDialog"!==n)return console.error("OperationStepDialog: unknown dialog id =",n),{id:n,isOpen:!1};var s=t.operationStep;if(!(o=(F.T(e)||[]).find((function(e){return e.name===s.op||e.qualifiedName===s.op}))))return console.error("OperationStepDialog: operation is undefined: dialog id =",n),{id:n,isOpen:!1};i=function(e,t){var n,a={},r=Object(W.a)(e.inputs);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=t.inputs[o.name];if(i){var l=Object(he.e)(i)?i:i.source;if(l)a[o.name]={resourceName:l,isValueUsed:!1};else if(!Object(he.f)(i.value)){var c=i.value;a[o.name]={constantValue:c,isValueUsed:!0}}}}}catch(s){r.e(s)}finally{r.f()}return a}(o,s),l=s.id}return{id:n,isOpen:r,workspace:F.nc(e),geometryWKTGetter:F.nb(e),resName:l,operation:o,inputAssignments:i}}))(ia);function ca(e,t,n){var a={};return e.forEach((function(e){var r,o=!!ta(e.dataType),i={constantValue:Object(he.b)(e.defaultValue)?e.defaultValue:null,isValueUsed:o,resourceName:null},l=t&&t[e.name];r=!l||n?i:l||i,a[e.name]=r})),a}var sa=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onConfirm",value:function(){this.props.onConfirm()}},{key:"countResourceProblems",value:function(){var e=this.props.inputErrors,t=0;return Object.getOwnPropertyNames(e).forEach((function(n){var a=e[n];a.message&&(a.message.includes("resource")||a.message.includes("Resource"))&&t++})),t}},{key:"render",value:function(){return r.createElement(rt.a,{isOpen:this.props.isOpen,title:"Input Validation",onConfirm:this.onConfirm,noCancelButton:!0,onCancel:this.onConfirm,renderBody:this.renderBody})}},{key:"renderBody",value:function(){if(!this.props.isOpen)return null;var e=this.props.inputErrors;if(!e)return r.createElement("p",null,"No problems encountered.");var t=ua(e,this.countResourceProblems());return t||r.createElement("p",null,"No problems encountered.")}}]),n}(r.Component);function ua(e,t){var n,a=[];if(Object.getOwnPropertyNames(e).forEach((function(t){var n=e[t];a.push(r.createElement("li",{key:t},t,": ",n.message))})),0===a.length)return null;n=1===a.length?"The following problem has been encountered:":"The following ".concat(a.length," problems have been encountered:");var o=t&&t>0?r.createElement("p",null,"This operation has parameter(s) which require specifying a ",r.createElement("em",null,"resource"),". When there are no compatible resources yet, you may consider opening a data source or use one of the ",r.createElement("code",null,"read_...")," operations first."):null;return r.createElement(k.FormGroup,null,n,r.createElement("div",{className:"bp3-form-content"},a,r.createElement("div",{className:"bp3-form-helper-text"},o)))}var da=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onCancel=a.onCancel.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.onOptionsChange=a.onOptionsChange.bind(Object(E.a)(a)),a.state=n.mapPropsToState(e),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState(n.mapPropsToState(e))}},{key:"onCancel",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID))}},{key:"canConfirm",value:function(){return kn.validateOptions(this.isLocalDataStore,this.state.options)}},{key:"onConfirm",value:function(){var e=this.props.canCache&&this.state.options.isCacheDataSourceSelected,t=Object(a.a)(Object(a.a)({},this.state.options),{},{isCacheDataSourceSelected:e}),r=this.isRemoteDataStore?"":void 0,o={options:Object(a.a)(Object(a.a)({},t),{},{makeLocalDataSourceId:r,makeLocalDataSourceTitle:r,hasVariablesConstraint:!1,variableNames:null})};this.props.dispatch(p.Tb(n.DIALOG_ID,o)),this.props.dispatch(p.mc(this.props.dataStore.id,this.props.dataSource.id,kn.optionsToOperationArguments(this.state.options),this.isRemoteDataStore&&e)),this.setState(o)}},{key:"onOptionsChange",value:function(e){this.setState({options:e})}},{key:"render",value:function(){var e=this.props.isOpen;if(!e)return null;var t=this.isRemoteDataStore&&this.state.options.isCacheDataSourceSelected,n=ua(kn.optionsToErrors(this.state.options));return r.createElement(rt.a,{isOpen:e,title:"Open Dataset",icon:"database",confirmTitle:t?"Cache and Open":"Open",confirmIconName:"folder-shared-open",confirmTooltip:n,onCancel:this.onCancel,onConfirm:this.onConfirm,canConfirm:this.canConfirm,renderBody:this.renderBody})}},{key:"renderBody",value:function(){return this.props.isOpen?r.createElement(kn,{options:this.state.options,onChange:this.onOptionsChange,dataSource:this.props.dataSource,isLocalDataSource:this.isLocalDataStore,temporalCoverage:this.props.temporalCoverage,canConstrainTime:this.props.canConstrainTime,canConstrainRegion:this.props.canConstrainRegion,canConstrainVariables:this.props.canConstrainVariables,canCache:this.props.canCache}):null}},{key:"isRemoteDataStore",get:function(){return Object(Ae.X)(this.props.dataStore)}},{key:"isLocalDataStore",get:function(){return Object(Ae.W)(this.props.dataStore)}}],[{key:"mapPropsToState",value:function(e){var t=e.options||kn.defaultOptions(Object(Ae.W)(e.dataStore),e.temporalCoverage),n=e.canCache&&t.isCacheDataSourceSelected;return t=kn.ensureDateRangeIsValidated(t,e.temporalCoverage),{options:t=Object(a.a)(Object(a.a)({},t),{},{isCacheDataSourceSelected:n})}}}]),n}(r.Component);da.DIALOG_ID="openDatasetDialog";var pa=Object(i.b)((function(e){var t=F.x(da.DIALOG_ID)(e);return{isOpen:t.isOpen,dataStore:F.lb(e),dataSource:F.hb(e),temporalCoverage:F.ib(e),canConstrainTime:F.o(e),canConstrainRegion:F.n(e),canConstrainVariables:F.p(e),canCache:F.m(e),options:t.options}}))(da);var ha=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).state={removeFiles:!1},a.onCancel=a.onCancel.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.onRemoveFilesChange=a.onRemoveFilesChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({removeFiles:!1})}},{key:"onCancel",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID))}},{key:"onConfirm",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID,this.state)),this.props.dispatch(p.qc(this.props.dataSource.id,this.state.removeFiles))}},{key:"onRemoveFilesChange",value:function(e){this.setState({removeFiles:e.target.checked})}},{key:"render",value:function(){var e=this.props.isOpen;return e&&this.props.dataSource?r.createElement(rt.a,{isOpen:e,title:"Remove Data Source",icon:"trash",confirmTitle:"Remove",confirmIconName:"delete",confirmTooltip:"Remove the file data source.",onCancel:this.onCancel,onConfirm:this.onConfirm,renderBody:this.renderBody}):null}},{key:"renderBody",value:function(){return this.props.isOpen?r.createElement("div",null,r.createElement(cn,{label:"You are about to remove the definition for the file data source",longId:this.props.dataSource.id}),r.createElement(k.Checkbox,{style:{marginTop:"1em"},checked:this.state.removeFiles,label:"Remove data files from disk too",onChange:this.onRemoveFilesChange})):null}}]),n}(r.Component);ha.DIALOG_ID="removeDatasetDialog";var fa=Object(i.b)((function(e){return{isOpen:F.x(ha.DIALOG_ID)(e).isOpen,dataSource:F.hb(e)}}))(ha),ma={default:k.Intent.NONE,primary:k.Intent.PRIMARY,success:k.Intent.SUCCESS,warning:k.Intent.WARNING,danger:k.Intent.DANGER};var ba={setSelectedDataStoreId:p.Lc,setSelectedDataSourceId:p.Kc,setDataSourceFilterExpr:p.Bc,setSessionState:p.Wc,setControlState:p.Ac,updateSessionState:p.Bd,showDialog:p.dd,hideDialog:p.Tb},va=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleAddDatasetDialog=a.handleAddDatasetDialog.bind(Object(E.a)(a)),a.handleRemoveDatasetDialog=a.handleRemoveDatasetDialog.bind(Object(E.a)(a)),a.handleShowOpenDatasetDialog=a.handleShowOpenDatasetDialog.bind(Object(E.a)(a)),a.handleListHeightChanged=a.handleListHeightChanged.bind(Object(E.a)(a)),a.handleShowDetailsChanged=a.handleShowDetailsChanged.bind(Object(E.a)(a)),a.handleDataStoreSelected=a.handleDataStoreSelected.bind(Object(E.a)(a)),a.handleShowDataStoreDescriptionChanged=a.handleShowDataStoreDescriptionChanged.bind(Object(E.a)(a)),a.handleShowDataStoreNoticesChanged=a.handleShowDataStoreNoticesChanged.bind(Object(E.a)(a)),a.handleShowAllDataSourcesChanged=a.handleShowAllDataSourcesChanged.bind(Object(E.a)(a)),a.handleShowDataSourceIDsChanged=a.handleShowDataSourceIDsChanged.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"render",value:function(){if(!(this.props.dataStores&&this.props.dataStores.length))return this.renderNoDataStoreMessage();var e=this.props.selectedDataSources&&this.props.selectedDataSources.length,t=this.props.selectedDataSource,a=Object(Ae.W)(this.props.selectedDataStore),o=a,i=t&&a,l=!!t&&!Object(Ae.o)(t),c=t&&this.props.hasWorkspace&&!l,s=r.createElement(k.ButtonGroup,null,a&&r.createElement(Qe,{tooltipContent:"Add data source",onClick:this.handleAddDatasetDialog,disabled:!o,icon:"add",tooltipPosition:"top"}),a&&r.createElement(Qe,{tooltipContent:"Remove data source",onClick:this.handleRemoveDatasetDialog,disabled:!i,icon:"trash",tooltipPosition:"top"}),l&&r.createElement(k.Popover,{popoverClassName:k.Classes.POPOVER_CONTENT_SIZING,enforceFocus:!1,interactionKind:k.PopoverInteractionKind.HOVER,position:k.Position.TOP},r.createElement(Qe,{icon:"warning-sign",intent:k.Intent.WARNING}),r.createElement(Gt,{isSandboxedMode:this.props.isSandboxedMode,dataSource:t})),r.createElement(Qe,{tooltipContent:"Open data source",intent:k.Intent.PRIMARY,onClick:this.handleShowOpenDatasetDialog,disabled:!c,icon:"folder-shared-open",tooltipPosition:"top"}),r.createElement(Kt,null),r.createElement(fa,null),r.createElement(pa,null));return r.createElement("div",null,this.renderDataStoreSelector(),r.createElement("div",{style:n.FLEX_ROW_STYLE},r.createElement("span",{style:n.SPACER_STYLE}),r.createElement(k.Tooltip,{content:r.createElement("div",null,"List also datasets that cannot be opened directly.",r.createElement("br",null),"Usually they can be downloaded manually, then",r.createElement("br",null),"opened by one of the ",r.createElement("code",null,"read_xxx()")," operations.")},r.createElement(k.Checkbox,{label:"All data sources",checked:this.props.showAllDataSources,onChange:this.handleShowAllDataSourcesChanged,style:{marginBottom:2,marginTop:6,marginRight:6}})),r.createElement(k.Checkbox,{label:"Show identifiers",checked:this.props.showDataSourceIDs,onChange:this.handleShowDataSourceIDsChanged,style:{marginBottom:2,marginTop:6}})),this.renderDataSourceFilterExprInput(),r.createElement(mt,{showDetails:this.props.showDataSourceDetails,onShowDetailsChange:this.handleShowDetailsChanged,isSplitPanel:!0,contentHeight:this.props.dataSourceListHeight,onContentHeightChange:this.handleListHeightChanged,actionComponent:s},e?r.createElement(Ft,{dataSources:this.props.filteredDataSources,selectedDataSourceId:this.props.selectedDataSource?this.props.selectedDataSource.id:null,setSelectedDataSourceId:this.props.setSelectedDataSourceId,showDataSourceIDs:this.props.showDataSourceIDs,doubleClickAction:c?this.handleShowOpenDatasetDialog:void 0}):this.renderNoDataSourcesMessage(),r.createElement(Pt,{dataSource:this.props.selectedDataSource})))}},{key:"handleAddDatasetDialog",value:function(){this.props.showDialog("addDatasetDialog")}},{key:"handleRemoveDatasetDialog",value:function(){this.props.showDialog("removeDatasetDialog")}},{key:"handleShowOpenDatasetDialog",value:function(){this.props.showDialog("openDatasetDialog")}},{key:"handleDataStoreSelected",value:function(e){var t=e.target.value;this.props.setSelectedDataStoreId(t)}},{key:"handleListHeightChanged",value:function(e){this.props.setSessionState("dataSourceListHeight",e)}},{key:"handleShowDetailsChanged",value:function(e){this.props.setSessionState("showDataSourceDetails",e)}},{key:"handleShowDataStoreDescriptionChanged",value:function(){this.props.updateSessionState({showDataStoreDescription:!this.props.showDataStoreDescription})}},{key:"handleShowDataStoreNoticesChanged",value:function(){this.props.updateSessionState({showDataStoreNotices:!this.props.showDataStoreNotices})}},{key:"handleShowAllDataSourcesChanged",value:function(e){this.props.updateSessionState({showAllDataSources:e.target.checked})}},{key:"handleShowDataSourceIDsChanged",value:function(e){this.props.updateSessionState({showDataSourceIDs:e.target.checked})}},{key:"renderDataSourceFilterExprInput",value:function(){var e=this,t=r.createElement(k.Tag,{className:k.Classes.MINIMAL,onRemove:function(){return e.props.setDataSourceFilterExpr("")}},this.props.filteredDataSources&&this.props.filteredDataSources.length);return r.createElement("div",{style:{paddingBottom:2}},r.createElement(k.InputGroup,{disabled:!1,leftIcon:"filter",onChange:function(t){return e.props.setDataSourceFilterExpr(t.target.value)},placeholder:"Find data source",rightElement:t,value:this.props.dataSourceFilterExpr}))}},{key:"renderDataStoreSelector",value:function(){if(!this.props.dataStores||!this.props.dataStores.length)return null;var e,t=[],a=Object(W.a)(this.props.dataStores);try{for(a.s();!(e=a.n()).done;){var o=e.value;t.push(r.createElement("option",{key:o.id,value:o.id},o.title||o.id))}}catch(h){a.e(h)}finally{a.f()}var i,l=this.props,c=l.selectedDataStore,s=l.showDataStoreDescription,u=c&&c.description,d=c&&c.notices&&c.notices.length;if(u&&(i=r.createElement(k.Collapse,{isOpen:s},r.createElement(k.Card,null,r.createElement(wt,{source:c.description})))),d){var p=[];c.notices.forEach((function(e){p.push(r.createElement("div",{key:e.id,style:{margin:"0 4px 4px 4px"}},r.createElement(k.Callout,{title:e.title,icon:e.icon,intent:e.intent in ma?ma[e.intent]:k.Intent.NONE},r.createElement(wt,{source:e.content}))))}))}return r.createElement(r.Fragment,null,r.createElement("div",{style:n.FLEX_ROW_STYLE},r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_STYLE},r.createElement("span",{style:n.LABEL_TEXT_STYLE},"Data store:"),r.createElement(k.HTMLSelect,{fill:!0,style:n.SELECT_STYLE,value:c?c.id:"",onChange:this.handleDataStoreSelected},t)),r.createElement(k.ButtonGroup,null,r.createElement(Qe,{tooltipContent:"Show/hide data store description",onClick:this.handleShowDataStoreDescriptionChanged,disabled:!u,active:s,icon:"help",tooltipPosition:"top"}))),i)}},{key:"renderNoDataStoreMessage",value:function(){return z}},{key:"renderNoDataSourcesMessage",value:function(){var e=this.props.selectedDataStore;return Object(Ae.W)(e)?q:null===this.props.selectedDataSources?J:X}}]),n}(r.Component);va.FLEX_ROW_STYLE={display:"flex",alignItems:"center",marginBottom:1},va.SPACER_STYLE={flex:1},va.LABEL_STYLE={margin:"0 0.5em 0 0",display:"flex",flexGrow:1},va.LABEL_TEXT_STYLE={minWidth:"5em",overflow:"hidden",whiteSpace:"nowrap"},va.SELECT_STYLE={flexGrow:1};var ya=Object(i.b)((function(e){return{hasWorkspace:!!F.nc(e),dataStores:F.u(e),dataSourceFilterExpr:F.s(e),selectedDataStore:F.lb(e),selectedDataSource:F.hb(e),selectedDataSources:F.jb(e),filteredDataSources:F.C(e),dataSourceListHeight:F.t(e),showDataSourceDetails:F.Sb(e),showAllDataSources:F.Rb(e),showDataSourceIDs:F.Tb(e),showDataStoreDescription:F.Ub(e),showDataStoreNotices:F.Vb(e),offlineMode:F.P(e),isSandboxedMode:!F.I(e)}}),ba)(va);var ga={margin:6,padding:10},Ea=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleOperationSelection=a.handleOperationSelection.bind(Object(E.a)(a)),a.handleOperationFilterExprCleared=a.handleOperationFilterExprCleared.bind(Object(E.a)(a)),a.handleOperationFilterExprChange=a.handleOperationFilterExprChange.bind(Object(E.a)(a)),a.handleListHeightChanged=a.handleListHeightChanged.bind(Object(E.a)(a)),a.handleShowDetailsChanged=a.handleShowDetailsChanged.bind(Object(E.a)(a)),a.handleAddOperationStepButtonClicked=a.handleAddOperationStepButtonClicked.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"render",value:function(){var e,t=this.props.operations;if(t&&t.length){var n=this.props.operationFilterExpr,a=this.renderOperationTagFilterPanel(),o=this.renderOperationsList(),i=this.renderOperationDetailsCard(),l=r.createElement(k.Tag,{className:k.Classes.MINIMAL,onRemove:this.handleOperationFilterExprCleared},this.props.filteredOperations.length),c=r.createElement(k.InputGroup,{disabled:!1,leftIcon:"filter",onChange:this.handleOperationFilterExprChange,placeholder:"Find operation",rightElement:l,value:n}),s=this.props.selectedOperation&&this.props.workspace,u=r.createElement(k.ButtonGroup,null,r.createElement(Qe,{tooltipContent:r.createElement("span",null,"Add a new operation step to",r.createElement("br",null),"the workspace's workflow"),intent:k.Intent.PRIMARY,onClick:this.handleAddOperationStepButtonClicked,disabled:!s,text:"Add Step...",icon:"play",tooltipPosition:"top"}),s?r.createElement(la,{id:"newOperationStepDialog"}):null);e=r.createElement("div",null,c,a,r.createElement(mt,{showDetails:this.props.showOperationDetails,onShowDetailsChange:this.handleShowDetailsChanged,isSplitPanel:!0,contentHeight:this.props.operationListHeight,onContentHeightChange:this.handleListHeightChanged,actionComponent:u},o,i))}else e=this.renderNoOperationsMessage();return e}},{key:"handleListHeightChanged",value:function(e){this.props.dispatch(p.Wc("operationListHeight",e))}},{key:"handleShowDetailsChanged",value:function(e){this.props.dispatch(p.Wc("showOperationDetails",e))}},{key:"handleOperationSelection",value:function(e){e.length>0?this.props.dispatch(p.Pc(e[0])):this.props.dispatch(p.Pc(null))}},{key:"handleOperationFilterExprCleared",value:function(){this.props.dispatch(p.Hc(""))}},{key:"handleOperationFilterExprChange",value:function(e){this.props.dispatch(p.Hc(e.target.value))}},{key:"handleAddOperationStepButtonClicked",value:function(){this.props.dispatch(p.ld("newOperationStepDialog"))}},{key:"renderOperationsList",value:function(){return r.createElement(jt,null,r.createElement(Ut.a,{items:this.props.filteredOperations,getItemKey:n.getItemKey,renderItem:n.renderItem,selectionMode:Ut.b.SINGLE,selection:this.props.selectedOperationName,onSelection:this.handleOperationSelection,onItemDoubleClick:this.handleAddOperationStepButtonClicked}))}},{key:"renderOperationTagFilterPanel",value:function(){var e=this,t=new Set(this.props.operationFilterTags),n=this.props.operationsTagCounts,a={marginRight:"0.2em",marginTop:"0",marginBottom:"0",paddingTop:"0",paddingBottom:"0",height:"4ex"},o=[];t.forEach((function(t){o.push(r.createElement(k.Tag,{intent:k.Intent.PRIMARY,minimal:!0,style:a,onRemove:function(){return e.removeTagName(t)}},"".concat(t)))}));var i=[];n.forEach((function(n,a){t.has(a)||i.push(r.createElement(k.MenuItem,{key:a,text:"".concat(a," (").concat(n,")"),onClick:function(){return e.addTagName(a)}}))}));var l=null;if(i.length){var c=r.createElement(k.Menu,null,i);l=r.createElement(k.Popover,{content:c,interactionKind:k.PopoverInteractionKind.CLICK},r.createElement(k.Tag,{intent:k.Intent.SUCCESS,minimal:!0,icon:"small-plus",style:a}))}return r.createElement("div",{style:{padding:"0.2em",display:"flex",alignItems:"center"}},l,o)}},{key:"addTagName",value:function(e){var t=new Set(this.props.operationFilterTags);t.add(e),this.props.dispatch(p.Ic(Array.from(t)))}},{key:"removeTagName",value:function(e){var t=new Set(this.props.operationFilterTags);t.delete(e),this.props.dispatch(p.Ic(Array.from(t)))}},{key:"renderOperationDetailsCard",value:function(){var e=this.props.selectedOperation,t="No selection",a=null,o=null,i=null,l=null;if(e){if(t=e.name,e.description&&(a=r.createElement("p",{className:"user-selectable"},r.createElement(wt,{source:e.description}))),e.tags&&(o=r.createElement("p",null,r.createElement("strong",null,"Tags:")," ",e.tags.join(", "))),e.outputs&&e.outputs.length){var c=e.outputs.map((function(e){return r.createElement("li",{key:e.name},r.createElement(bn,{label:e.name,em:!0,dataType:e.dataType,units:e.units}),r.createElement(wt,{source:n.getOutputDescriptionText(e)}))}));l=r.createElement("div",null,r.createElement("p",null,r.createElement("strong",null,n.getMultiplicityText(e.outputs.length,"Output")+":")),r.createElement("ul",null,c))}if(e.inputs&&e.inputs.length){var s=e.inputs.map((function(e){return r.createElement("li",{key:e.name},r.createElement(bn,{label:e.name,em:!0,dataType:e.dataType,units:e.units}),r.createElement(wt,{source:n.getInputDescriptionText(e)}))}));i=r.createElement("div",null,r.createElement("p",null,r.createElement("strong",null,n.getMultiplicityText(e.outputs.length,"Input")+":")),r.createElement("ul",null,s))}}return r.createElement(jt,null,r.createElement(k.Card,{elevation:2,style:ga},r.createElement("h3",{className:"user-selectable"},t),a,o,l,i))}},{key:"renderNoOperationsMessage",value:function(){return Z}}],[{key:"getItemKey",value:function(e){return e.name}},{key:"renderItem",value:function(e){var t,n=e.name;return t=e.outputs.length?1===e.outputs.length?e.outputs[0].dataType:"".concat(e.outputs.length," types"):"",r.createElement(bn,{label:n,dataType:t})}},{key:"formatPortDescriptionText",value:function(e){return e&&""!==e?((e=e.trim()).endsWith(".")||(e+=".")," - "+e):e}},{key:"getInputDescriptionText",value:function(e){var t=n.formatPortDescriptionText(e.description);return"undefined"===typeof e.defaultValue?t+=" Mandatory value.":t+=' Default value is "'.concat(e.defaultValue,'".'),t}},{key:"getOutputDescriptionText",value:function(e){return n.formatPortDescriptionText(e.description)}},{key:"getMultiplicityText",value:function(e,t,n){return 1===e?t:n||t+"s"}}]),n}(r.Component),Oa=Object(i.b)((function(e){return{workspace:e.data.workspace,operations:F.T(e),selectedOperation:F.wb(e),filteredOperations:F.D(e),selectedOperationName:F.vb(e),operationFilterTags:F.S(e)||F.a,operationFilterExpr:F.R(e),operationsTagCounts:F.U(e),operationListHeight:e.session.operationListHeight,showOperationDetails:e.session.showOperationDetails}}))(Ea),_a={marginTop:"0.75em",display:"flex",flexDirection:"column",alignItems:"flex-end"},Ca={overflow:"auto"},ka=function(e){var t=e.details,n=e.onCopyDetails,o=e.width,i=e.height,l=r.useState(!1),c=Object(m.a)(l,2),s=c[0],u=c[1];return r.createElement("div",{style:_a},r.createElement("div",null,n&&r.createElement(k.Button,{onClick:function(){return n(t)},icon:"clipboard",small:!0,style:{marginRight:6}}),r.createElement(k.Button,{onClick:function(){return u(!s)},rightIcon:s?"chevron-up":"chevron-down",small:!0},s?"Hide Details":"Show Details")),r.createElement(k.Collapse,{isOpen:s},r.createElement("pre",{className:"user-selectable",style:Object(a.a)(Object(a.a)({},Ca),{},{width:o||"32em",height:i||"20em"})},t)))},wa=n(63),Sa=n(170);var ja=Object(i.b)((function(e){var t;return{webAPIStatus:e.communication.webAPIStatus,webAPIServiceInfo:e.communication.webAPIServiceInfo,username:(null===(t=e.communication.userProfile)||void 0===t?void 0:t.username)||null}}))((function(e){var t=e.webAPIStatus,n=e.webAPIServiceInfo,a=e.username,o=Object(f.g)(),i=function(){window.location.reload()},l=function(){o.replace("/")};switch(t){case"open":return null;case"login":return r.createElement(Da,{message:"Logging in...",icon:"log-in",isWaiting:!0});case"launching":return r.createElement(Da,{message:"Launching Cate service...",icon:"log-in",isWaiting:!0});case"connecting":return r.createElement(Da,{message:"Connecting to Cate service...",icon:"log-in",isWaiting:!0});case"shuttingDown":return r.createElement(Da,{message:"Shutting down Cate service...",icon:"log-out",isWaiting:!0});case"loggingOut":return r.createElement(Da,{message:"Logging out...",icon:"log-out",isWaiting:!0});case"closed":var c,s=n.autoStopInfo;return s&&s.inactivityTime>=s.availableTime-5?(c='Cate service has been shut down due to inactivity. Press "Retry" to try reconnecting.',r.createElement(Da,{message:c,icon:"offline",isWaiting:!1,onRetry:i,onCancel:l})):(c="The connection to the Cate service has been closed unexpectedly.",r.createElement(Ta,{message:c,icon:"offline",onRetry:i,onCancel:l,username:a}));case"error":return r.createElement(Ta,{message:"Oops! An error occurred while launching or connecting the Cate service.",icon:"offline",onRetry:i,onCancel:l,username:a});default:return r.createElement(Ta,{message:"Oops! No service available.",icon:"offline",onCancel:l,username:a})}})),Ia={marginTop:12},Pa={marginTop:6,textAlign:"center",width:"100%"},Da=function(e){var t,n,a=e.message,o=e.icon,i=e.isWaiting,l=e.onRetry,c=e.onCancel;if(i&&(t=r.createElement("div",{style:Ia},r.createElement(k.ProgressBar,{intent:k.Intent.SUCCESS}))),l||c){var s=c?r.createElement(k.Button,{onClick:c,intent:k.Intent.PRIMARY},"Cancel"):null,u=l?r.createElement(k.Button,{onClick:l},"Retry"):null;n=r.createElement("div",{className:k.Classes.DIALOG_FOOTER},r.createElement("div",{className:k.Classes.DIALOG_FOOTER_ACTIONS},s,u))}return r.createElement(k.Dialog,{isOpen:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1},r.createElement("div",{className:k.Classes.DIALOG_BODY},r.createElement("div",{style:Pa},r.createElement(k.Icon,{icon:o,iconSize:32})),r.createElement("div",{style:Ia},a),t),n)},Ta=function(e){var t=e.message,n=e.icon,a=e.isWaiting,o=e.onRetry,i=e.onCancel,l=e.username,c=r.createElement(r.Fragment,null,t,l&&r.createElement(La,{username:l}));return r.createElement(Da,{message:c,icon:n,isWaiting:a,onRetry:o,onCancel:i})},La=function(e){var t=e.username,n=r.useState("init"),a=Object(m.a)(n,2),o=a[0],i=a[1],l=r.useState(null),c=Object(m.a)(l,2),s=c[0],u=c[1];r.useEffect((function(){t&&"init"===o&&(i("loading"),window.setTimeout((function(){(new Sa.a).getPodStatus(t).then((function(e){i("success"),u(e)})).catch((function(){i("error")}))}),3e3))}),[t,o]);var d=null;if("init"===o||"loading"===o)d=r.createElement("div",null,"Fetching container status...\xa0",r.createElement(k.Spinner,{size:16}));else if("error"===o)d="Failed fetching container status.";else if("success"===o&&s){d="Container error.";var h=null===s||void 0===s?void 0:s.container_statuses;if(h&&h.length>0){var f,b,v=(null===(f=h[0].last_state)||void 0===f?void 0:f.terminated)||(null===(b=h[0].state)||void 0===b?void 0:b.terminated);if(v){var y=v.reason,g=v.exit_code;d="Container terminated. Reason: ".concat(y,", exit code ").concat(g,".")}}}if(!s)return r.createElement("div",{style:{marginTop:"0.5em"}},d);return r.createElement(r.Fragment,null,r.createElement("div",{style:{marginTop:"0.5em"}},d),r.createElement(ka,{details:JSON.stringify(s,null,2),onCopyDetails:function(e){p.Lb(e),Object(wa.a)({type:"info",text:"Details copied to clipboard."})}}),r.createElement("div",{style:{marginTop:"0.5em"},className:"bp4-text-small bp4-text-muted"},"This error typically occurs if our cloud resources are depleted. This is likely due to high server loads caused by running demanding tasks and/or multiple users competing for resources.",r.createElement("br",null),"To mitigate loss of data and time, we recommend that you save your workspace often and enable the setting ",r.createElement("strong",null,"Reopen last workspace on startup")," in the preferences."))},Aa="workflowStepPropertiesDialog";var Ra=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onCancel=a.onCancel.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.state=n.mapPropsToState(e),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState(n.mapPropsToState(e))}},{key:"onConfirm",value:function(){this.props.dispatch(p.Tb(Aa));var e=this.props.selectedWorkflowStep.id||"",t=this.state.stepId?this.state.stepId.trim():"",n=this.props.selectedWorkflowStep.persistent||!1,a=this.state.stepPersistent||!1;n!==a&&this.props.dispatch(p.cd(e,a)),e!==t&&this.props.dispatch(p.tc(e,t))}},{key:"onCancel",value:function(){this.props.dispatch(p.Tb(Aa))}},{key:"canConfirm",value:function(){var e=this.props.selectedWorkflowStep.id||"",t=this.state.stepId?this.state.stepId.trim():"",n=this.props.selectedWorkflowStep.persistent||!1,a=this.state.stepPersistent||!1,r=/^[a-zA-z_][a-zA-z0-9_]*$/.test(t);return""!==t&&(t!==e||a!==n)&&r}},{key:"render",value:function(){return this.props.isOpen?r.createElement(rt.a,{isOpen:this.props.isOpen,title:"Workflow Step & Resource Properties",icon:"edit",onCancel:this.onCancel,onConfirm:this.onConfirm,canConfirm:this.canConfirm,renderBody:this.renderBody}):null}},{key:"renderBody",value:function(){var e=this;return this.props.isOpen?r.createElement("div",{style:{width:"100%",padding:6}},r.createElement(k.Label,null,"Resource name",r.createElement("span",{className:"bp3-text-muted"}," (must be unique within the workspace)"),r.createElement(k.InputGroup,{style:{width:"100%"},type:"text",value:this.state.stepId,onChange:function(t){return e.setState({stepId:t.target.value})}}),r.createElement("span",{className:"bp3-text-muted"},"The Resource name must only contain the uppercase and lowercase letters A through Z, the underscore _ and, except for the first character, the digits 0 through 9.")),r.createElement("div",{style:{paddingTop:10}},r.createElement(k.Checkbox,{checked:this.state.stepPersistent,onChange:function(t){return e.setState({stepPersistent:t.target.checked})},label:"Persist resulting resource"}),r.createElement("span",{className:"bp3-text-muted"},"If checked, the resource will be read from a file in the workspac next time the workspace is opened. This usually speeds up the loading of workspace, but requires extra disk space."))):null}}],[{key:"mapPropsToState",value:function(e){var t=e.selectedWorkflowStep;return de.a(t),{stepId:t.id||"",stepPersistent:t.persistent||!1}}}]),n}(r.Component),Na=Object(i.b)((function(e,t){return{selectedWorkflowStep:t.selectedWorkflowStep,isOpen:F.x(Aa)(e).isOpen,resources:F.bb(e)}}))(Ra);var xa=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleResourceListHeightChanged=a.handleResourceListHeightChanged.bind(Object(E.a)(a)),a.handleShowResourceDetailsChanged=a.handleShowResourceDetailsChanged.bind(Object(E.a)(a)),a.handleResourceNameSelected=a.handleResourceNameSelected.bind(Object(E.a)(a)),a.handleStepListHeightChanged=a.handleStepListHeightChanged.bind(Object(E.a)(a)),a.handleShowWorkflowStepDetailsChanged=a.handleShowWorkflowStepDetailsChanged.bind(Object(E.a)(a)),a.handleWorkflowStepIdSelected=a.handleWorkflowStepIdSelected.bind(Object(E.a)(a)),a.handleShowFigureButtonClicked=a.handleShowFigureButtonClicked.bind(Object(E.a)(a)),a.handleWorkflowStepPropertiesButtonClicked=a.handleWorkflowStepPropertiesButtonClicked.bind(Object(E.a)(a)),a.handleOpenWorkspaceDirectoryClicked=a.handleOpenWorkspaceDirectoryClicked.bind(Object(E.a)(a)),a.handleEditOperationStepButtonClicked=a.handleEditOperationStepButtonClicked.bind(Object(E.a)(a)),a.renderStepItem=a.renderStepItem.bind(Object(E.a)(a)),a.renderResourceAttrName=a.renderResourceAttrName.bind(Object(E.a)(a)),a.renderResourceAttrValue=a.renderResourceAttrValue.bind(Object(E.a)(a)),a.renderOperationStepInputName=a.renderOperationStepInputName.bind(Object(E.a)(a)),a.renderOperationStepInputValue=a.renderOperationStepInputValue.bind(Object(E.a)(a)),a.renderOperationStepOutputName=a.renderOperationStepOutputName.bind(Object(E.a)(a)),a.renderOperationStepOutputValue=a.renderOperationStepOutputValue.bind(Object(E.a)(a)),a.handleWorkspacePanelModeChanged=a.handleWorkspacePanelModeChanged.bind(Object(E.a)(a)),a.handleRemoveOperationStepButtonClicked=a.handleRemoveOperationStepButtonClicked.bind(Object(E.a)(a)),a.handleCleanWorkflowButtonClicked=a.handleCleanWorkflowButtonClicked.bind(Object(E.a)(a)),a.handleShowResourceTableView=a.handleShowResourceTableView.bind(Object(E.a)(a)),a.handleCopyWorkflowAsPythonScript=a.handleCopyWorkflowAsPythonScript.bind(Object(E.a)(a)),a.handleCopyWorkflowAsShellScript=a.handleCopyWorkflowAsShellScript.bind(Object(E.a)(a)),a.handleCopyWorkflowAsJSON=a.handleCopyWorkflowAsJSON.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"handleResourceNameSelected",value:function(e){e&&e.length?this.props.dispatch(p.Vc(e[0])):this.props.dispatch(p.Vc(null))}},{key:"handleWorkflowStepIdSelected",value:function(e){e&&e.length?this.props.dispatch(p.Uc(e[0])):this.props.dispatch(p.Uc(null))}},{key:"handleResourceListHeightChanged",value:function(e){this.props.dispatch(p.Wc("resourceListHeight",e))}},{key:"handleShowResourceDetailsChanged",value:function(e){this.props.dispatch(p.Wc("showResourceDetails",e))}},{key:"handleStepListHeightChanged",value:function(e){this.props.dispatch(p.Wc("workflowStepListHeight",e))}},{key:"handleShowWorkflowStepDetailsChanged",value:function(e){this.props.dispatch(p.Wc("showWorkflowStepDetails",e))}},{key:"handleShowFigureButtonClicked",value:function(){this.props.dispatch(p.fd(this.getEffectiveResource(),this.props.activeViewId))}},{key:"handleShowResourceTableView",value:function(){this.props.dispatch(p.pd(this.getEffectiveResource().name,null,this.props.activeViewId))}},{key:"handleWorkflowStepPropertiesButtonClicked",value:function(){this.props.dispatch(p.dd("workflowStepPropertiesDialog"))}},{key:"handleOpenWorkspaceDirectoryClicked",value:function(){this.props.dispatch(p.id(this.props.workspace.baseDir))}},{key:"handleCopyWorkflowAsPythonScript",value:function(){var e=Va(this.props.operations,this.props.workspace.workflow.steps,"python");p.Lb(e)}},{key:"handleCopyWorkflowAsShellScript",value:function(){var e=Va(this.props.operations,this.props.workspace.workflow.steps,"shell");p.Lb(e)}},{key:"handleCopyWorkflowAsJSON",value:function(){p.Lb(JSON.stringify(this.props.workspace.workflow,null,4))}},{key:"handleEditOperationStepButtonClicked",value:function(){this.props.dispatch(p.ld("editOperationStepDialog"))}},{key:"handleRemoveOperationStepButtonClicked",value:function(){var e=this.getEffectiveResourceName();e&&this.props.dispatch(p.Mb(e))}},{key:"handleCleanWorkflowButtonClicked",value:function(){this.props.dispatch(p.Gb())}},{key:"handleWorkspacePanelModeChanged",value:function(e){this.props.dispatch(p.Bd({workspacePanelMode:e}))}},{key:"getEffectiveWorkflowStep",value:function(){return"steps"===this.props.workspacePanelMode?this.props.selectedWorkflowStep:this.props.selectedResourceWorkflowStep}},{key:"getEffectiveResource",value:function(){return"resources"===this.props.workspacePanelMode?this.props.selectedResource:this.props.selectedWorkflowStepResource}},{key:"getEffectiveResourceName",value:function(){var e=this.getEffectiveResource(),t=this.getEffectiveWorkflowStep();return e?e.name:t?t.id:null}},{key:"renderStepItem",value:function(e){return r.createElement("span",null,this.getWorkflowStepLabel(e))}},{key:"render",value:function(){var e=this.props.workspace;if(!e)return Y;de.a(e.workflow);var t=e.workflow.steps;de.a(t);var a=e.resources;de.a(a);var o=e.isScratch||!e.baseDir?"<unnamed>":e.baseDir.split(/[\\/]/).pop(),i=r.createElement(k.Tooltip,{content:e.baseDir,position:k.PopoverPosition.AUTO_START},r.createElement("strong",null,o)),l=null;e.isModified?l=r.createElement("span",{key:0,style:n.STATE_TAG_STYLE,className:"bp3-tag bp3-intent-warning bp3-minimal"},"Modified"):e.isSaved||(l=r.createElement("span",{key:1,style:n.STATE_TAG_STYLE,className:"bp3-tag bp3-intent-success bp3-minimal"},"Not saved"));var c=r.createElement(Qe,{tooltipContent:"Show workspace directory in file system",onClick:this.handleOpenWorkspaceDirectoryClicked,icon:"folder-open",tooltipPosition:"top"}),s=r.createElement(k.Popover,{position:k.PopoverPosition.LEFT},r.createElement(Qe,{tooltipContent:"Copy workflow",disabled:!t.length,icon:"clipboard",tooltipPosition:"top"}),r.createElement(k.Menu,null,r.createElement(k.MenuItem,{onClick:this.handleCopyWorkflowAsPythonScript,text:"Copy workflow as Python Script"}),r.createElement(k.MenuItem,{onClick:this.handleCopyWorkflowAsShellScript,text:"Copy workflow as Shell Script"}),r.createElement(k.MenuItem,{onClick:this.handleCopyWorkflowAsJSON,text:"Copy workflow as JSON"})));return r.createElement(jt,null,r.createElement("div",{style:n.FLEX_ROW_STYLE},i,r.createElement("span",{style:n.SPACER_STYLE}),l,r.createElement(k.ButtonGroup,null,c,s)),r.createElement(k.Tabs,{id:"workflow",renderActiveTabPanelOnly:!0,selectedTabId:this.props.workspacePanelMode,onChange:this.handleWorkspacePanelModeChanged},r.createElement(k.Tab,{id:"steps",title:"Workflow (".concat(t.length,")"),panel:this.renderWorkflowStepsPanel()}),r.createElement(k.Tab,{id:"resources",title:"Resources (".concat(a.length,")"),panel:this.renderResourcesPanel()})))}},{key:"renderWorkspaceActions",value:function(){var e=this.getEffectiveResource(),t=this.getEffectiveWorkflowStep(),n=Object(Ae.U)(e),a=t&&t.op,o=this.props.workspace&&this.props.workspace.workflow.steps.length,i=Object(Ae.T)(e);return r.createElement(k.ButtonGroup,null,r.createElement(Qe,{tooltipContent:"Show figure",disabled:!n,icon:"eye-open",tooltipPosition:"top",onClick:this.handleShowFigureButtonClicked}),r.createElement(Qe,{tooltipContent:"Show data in table",disabled:!i,icon:"th",tooltipPosition:"top",onClick:this.handleShowResourceTableView}),r.createElement(Qe,{tooltipContent:"Resource/step properties",disabled:!e,icon:"label",tooltipPosition:"top",onClick:this.handleWorkflowStepPropertiesButtonClicked}),r.createElement(Qe,{tooltipContent:"Edit workflow step",intent:k.Intent.PRIMARY,disabled:!t,icon:"edit",tooltipPosition:"top",onClick:this.handleEditOperationStepButtonClicked}),r.createElement(Qe,{tooltipContent:"Remove workflow step and its resource",disabled:!t,icon:"remove",tooltipPosition:"top",onClick:this.handleRemoveOperationStepButtonClicked}),r.createElement(Qe,{tooltipContent:"Clean workspace, remove all steps and resources",disabled:!o,icon:"delete",tooltipPosition:"top",onClick:this.handleCleanWorkflowButtonClicked}),t?r.createElement(Na,{selectedWorkflowStep:t}):null,a?r.createElement(la,{id:"editOperationStepDialog",operationStep:t}):null)}},{key:"renderResourcesPanel",value:function(){var e=this.props.workspace.resources;return e&&e.length?r.createElement(mt,{showDetails:this.props.showResourceDetails,onShowDetailsChange:this.handleShowResourceDetailsChanged,isSplitPanel:!0,contentHeight:this.props.resourceListHeight,onContentHeightChange:this.handleResourceListHeightChanged,actionComponent:this.renderWorkspaceActions()},this.renderResourcesList(),this.renderResourceDetails()):H}},{key:"renderResourcesList",value:function(){var e=this.props.workspace.resources;return r.createElement(jt,null,r.createElement(Ut.a,{items:e,getItemKey:n.getResourceItemKey,renderItem:n.renderResourceItem,selection:this.props.selectedResourceName,onSelection:this.handleResourceNameSelected,onItemDoubleClick:this.handleEditOperationStepButtonClicked}))}},{key:"renderResourceDetails",value:function(){var e=this.props.selectedResourceAttributes;return e&&e.length?r.createElement(jt,null,r.createElement("span",null,"Attributes:"),r.createElement(ut.a,{numRows:e.length,enableRowHeader:!1},r.createElement(st.a,{name:"Name",cellRenderer:this.renderResourceAttrName}),r.createElement(st.a,{name:"Value",cellRenderer:this.renderResourceAttrValue}))):null}},{key:"renderWorkflowStepsPanel",value:function(){var e=this.props.workspace.workflow.steps;return e&&e.length?r.createElement(mt,{showDetails:this.props.showWorkflowStepDetails,onShowDetailsChange:this.handleShowWorkflowStepDetailsChanged,isSplitPanel:!0,contentHeight:this.props.workflowStepListHeight,onContentHeightChange:this.handleStepListHeightChanged,actionComponent:this.renderWorkspaceActions()},this.renderWorkflowStepsList(),this.renderWorkflowStepDetails()):K}},{key:"renderWorkflowStepsList",value:function(){var e=this.props.workspace.workflow.steps;return r.createElement(jt,null,r.createElement(Ut.a,{items:e,getItemKey:n.getStepItemKey,renderItem:this.renderStepItem,selection:this.props.selectedWorkflowStepId,onSelection:this.handleWorkflowStepIdSelected,onItemDoubleClick:this.handleEditOperationStepButtonClicked}))}},{key:"renderWorkflowStepDetails",value:function(){var e=this.props.selectedWorkflowStepOp;if(!e)return null;var t=n.renderWorkflowStepPorts(e.inputs,"Step inputs:","No step inputs.",this.renderOperationStepInputName,this.renderOperationStepInputValue);return r.createElement(jt,null,t,null)}},{key:"renderResourceAttrName",value:function(e){return r.createElement(ct.a,null,r.createElement(bt.a,null,this.props.selectedResourceAttributes[e][0]))}},{key:"renderResourceAttrValue",value:function(e){return r.createElement(ct.a,null,r.createElement(bt.a,{showPopover:bt.b.WHEN_TRUNCATED,detectTruncation:!0},"".concat(this.props.selectedResourceAttributes[e][1])))}},{key:"renderOperationStepInputName",value:function(e){var t=this.props.selectedWorkflowStepOp.inputs[e],a=this.props.selectedWorkflowStep.inputs[t.name];return n.renderWorkflowPortName(t,a)}},{key:"renderOperationStepInputValue",value:function(e){var t=this.props.selectedWorkflowStepOp.inputs[e],a=this.props.selectedWorkflowStep.inputs[t.name];return n.renderWorkflowPortValue(t,a)}},{key:"renderOperationStepOutputName",value:function(e){var t=this.props.selectedWorkflowStepOp.outputs[e],a=this.props.selectedWorkflowStep.outputs[t.name];return n.renderWorkflowPortName(t,a)}},{key:"renderOperationStepOutputValue",value:function(e){var t=this.props.selectedWorkflowStepOp.outputs[e],a=this.props.selectedWorkflowStep.outputs[t.name];return n.renderWorkflowPortValue(t,a)}},{key:"getWorkflowStepLabel",value:function(e){var t=[];if(e&&e.op){var n=e.op,a=n.lastIndexOf(".");a>0&&(n=n.slice(a+1)),t.push(r.createElement("code",{key:0},n,"()"))}else t.push(r.createElement("code",{key:0},"?()"));var o=this.props.resourcesMap[e.id];return o&&(t.push(r.createElement("span",{key:1}," \u2192 ")),t.push(r.createElement(bn,{key:2,label:o.name,dataType:o.dataType}))),e&&e.persistent&&(t.push(r.createElement("span",{key:3}," ")),t.push(r.createElement(k.Icon,{key:4,icon:"database"}))),r.createElement("span",null,t)}}],[{key:"getResourceItemKey",value:function(e){return e.name}},{key:"renderResourceItem",value:function(e){return r.createElement(bn,{label:e.name,dataType:e.dataType})}},{key:"getStepItemKey",value:function(e){return e.id}},{key:"renderWorkflowStepPorts",value:function(e,t,n,a,o){return e&&e.length?r.createElement("div",null,r.createElement("p",null,t),r.createElement(ut.a,{numRows:e.length,enableRowHeader:!1},r.createElement(st.a,{name:"Name",cellRenderer:a}),r.createElement(st.a,{name:"Value",cellRenderer:o}))):r.createElement("div",null,r.createElement("p",null,n))}},{key:"renderWorkflowPortName",value:function(e,t){return r.createElement(ct.a,null,r.createElement(bt.a,{showPopover:bt.b.ALWAYS},e.name))}},{key:"renderWorkflowPortValue",value:function(e,t){var n;if(t){var a;e.units&&(a=r.createElement("span",{className:"bp3-text-muted"}," (".concat(e.units,")")));var o=Object(he.e)(t)?t:t.source;if(o)n=r.createElement("span",null,"\u2197 ",r.createElement("em",null,o));else{var i=t.value;Object(he.e)(i)&&i.length>128&&(i=i.substr(0,128)+"..."),n=r.createElement("span",null,i,a)}}else{var l=e.defaultValue;n=Object(he.b)(l)?r.createElement("span",null,"".concat(l)," ",r.createElement("span",{className:"bp3-text-muted"},"(default value)")):r.createElement("span",{className:"bp3-text-muted"},"Not given.")}return r.createElement(ct.a,null,n)}}]),n}(r.PureComponent);xa.STATE_TAG_STYLE={margin:2},xa.FLEX_ROW_STYLE={display:"flex",alignItems:"center"},xa.SPACER_STYLE={flex:1};var Ma=Object(i.b)((function(e){return{workspace:F.nc(e),resourcesMap:F.Z(e),resourceListHeight:F.Y(e),showResourceDetails:F.Xb(e),selectedResource:F.Bb(e),selectedResourceAttributes:F.zb(e),selectedResourceName:F.Ab(e),selectedResourceWorkflowStep:F.Db(e),workflowStepListHeight:F.ic(e),showWorkflowStepDetails:F.Yb(e),selectedWorkflowStep:F.Pb(e),selectedWorkflowStepId:F.Mb(e),selectedWorkflowStepOp:F.Nb(e),selectedWorkflowStepResource:F.Ob(e),activeViewId:F.d(e),workspacePanelMode:e.session.workspacePanelMode,operations:F.T(e)}}))(xa);function Va(e,t,n){var a=[];"python"===n?a.push("import cate.ops"):a.push("cate ws new");for(var r=0;r<t.length;r++){var o=t[r],i=Object(Ae.r)(e,o.op);if(i&&i.inputs){"python"===n&&(a.push(""),a.push("# Step ".concat(r+1)));var l,c=[],s=Object(W.a)(i.inputs);try{for(s.s();!(l=s.n()).done;){var u=l.value,d=o.inputs[u.name];if(d){var p=Object(he.e)(d)?d:d.source;if(d&&p)"python"===n?c.push("".concat(u.name,"=").concat(p)):c.push("".concat(u.name,"=@").concat(p));else if(d){var h=d.value;Object(he.f)(h)&&(h=null);var f=u.defaultValue;Object(he.f)(f)&&(f=null),h!==f&&(Object(he.g)(h)?c.push("".concat(u.name,"=None")):Object(he.e)(h)?c.push("".concat(u.name,'="').concat(h,'"')):Object(he.a)(h)?c.push("".concat(u.name,"=").concat(h?"True":"False")):Object(he.a)(h)&&c.push("".concat(u.name,"=").concat(h)))}}}}catch(v){s.e(v)}finally{s.f()}var m=o.id,b=i.name;"python"===n?a.push("".concat(m," = cate.ops.").concat(b,"(").concat(c.join(", "),")")):a.push("cate res set ".concat(m," ").concat(b," ").concat(c.join(" ")))}}return"shell"===n&&a.push("cate ws exit"),a.push(""),a.join("\n")}var Ba=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleSelectedVariableNameChanged=a.handleSelectedVariableNameChanged.bind(Object(E.a)(a)),a.handleListHeightChanged=a.handleListHeightChanged.bind(Object(E.a)(a)),a.handleShowDetailsChanged=a.handleShowDetailsChanged.bind(Object(E.a)(a)),a.handleShowSelectedVariableLayer=a.handleShowSelectedVariableLayer.bind(Object(E.a)(a)),a.handleAddVariableLayer=a.handleAddVariableLayer.bind(Object(E.a)(a)),a.handleAddVariableTimeSeriesPlot=a.handleAddVariableTimeSeriesPlot.bind(Object(E.a)(a)),a.handleAddVariableHistogramPlot=a.handleAddVariableHistogramPlot.bind(Object(E.a)(a)),a.handleShowVariableTableView=a.handleShowVariableTableView.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"handleSelectedVariableNameChanged",value:function(e){var t=this.props.selectedResource;if(de.a(t),e&&e.length){var n=e[0],a=this.props.variables.find((function(e){return e.name===n}));de.a(a),this.props.dispatch(p.Tc(t,a,this.props.savedLayers))}else this.props.dispatch(p.Tc(t,null))}},{key:"handleListHeightChanged",value:function(e){this.props.dispatch(p.Wc("variableListHeight",e))}},{key:"handleShowDetailsChanged",value:function(e){this.props.dispatch(p.Wc("showVariableDetails",e))}},{key:"handleShowSelectedVariableLayer",value:function(){var e=this.props.showSelectedVariableLayer;this.props.dispatch(p.Xc(!e))}},{key:"handleAddVariableLayer",value:function(){var e=this.props.selectedResource,t=this.props.selectedVariable,n=this.props.activeViewId,a=this.props.savedLayers;de.a(e),de.a(t&&t.imageLayout),de.a(n),this.props.dispatch(p.Cb(n,e,t,!0,a))}},{key:"handleAddVariableTimeSeriesPlot",value:function(){var e=this.props.selectedResource,t=this.props.selectedVariable,n=this.props.selectedPlacemark,a=n.properties.name||"placemark",r=n.geometry.coordinates,o={ds:{source:e.name},var:{value:t.name},indexers:{value:"lon=".concat(r[0],", lat=").concat(r[1])},properties:{value:null},file:{value:null}};this.props.dispatch(p.bd("cate.ops.plot.plot",o,null,!1,"Creating time series plot for placemark ".concat(a)))}},{key:"handleAddVariableHistogramPlot",value:function(){var e=this.props.selectedResource,t=this.props.selectedVariable,n={ds:{source:e.name},var:{value:t.name},indexers:{value:null},properties:{value:"bins=250"},file:{value:null}};this.props.dispatch(p.bd("cate.ops.plot.plot_hist",n,null,!1,"Creating histogram plot"))}},{key:"handleShowVariableTableView",value:function(){var e=this.props.selectedResource,t=this.props.selectedVariable;de.a(e),de.a(t),this.props.dispatch(p.pd(e.name,t.name,this.props.activeViewId))}},{key:"render",value:function(){var e,t=this.props.selectedResource,n=this.props.variables;return n&&n.length?r.createElement(mt,{showDetails:this.props.showVariableDetails,onShowDetailsChange:this.handleShowDetailsChanged,isSplitPanel:!0,contentHeight:this.props.variableListHeight,onContentHeightChange:this.handleListHeightChanged,actionComponent:this.renderVariableActionRow()},r.createElement(Ua,{selectedEntity:this.props.selectedEntity,globeViewPosition:this.props.globeViewPosition,positionData:this.props.positionData,selectedVariableName:this.props.selectedVariableName,onSelectedVariableNameChanged:this.handleSelectedVariableNameChanged,variables:this.props.variables}),r.createElement(Fa,{tableData:this.props.selectedVariableAttributesTableData})):t?(e=t.name,r.createElement(k.NonIdealState,{title:"No variables",icon:"circle",description:'Selected resource "'.concat(e,"\" doesn't contain any variables.")})):Q}},{key:"renderVariableActionRow",value:function(){var e=this.props.selectedVariable,t=e&&e.numDims>=2&&e.imageLayout,n=this.props.selectedPlacemark,a=this.props.activeViewType&&"world"===this.props.activeViewType,o=t&&a,i=t&&n,l=e&&e.numDims>0;return r.createElement(k.ButtonGroup,null,r.createElement(Qe,{tooltipContent:"Toggle image layer visibility",icon:this.props.showSelectedVariableLayer?"eye-open":"eye-off",tooltipPosition:"top",onClick:this.handleShowSelectedVariableLayer}),r.createElement(Qe,{tooltipContent:"Add a new image layer",disabled:!o,icon:"layer",tooltipPosition:"top",onClick:this.handleAddVariableLayer}),r.createElement(Qe,{tooltipContent:"Create a time series plot from selected placemark",disabled:!i,icon:"timeline-line-chart",tooltipPosition:"top",onClick:this.handleAddVariableTimeSeriesPlot}),r.createElement(Qe,{tooltipContent:"Create a histogram plot",disabled:!l,icon:"timeline-bar-chart",tooltipPosition:"top",onClick:this.handleAddVariableHistogramPlot}),r.createElement(Qe,{tooltipContent:"Show data in table (only first ".concat(1e4," values)"),icon:"th",tooltipPosition:"top",onClick:this.handleShowVariableTableView}))}}]),n}(r.Component);Ba.VALUE_STYLE={float:"right",color:k.Colors.BLUE5};var Wa=Object(i.b)((function(e){return{variables:F.ac(e)||F.a,selectedResource:F.Bb(e),selectedVariableName:F.Jb(e),selectedVariable:F.Kb(e),selectedVariableAttributesTableData:F.Gb(e),variableListHeight:e.session.variableListHeight,showVariableDetails:e.session.showVariableDetails,showSelectedVariableLayer:e.session.showSelectedVariableLayer,activeViewId:F.d(e),activeViewType:F.f(e),savedLayers:F.db(e),selectedPlacemark:F.yb(e),selectedEntity:F.mb(e),globeViewPosition:e.location.globeViewPosition,positionData:e.location.positionData}}))(Ba),Ua=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){var e;Object(y.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).getItemKey=function(e){return e.name},e.getItemValue=function(t){var n;if(Object(Ae.Z)(t)){var a=e.props.selectedEntity;if(a&&a.properties){var r=a.properties[t.name];Object(he.c)(r)&&(n=r.getValue())}}else if(Object(Ae.Y)(t)){var o=e.props.positionData;o&&(n=o[t.name])}return Object(he.b)(n)?n:t.value},e.renderItem=function(t){var n=r.createElement(bn,{label:t.name,dataType:t.dataType,tooltipText:t.attributes&&t.attributes.long_name}),a=e.getItemValue(t);return Object(he.b)(a)?r.createElement("div",null,n,r.createElement("span",{style:Ba.VALUE_STYLE},"".concat(a))):n},e.handleVariableNameSelection=function(t){e.props.onSelectedVariableNameChanged(t)},e}return Object(g.a)(n,[{key:"render",value:function(){var e="vlb",t=this.props.selectedEntity&&this.props.selectedEntity.id;t&&(e+="_".concat(t));var n=this.props.globeViewPosition;return n&&(e+="_".concat(n.longitude,",").concat(n.latitude)),r.createElement(jt,null,r.createElement(Ut.a,{key:e,items:this.props.variables,getItemKey:this.getItemKey,renderItem:this.renderItem,selection:this.props.selectedVariableName,selectionMode:Ut.b.SINGLE,onSelection:this.handleVariableNameSelection}))}}]),n}(r.PureComponent),Fa=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){var e;Object(y.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).renderAttributeName=function(t){return r.createElement(ct.a,null,e.props.tableData[t][0])},e.renderAttributeValue=function(t){return r.createElement(ct.a,null,r.createElement(bt.a,null,e.props.tableData[t][1]))},e}return Object(g.a)(n,[{key:"render",value:function(){var e=this.props.tableData;return e&&e.length?r.createElement("div",{style:n.DIV_STYLE},r.createElement(ut.a,{numRows:e.length,enableRowHeader:!1},r.createElement(st.a,{name:"Name",cellRenderer:this.renderAttributeName}),r.createElement(st.a,{name:"Value",cellRenderer:this.renderAttributeValue}))):null}}]),n}(r.PureComponent);Fa.DIV_STYLE={paddingTop:4,width:"100%"};var Ga=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onCancel=a.onCancel.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.handleChangedVariableSelection=a.handleChangedVariableSelection.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.state={selectedIndices:null},a}return Object(g.a)(n,[{key:"onCancel",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID))}},{key:"onConfirm",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID));var e,t=!0,a=Object(W.a)(this.state.selectedIndices);try{for(a.s();!(e=a.n()).done;){var r=e.value,o=this.props.layerVariables[r];this.props.dispatch(p.Cb(this.props.activeViewId,o.resource,o.variable,t,this.props.savedLayers)),t=!1}}catch(i){a.e(i)}finally{a.f()}}},{key:"canConfirm",value:function(){return!!this.state.selectedIndices&&this.state.selectedIndices.length>0}},{key:"handleChangedVariableSelection",value:function(e){this.setState({selectedIndices:e.slice()})}},{key:"render",value:function(){return r.createElement(rt.a,{isOpen:this.props.isOpen,title:n.DIALOG_TITLE,icon:"layers",onCancel:this.onCancel,onConfirm:this.onConfirm,canConfirm:this.canConfirm,renderBody:this.renderBody})}},{key:"renderBody",value:function(){return this.props.isOpen?this.props.layerVariables.length?r.createElement(jt,null,r.createElement("p",null,"Select the variables you wish to add as a layer:"),r.createElement(Ut.a,{items:this.props.layerVariables,getItemKey:n.getVariableItemKey,renderItem:n.renderVariableItem,selectionMode:Ut.b.MULTIPLE,selection:this.state.selectedIndices,onSelection:this.handleChangedVariableSelection})):r.createElement("p",null,"There are currently no resource or variables that could be added as layers."):null}}],[{key:"getVariableItemKey",value:function(e,t){return t}},{key:"renderVariableItem",value:function(e){var t=e.variable;return r.createElement("div",null,r.createElement("span",null,e.resource.name),r.createElement("span",null," / "),r.createElement(bn,{label:t.name,dataType:"".concat(t.dataType,"[").concat(t.dimNames,"]"),units:t.units}))}}]),n}(r.Component);Ga.DIALOG_ID="layerSourcesDialog",Ga.DIALOG_TITLE="Add Layer";var Ya=Object(i.b)((function(e){return{isOpen:F.x(Ga.DIALOG_ID)(e).isOpen,layers:F.L(e),savedLayers:F.db(e),activeViewId:F.d(e),resources:F.bb(e),layerVariables:F.sb(e)}}))(Ga);var Ha=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleCopyGeometryAsCsv=function(e){p.Lb(function(e,t){var n="longitude".concat(t=t||",","latitude\n");if("Point"===e.type){var a=e.coordinates;return"".concat(n).concat(a[0]).concat(t).concat(a[1],"\n")}if("LineString"===e.type){var r,o=e.coordinates,i=[],l=Object(W.a)(o);try{for(l.s();!(r=l.n()).done;){var c=r.value;i.push("".concat(c[0]).concat(t).concat(c[1],"\n"))}}catch(v){l.e(v)}finally{l.f()}return"".concat(n).concat(i.join(""))}if("Polygon"===e.type){var s,u=e.coordinates,d=[],p=Object(W.a)(u);try{for(p.s();!(s=p.n()).done;){var h=s.value;d.length>0&&d.push("# hole:\n");var f,m=Object(W.a)(h);try{for(m.s();!(f=m.n()).done;){var b=f.value;d.push("".concat(b[0]).concat(t).concat(b[1],"\n"))}}catch(v){m.e(v)}finally{m.f()}}}catch(v){p.e(v)}finally{p.f()}return"".concat(n).concat(d.join(""))}return""}(e.geometry))},a.handleCopyGeometryAsWkt=function(e){p.Lb(Ye(e.geometry))},a.handleCopyGeometryAsGeoJson=function(e){var t;p.Lb((t=e,JSON.stringify(t,null,2)))},a.handleListHeightChanged=a.handleListHeightChanged.bind(Object(E.a)(a)),a.handleShowDetailsChanged=a.handleShowDetailsChanged.bind(Object(E.a)(a)),a.handleNewPointToolButtonClicked=a.handleNewPointToolButtonClicked.bind(Object(E.a)(a)),a.handleNewPolygonToolButtonClicked=a.handleNewPolygonToolButtonClicked.bind(Object(E.a)(a)),a.handleNewPolylineToolButtonClicked=a.handleNewPolylineToolButtonClicked.bind(Object(E.a)(a)),a.handleNewBoxToolButtonClicked=a.handleNewBoxToolButtonClicked.bind(Object(E.a)(a)),a.handleRemovePlacemarkButtonClicked=a.handleRemovePlacemarkButtonClicked.bind(Object(E.a)(a)),a.handleLocatePlacemarkButtonClicked=a.handleLocatePlacemarkButtonClicked.bind(Object(E.a)(a)),a.handleChangedPlacemarkVisibility=a.handleChangedPlacemarkVisibility.bind(Object(E.a)(a)),a.handleChangedPlacemarkSelection=a.handleChangedPlacemarkSelection.bind(Object(E.a)(a)),a.handleChangedPlacemarkName=a.handleChangedPlacemarkName.bind(Object(E.a)(a)),a.handleChangedPointLongitude=a.handleChangedPointLongitude.bind(Object(E.a)(a)),a.handleChangedPointLatitude=a.handleChangedPointLatitude.bind(Object(E.a)(a)),a.handleCopySelectedPlacemarkAsCsv=a.handleCopySelectedPlacemarkAsCsv.bind(Object(E.a)(a)),a.handleCopySelectedPlacemarkAsWkt=a.handleCopySelectedPlacemarkAsWkt.bind(Object(E.a)(a)),a.handleCopySelectedPlacemarkAsGeoJSON=a.handleCopySelectedPlacemarkAsGeoJSON.bind(Object(E.a)(a)),a.handlePlacemarkDoubleClick=a.handlePlacemarkDoubleClick.bind(Object(E.a)(a)),a.renderPlacemarkItem=a.renderPlacemarkItem.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"handleListHeightChanged",value:function(e){this.props.dispatch(p.Bd({placemarkListHeight:e}))}},{key:"handleNewPointToolButtonClicked",value:function(){this.props.dispatch(p.yb("PointTool"))}},{key:"handleNewPolygonToolButtonClicked",value:function(){this.props.dispatch(p.yb("PolygonTool"))}},{key:"handleNewPolylineToolButtonClicked",value:function(){this.props.dispatch(p.yb("PolylineTool"))}},{key:"handleNewBoxToolButtonClicked",value:function(){this.props.dispatch(p.yb("BoxTool"))}},{key:"handleShowDetailsChanged",value:function(e){this.props.dispatch(p.Bd({showPlacemarkDetails:e}))}},{key:"handleRemovePlacemarkButtonClicked",value:function(){this.props.dispatch(p.rc(this.props.selectedPlacemarkId))}},{key:"handleLocatePlacemarkButtonClicked",value:function(){this.props.dispatch(p.cc(this.props.selectedPlacemarkId))}},{key:"handlePlacemarkDoubleClick",value:function(e){this.props.dispatch(p.cc(e.id))}},{key:"handleChangedPlacemarkVisibility",value:function(e,t){this.props.dispatch(p.yd(e.id,{visible:t}))}},{key:"handleChangedPlacemarkName",value:function(e){var t=this.props.selectedPlacemark,n=e.value;this.props.dispatch(p.zd(t.id,{title:n}))}},{key:"handleChangedPointLongitude",value:function(e){var t=this.props.selectedPlacemark,n=t.geometry;n=Object(a.a)(Object(a.a)({},n),{},{coordinates:[e.value,n.coordinates[1]]}),this.props.dispatch(p.xd(t.id,n))}},{key:"handleChangedPointLatitude",value:function(e){var t=this.props.selectedPlacemark,n=t.geometry;n=Object(a.a)(Object(a.a)({},n),{},{coordinates:[n.coordinates[0],e.value]}),this.props.dispatch(p.xd(t.id,n))}},{key:"handleChangedPlacemarkSelection",value:function(e){var t=e.length?e[0]:null;this.props.dispatch(p.Qc(t))}},{key:"handleCopySelectedPlacemarkAsCsv",value:function(){this.handleCopyGeometryAsCsv(this.props.selectedPlacemark)}},{key:"handleCopySelectedPlacemarkAsWkt",value:function(){this.handleCopyGeometryAsWkt(this.props.selectedPlacemark)}},{key:"handleCopySelectedPlacemarkAsGeoJSON",value:function(){this.handleCopyGeometryAsGeoJson(this.props.selectedPlacemark)}},{key:"render",value:function(){return r.createElement("div",{style:{width:"100%"}},r.createElement(mt,{showDetails:this.props.showPlacemarkDetails,onShowDetailsChange:this.handleShowDetailsChanged,isSplitPanel:!0,contentHeight:this.props.placemarkListHeight,onContentHeightChange:this.handleListHeightChanged,actionComponent:this.renderActionButtonRow()},this.renderPlacemarksList(),this.renderPlacemarkDetails()))}},{key:"renderActionButtonRow",value:function(){var e="PointTool"===this.props.geometryToolType,t="PolylineTool"===this.props.geometryToolType,n="PolygonTool"===this.props.geometryToolType,a="BoxTool"===this.props.geometryToolType;return r.createElement(k.ButtonGroup,null,r.createElement(Qe,{tooltipContent:"New marker",onClick:this.handleNewPointToolButtonClicked,icon:"dot",tooltipPosition:"top",active:e,disabled:!1}),r.createElement(Qe,{tooltipContent:"New polyline",onClick:this.handleNewPolylineToolButtonClicked,icon:"slash",tooltipPosition:"top",active:t,disabled:!1}),r.createElement(Qe,{tooltipContent:"New polygon",onClick:this.handleNewPolygonToolButtonClicked,icon:"polygon-filter",tooltipPosition:"top",active:n,disabled:!1}),r.createElement(Qe,{tooltipContent:"New box",onClick:this.handleNewBoxToolButtonClicked,icon:"widget",tooltipPosition:"top",active:a,disabled:!1}),r.createElement(Qe,{tooltipContent:"Remove selected place",disabled:!this.props.selectedPlacemarkId,onClick:this.handleRemovePlacemarkButtonClicked,icon:"remove",tooltipPosition:"top"}),r.createElement(Qe,{tooltipContent:"Locate selected place in view",disabled:!this.props.selectedPlacemarkId,onClick:this.handleLocatePlacemarkButtonClicked,icon:"locate",tooltipPosition:"top"}),r.createElement(k.Popover,{disabled:!this.props.selectedPlacemark,position:k.Position.LEFT},r.createElement(Qe,{tooltipContent:this.props.selectedPlacemark?"Copy selected place.":"Copy selected place: Please select a place first.",disabled:!this.props.selectedPlacemark,icon:"clipboard",tooltipPosition:"top"}),r.createElement(k.Menu,null,r.createElement(k.MenuItem,{onClick:this.handleCopySelectedPlacemarkAsCsv,text:"Copy as CSV"}),r.createElement(k.MenuItem,{onClick:this.handleCopySelectedPlacemarkAsWkt,text:"Copy as WKT"}),r.createElement(k.MenuItem,{onClick:this.handleCopySelectedPlacemarkAsGeoJSON,text:"Copy as GeoJSON"}))),r.createElement(Ya,null))}},{key:"renderPlacemarksList",value:function(){var e=this.props.placemarkCollection.features;return e&&e.length?r.createElement(jt,null,r.createElement(Ut.a,{items:e,getItemKey:n.getPlacemarkItemKey,renderItem:this.renderPlacemarkItem,selectionMode:Ut.b.SINGLE,selection:this.props.selectedPlacemarkId,onSelection:this.handleChangedPlacemarkSelection})):te}},{key:"renderPlacemarkItem",value:function(e){return r.createElement(za,{placemark:e,onDoubleClick:this.handlePlacemarkDoubleClick,onVisibilityChange:this.handleChangedPlacemarkVisibility,onCopyPlacemarkCsv:this.handleCopyGeometryAsCsv,onCopyPlacemarkWkt:this.handleCopyGeometryAsWkt,onCopyPlacemarkGeoJSON:this.handleCopyGeometryAsGeoJson})}},{key:"renderPlacemarkDetails",value:function(){var e=this.props.placemarkCollection.features;return e&&e.length?this.props.selectedPlacemark?r.createElement("div",{style:{width:"100%"}},r.createElement(k.Label,{key:"spacer"}," "),this.renderPlacemarkTitle(),this.renderPlacemarkGeometry()):ne:null}},{key:"renderPlacemarkTitle",value:function(){var e=this.props.selectedPlacemark.properties.title;return r.createElement(k.Label,{className:"bp3-inline"},"Name",r.createElement("span",{className:"bp3-text-muted"}," (optional)"),r.createElement(hn.a,{value:{textValue:e,value:e},onChange:this.handleChangedPlacemarkName,size:16,uncontrolled:!0,placeholder:"Placemark name"}))}},{key:"renderPlacemarkGeometry",value:function(){var e=this.props.selectedPlacemark.geometry;if("Point"===e.type){var t=e.coordinates;return r.createElement("div",null,r.createElement(k.Label,{className:"bp3-inline"},"Longitude",r.createElement("span",{className:"bp3-text-muted"}," (in degrees)"),r.createElement(sn,{value:t[0],onChange:this.handleChangedPointLongitude,size:12,uncontrolled:!0,min:-180,max:180,placeholder:"Longitude in degrees"})),r.createElement(k.Label,{className:"bp3-inline"},"Latitude",r.createElement("span",{className:"bp3-text-muted"}," (in degrees)"),r.createElement(sn,{value:t[1],onChange:this.handleChangedPointLatitude,size:12,uncontrolled:!0,min:-90,max:90,placeholder:"Latitude in degrees"})))}return Ge(e),null}}],[{key:"getPlacemarkItemKey",value:function(e){return e.id}}]),n}(r.Component),Ka=Object(i.b)((function(e){return{placemarkCollection:F.W(e),selectedPlacemarkId:F.xb(e),selectedPlacemark:F.yb(e),placemarkListHeight:e.session.placemarkListHeight,showPlacemarkDetails:F.Wb(e),activeView:F.e(e),geometryToolType:F.O(e)}}))(Ha),za=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).placemarkItemRef=Object(r.createRef)(),a.handleVisibilityChanged=a.handleVisibilityChanged.bind(Object(E.a)(a)),a.handleCopyPlacemarkCsv=a.handleCopyPlacemarkCsv.bind(Object(E.a)(a)),a.handleCopyPlacemarkWkt=a.handleCopyPlacemarkWkt.bind(Object(E.a)(a)),a.handleCopyPlacemarksGeoJSON=a.handleCopyPlacemarksGeoJSON.bind(Object(E.a)(a)),a.handleDoubleClick=a.handleDoubleClick.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"handleDoubleClick",value:function(){this.props.onDoubleClick(this.props.placemark)}},{key:"handleCopyPlacemarkCsv",value:function(){this.props.onCopyPlacemarkCsv(this.props.placemark)}},{key:"handleCopyPlacemarkWkt",value:function(){this.props.onCopyPlacemarkWkt(this.props.placemark)}},{key:"handleCopyPlacemarksGeoJSON",value:function(){this.props.onCopyPlacemarkGeoJSON(this.props.placemark)}},{key:"handleVisibilityChanged",value:function(e){this.props.onVisibilityChange(this.props.placemark,e.target.checked)}},{key:"componentDidMount",value:function(){var e=this,t=this.placemarkItemRef.current;t&&(t.oncontextmenu=function(t){t.preventDefault();var n=r.createElement(k.Menu,{},r.createElement(k.MenuItem,{onClick:e.handleCopyPlacemarkCsv,text:"Copy as CSV"}),r.createElement(k.MenuItem,{onClick:e.handleCopyPlacemarkWkt,text:"Copy as WKT"}),r.createElement(k.MenuItem,{onClick:e.handleCopyPlacemarksGeoJSON,text:"Copy as GeoJSON"}));k.ContextMenu.show(n,{left:t.clientX,top:t.clientY},(function(){}))})}},{key:"render",value:function(){var e,t,a=this.props.placemark,o=a.properties.visible,i=a.properties.title,l=a.geometry;if("Point"===l.type){var c=l.coordinates;t=" ".concat(c[0].toFixed(3),", ").concat(c[1].toFixed(3)),e="dot"}else if("LineString"===l.type){var s=l.coordinates;t=" ".concat(s.length," positions"),e="slash"}else if("Polygon"===l.type){var u=l.coordinates[0];t=" ".concat(u.length-1," positions"),e=Ge(l)?"widget":"polygon-filter"}return r.createElement("div",{ref:this.placemarkItemRef,style:n.DIV_STYLE},r.createElement(k.Icon,{style:{marginRight:"4px"},icon:o?"eye-open":"eye-off"}),r.createElement(k.Checkbox,{style:n.CHECK_STYLE,checked:!Object(he.a)(o)||o,onChange:this.handleVisibilityChanged}),r.createElement("div",{onDoubleClick:this.handleDoubleClick,style:n.LABEL_STYLE},r.createElement("span",{style:n.ICON_STYLE},r.createElement(k.Icon,{icon:e})),r.createElement("span",{style:n.NAME_STYLE},i),r.createElement("span",{style:n.INFO_STYLE},t)))}}]),n}(r.PureComponent);za.DIV_STYLE={display:"flex",alignItems:"center"},za.CHECK_STYLE={flexGrow:0,margin:0},za.LABEL_STYLE={flexGrow:1},za.ICON_STYLE={marginLeft:"0.5em"},za.NAME_STYLE={marginLeft:"0.5em"},za.INFO_STYLE={float:"right",color:k.Colors.BLUE5};var qa=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onViewModeChange=a.onViewModeChange.bind(Object(E.a)(a)),a.onAddWorldView=a.onAddWorldView.bind(Object(E.a)(a)),a.onShowLayerTextOverlayChange=a.onShowLayerTextOverlayChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onViewModeChange",value:function(e){this.props.dispatch(p.Zc(this.props.activeViewId,e.target.value))}},{key:"onShowLayerTextOverlayChange",value:function(e){var t=e.target.checked;this.props.dispatch(p.Bd({showLayerTextOverlay:t}))}},{key:"onAddWorldView",value:function(){this.props.dispatch(p.Db(this.props.activeViewId,this.props.lastBaseMapId))}},{key:"render",value:function(){return r.createElement("div",{style:{margin:"0.2em 0.2em 0.2em 0.2em"}},r.createElement(k.AnchorButton,{icon:"globe",style:n.ACTION_ITEM_STYLE,onClick:this.onAddWorldView},"New World View"),this.renderActiveViewPanel())}},{key:"renderActiveViewPanel",value:function(){var e=this.props.activeView;if(!e)return $;var t=r.createElement(k.Label,{style:n.PROPERTY_ITEM_STYLE},"Active view:",r.createElement(k.ControlGroup,{style:n.PROPERTY_ITEM_CONTROL_GROUP_STYLE},r.createElement(k.Icon,{icon:e.icon,style:n.PROPERTY_ITEM_CONTROL_GROUP_MEMBER_STYLE}),r.createElement(k.InputGroup,{style:n.PROPERTY_ITEM_CONTROL_GROUP_MEMBER_STYLE,type:"text",value:e.title,dir:"auto",disabled:!0})));return"world"===e.type?r.createElement("div",null,t,r.createElement(k.Checkbox,{label:"Show layer text overlay",style:n.PROPERTY_ITEM_STYLE,checked:this.props.showLayerTextOverlay,onChange:this.onShowLayerTextOverlayChange})):t}}]),n}(r.Component);qa.ACTION_ITEM_STYLE={margin:"0.1em 0em 2em 0em"},qa.PROPERTY_ITEM_STYLE={margin:"0.1em 0em 0.6em 0em"},qa.PROPERTY_ITEM_CONTROL_GROUP_STYLE={display:"flex",alignItems:"center"},qa.PROPERTY_ITEM_CONTROL_GROUP_MEMBER_STYLE={marginBlock:0};var Ja=Object(i.b)((function(e){return{activeView:F.e(e),activeViewId:F.d(e),lastBaseMapId:e.session.lastBaseMapId,showLayerTextOverlay:e.session.showLayerTextOverlay}}))(qa),Xa=n(38);var Za=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleShowDetails=a.handleShowDetails.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"handleShowDetails",value:function(){this.props.dispatch(p.jd(this.props.task.title,this.props.task.failure))}},{key:"render",value:function(){var e=this,t=this.props.task,a=this.props.jobId,o=r.createElement("p",null,t.title||"Task #".concat(a),":"),i=null;if(n.isRunning(t))if(n.isMakingProgress(t)){var l=0;t.progress.total>0&&t.progress.worked>0&&(l=t.progress.worked/t.progress.total);var c=r.createElement(k.ProgressBar,{intent:k.Intent.SUCCESS,value:l}),s=r.createElement(k.AnchorButton,{type:"button",onClick:function(){return e.props.onCancelJob(a)},text:"Cancel"}),u=r.createElement("div",{style:n.FLEX_ROW_STYLE},r.createElement("div",{style:n.PROGRESS_STYLE},c),r.createElement("div",{style:{flex:"0 1 auto"}},s)),d=null;t.progress&&t.progress.message&&(d=r.createElement("div",{className:"bp3-text-muted"},t.progress.message)),i=r.createElement("div",null,u,d)}else i=r.createElement(k.ProgressBar,null);else if(t.status===Xa.g.CANCELLED||t.status===Xa.g.FAILED){var p,h;t.status===Xa.g.CANCELLED?h=r.createElement("div",null,n.renderIcon(t.failure),"Task has been cancelled."):(p=r.createElement(k.AnchorButton,{onClick:this.handleShowDetails},"Details"),h=r.createElement("div",null,n.renderIcon(t.failure),Object(Xa.l)(t.failure),r.createElement("br",null),r.createElement("div",{className:"bp3-text-muted",style:{paddingTop:"0.4em"}},t.failure.message))),i=r.createElement("div",null,r.createElement(k.ButtonGroup,{className:"bp3-minimal",style:{float:"right"}},p,r.createElement(k.AnchorButton,{icon:"cross",onClick:function(){return e.props.onRemoveJob(a)}})),h)}return r.createElement(k.Card,null,o,i)}}],[{key:"isRunning",value:function(e){return e.status===Xa.g.NEW||e.status===Xa.g.SUBMITTED||e.status===Xa.g.IN_PROGRESS}},{key:"isMakingProgress",value:function(e){return e.status===Xa.g.IN_PROGRESS&&!!e.progress}},{key:"renderIcon",value:function(e){var t=Object(Xa.j)(e),n=Object(Xa.k)(e);return r.createElement(k.Icon,{icon:t,intent:n,style:{paddingRight:"0.4em"}})}}]),n}(r.Component);Za.FLEX_ROW_STYLE={display:"flex",flexFlow:"row nowrap",width:"100%"},Za.PROGRESS_STYLE={flex:"3 1 auto",display:"flex",flexFlow:"column",justifyContent:"center",paddingRight:10};var Qa=Object(i.b)((function(e,t){return t}))(Za);var $a={cancelJob:p.Eb,removeJob:p.sc},er=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"render",value:function(){var e=this.props.tasks,t=[];for(var n in e)e[n].status!==Xa.g.DONE&&t.push(r.createElement(Qa,{key:n,jobId:n,task:e[n],onRemoveJob:this.props.removeJob,onCancelJob:this.props.cancelJob}));return t.length?r.createElement(jt,null,t):r.createElement(k.Card,null,r.createElement("p",null,r.createElement("strong",null,"There are currently no active tasks.")))}}]),n}(r.Component),tr=Object(i.b)((function(e){return{tasks:e.communication.tasks}}),$a)(er);function nr(e){var t=e.className,n=e.style;return r.createElement("a",{className:t,style:n,href:"https://climate.esa.int/en/terms-and-conditions/",target:"_blank",rel:"noopener noreferrer"},"Terms & Conditions")}var ar=n(73);var rr=Object(i.b)((function(e,t){var n=e.communication.webAPIServiceInfo;return{uiVersion:ar.a,apiVersion:n?n.version:null,minimal:t.minimal}}))((function(e){var t=e.uiVersion,n=e.apiVersion,a=e.minimal;return r.createElement("div",null,r.createElement(or,{label:"Cate UI",version:t,minimal:a}),n&&r.createElement(r.Fragment,null,"\xa0",r.createElement(or,{label:"Cate API",version:n,minimal:a})))})),or=function(e){var t=e.label,n=e.version,a=e.minimal,o=n.includes("dev")?k.Intent.WARNING:k.Intent.NONE;return r.createElement(k.Tag,{intent:o,round:!0,minimal:a},t,"\xa0",n)};var ir={cancelJob:p.Eb,removeJob:p.sc},lr=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"render",value:function(){var e,t=this.props.globePosition;return e=t?"lon=".concat(t.longitude.toFixed(2),", lat=").concat(t.latitude.toFixed(2)):"",r.createElement("div",{style:n.DIV_STYLE},r.createElement("div",{style:n.DIV_MESSAGE_STYLE},"Ready."),r.createElement("div",{style:n.DIV_TASKS_STYLE},this.renderTasks()),r.createElement("div",{style:n.DIV_CURSOR_STYLE},e),r.createElement("div",{style:n.DIV_TAC_STYLE},r.createElement(nr,null)),r.createElement(rr,{minimal:!0}),r.createElement("div",{style:n.DIV_STATUS_STYLE},this.renderBackendStatus()))}},{key:"renderTasks",value:function(){var e=this.props.tasks,t=0,n=0,a=[];for(var o in e){var i=e[o],l=!1;i.status===Xa.g.SUBMITTED||i.status===Xa.g.IN_PROGRESS?(t++,l=!0):i.status!==Xa.g.CANCELLED&&i.status!==Xa.g.FAILED||(n++,l=!0),l&&a.push(r.createElement(Qa,{key:o,jobId:o,task:this.props.tasks[o],onRemoveJob:this.props.removeJob,onCancelJob:this.props.cancelJob}))}if(a.length>0){var c,s=null;t>0&&n>0?c="".concat(t," running / ").concat(n," failed task(s)"):t>0?c="".concat(t," running task(s)"):n>0&&(c="".concat(n," failed task(s)")),t>0&&(s=r.createElement("div",{style:{display:"flex",flexFlow:"column",justifyContent:"center",width:"12em",height:"1.5em"}},r.createElement(k.ProgressBar,{intent:k.Intent.SUCCESS})));var u=r.createElement("div",{style:{width:"300px"}},a);return r.createElement(k.Popover,{content:u,position:k.Position.TOP,interactionKind:k.PopoverInteractionKind.HOVER},r.createElement("div",{style:{display:"flex",flexFlow:"row nowrap"}},s,r.createElement("div",{style:{display:"flex",flexFlow:"column",justifyContent:"center",paddingLeft:"5px"}},c)))}return null}},{key:"renderBackendStatus",value:function(){var e,t,n=" (".concat(this.props.webAPIServiceURL,")");return"connecting"===this.props.webAPIStatus?(e="link",t="Connecting"+n):"open"===this.props.webAPIStatus?(e="link",t="Connected"+n):"error"===this.props.webAPIStatus?(e="offline",t="Error"+n):"closed"===this.props.webAPIStatus?(e="offline",t="Closed"+n):(e="help",t="Unknown"+n),r.createElement(k.Tooltip,{content:t,hoverOpenDelay:1500,position:k.Position.LEFT_TOP},r.createElement(k.Icon,{icon:e,iconSize:12}))}}]),n}(r.Component);lr.DIV_STYLE={flex:"none",display:"flex",flexFlow:"row nowrap",height:"1.5em",fontSize:"small",backgroundColor:"#2B95D6",overflow:"hidden"},lr.DIV_MARGIN={margin:"2px 4px 2px 4px"},lr.DIV_MESSAGE_STYLE=Object(a.a)({flex:"60 1 auto"},lr.DIV_MARGIN),lr.DIV_TAC_STYLE=Object(a.a)({flex:"0 1 auto"},lr.DIV_MARGIN),lr.DIV_TASKS_STYLE=Object(a.a)({flex:"20 1 auto"},lr.DIV_MARGIN),lr.DIV_CURSOR_STYLE=Object(a.a)({flex:"20 1 auto"},lr.DIV_MARGIN),lr.DIV_STATUS_STYLE={flex:"0 1 auto",margin:"0px 4px 0px 4px"};var cr=Object(i.b)((function(e){return{webAPIStatus:e.communication.webAPIStatus,webAPIServiceURL:e.communication.webAPIServiceURL,tasks:e.communication.tasks,globePosition:F.E(e)||F.F(e)}}),ir)(lr),sr=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"render",value:function(){var e=this.props.divStyle?Object(a.a)(Object(a.a)({},n.DIV_STYLE),this.props.divStyle):n.DIV_STYLE,t=this.props.titleStyle?Object(a.a)(Object(a.a)({},n.SPAN_STYLE),this.props.titleStyle):n.SPAN_STYLE;return r.createElement("div",{style:e},r.createElement("span",{style:t},this.props.title))}}]),n}(r.PureComponent);sr.DIV_STYLE={margin:"12px 0 6px 0",padding:"2px 6px",backgroundColor:"#3c5161"},sr.SPAN_STYLE={color:"#aaafaf",fontSize:"0.9em",fontWeight:100};var ur=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleShowDetailsChanged=a.handleShowDetailsChanged.bind(Object(E.a)(a)),a.handleListHeightChanged=a.handleListHeightChanged.bind(Object(E.a)(a)),a.handleAddLayerButtonClicked=a.handleAddLayerButtonClicked.bind(Object(E.a)(a)),a.handleRemoveLayerButtonClicked=a.handleRemoveLayerButtonClicked.bind(Object(E.a)(a)),a.handleMoveLayerUpButtonClicked=a.handleMoveLayerUpButtonClicked.bind(Object(E.a)(a)),a.handleMoveLayerDownButtonClicked=a.handleMoveLayerDownButtonClicked.bind(Object(E.a)(a)),a.handleChangedLayerSelection=a.handleChangedLayerSelection.bind(Object(E.a)(a)),a.handleChangedLayerVisibility=a.handleChangedLayerVisibility.bind(Object(E.a)(a)),a.handleChangedLayerSplitMode=a.handleChangedLayerSplitMode.bind(Object(E.a)(a)),a.handleChangedBaseMap=a.handleChangedBaseMap.bind(Object(E.a)(a)),a.renderLayerItem=a.renderLayerItem.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){this.props.colorMapCategories||this.props.dispatch(p.ac())}},{key:"render",value:function(){var e=this.props.activeView;return e&&"world"===e.type?r.createElement("div",{style:{width:"100%"}},r.createElement(mt,{showDetails:this.props.showLayerDetails,onShowDetailsChange:this.handleShowDetailsChanged,isSplitPanel:!0,contentHeight:this.props.layerListHeight,onContentHeightChange:this.handleListHeightChanged,actionComponent:this.renderActionButtonRow()},r.createElement("div",null,this.renderBackgroundMapSelector(),this.renderLayersList()),this.renderLayerDetails())):ae}},{key:"handleShowDetailsChanged",value:function(e){this.props.dispatch(p.Wc("showLayerDetails",e))}},{key:"handleListHeightChanged",value:function(e){this.props.dispatch(p.Wc("layerListHeight",e))}},{key:"handleAddLayerButtonClicked",value:function(){this.props.dispatch(p.dd("layerSourcesDialog"))}},{key:"handleRemoveLayerButtonClicked",value:function(){this.props.dispatch(p.pc(this.props.activeView.id,this.props.selectedLayerId))}},{key:"handleMoveLayerUpButtonClicked",value:function(){this.props.dispatch(p.gc(this.props.activeView.id,this.props.selectedLayerId))}},{key:"handleMoveLayerDownButtonClicked",value:function(){this.props.dispatch(p.fc(this.props.activeView.id,this.props.selectedLayerId))}},{key:"handleChangedLayerVisibility",value:function(e,t){this.props.dispatch(p.vd(this.props.activeView.id,e,{visible:t}))}},{key:"handleChangedLayerSplitMode",value:function(e){this.props.dispatch(p.Ec(this.props.activeView.id,this.props.selectedLayerId,e.target.value))}},{key:"handleChangedLayerSelection",value:function(e){var t=e.length?e[0]:null;this.props.dispatch(p.Mc(this.props.activeView.id,t))}},{key:"handleChangedBaseMap",value:function(e){this.props.dispatch(p.zc(this.props.activeView.id,e.target.value))}},{key:"renderLayerItem",value:function(e){var t=this;return r.createElement("div",{style:n.LAYER_DIV_STYLE},r.createElement(k.Icon,{style:{marginRight:"4px"},icon:e.visible?"eye-open":"eye-off"}),r.createElement(k.Checkbox,{style:n.LAYER_CHECKBOX_STYLE,checked:e.visible,onClick:n.stopPropagation,onChange:function(n){t.handleChangedLayerVisibility(e,n.target.checked)}}),r.createElement(k.Icon,{style:n.LAYER_LABEL_ELEMENT_STYLE,icon:Object(Ae.F)(e),iconSize:12}),r.createElement("span",{style:n.LAYER_LABEL_ELEMENT_STYLE},Object(Ae.E)(e)))}},{key:"renderActionButtonRow",value:function(){var e=this.props.layers?this.props.layers.length:0,t=this.props.selectedLayerIndex,n=this.props.selectedLayer,a=n&&n.id!==Ae.a,o=t>0,i=t>=0&&t<e-1;return r.createElement(k.ButtonGroup,null,r.createElement(Qe,{tooltipContent:"Add a new layer",intent:k.Intent.PRIMARY,onClick:this.handleAddLayerButtonClicked,icon:"add",tooltipPosition:"top"}),r.createElement(Qe,{tooltipContent:"Remove selected layer",disabled:!a,onClick:this.handleRemoveLayerButtonClicked,icon:"remove",tooltipPosition:"top"}),r.createElement(Qe,{tooltipContent:"Move layer up",disabled:!o,onClick:this.handleMoveLayerUpButtonClicked,icon:"arrow-up",tooltipPosition:"top"}),r.createElement(Qe,{tooltipContent:"Move layer down",disabled:!i,onClick:this.handleMoveLayerDownButtonClicked,icon:"arrow-down",tooltipPosition:"top"}),r.createElement(Ya,null))}},{key:"renderBackgroundMapSelector",value:function(){return r.createElement("div",{style:n.BG_MAP_CONTAINER_STYLE},r.createElement("div",{style:n.BG_MAP_LABEL_STYLE},"Base map:"),r.createElement("div",{style:n.BG_MAP_VALUE_STYLE},r.createElement(k.HTMLSelect,{disabled:this.props.offlineMode,value:this.props.offlineMode?"natural_offline":this.props.baseMapId,onChange:this.handleChangedBaseMap},this.props.baseMaps.map((function(e){return r.createElement("option",{key:e.id,value:e.id},e.title)})))))}},{key:"renderLayersList",value:function(){var e=this.props.layers;return e&&e.length?r.createElement(jt,null,r.createElement(Ut.a,{items:e,getItemKey:n.getLayerItemKey,renderItem:this.renderLayerItem,selectionMode:Ut.b.SINGLE,selection:this.props.selectedLayerId,onSelection:this.handleChangedLayerSelection})):null}},{key:"renderLayerDetails",value:function(){var e=this.props.layers;return e&&e.length?this.props.selectedLayer?this.props.selectedImageLayer?r.createElement("div",null,this.renderDataSelectionSection(),this.renderSplitModeSection()):void 0:r.createElement(r.Fragment,null,r.createElement(k.Label,{style:{height:"20px"}}," "),oe):re}},{key:"renderDataSelectionSection",value:function(){var e=this,t=this.props.selectedVariableImageLayer,o=this.props.selectedVariable;if(!t||!o||o.numDims<=2)return null;for(var i=o.numDims-2,l=[],c=function(i){var c=o.dimNames[i],s=o.shape[i]-1;if(s>0){var u=t.varIndex[i];l.push(r.createElement(k.Label,{key:c+"_index",className:"bp3-inline",style:{display:"flex"}},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},n.capitalizeFirstLetter(c)+" index"),r.createElement("div",{style:Object(a.a)(Object(a.a)({},n.SLIDER_DIV_STYLE_10),{},{width:void 0,flex:"auto 1",margin:"auto 0"})},r.createElement(k.Slider,{min:0,max:s,stepSize:1,labelStepSize:s,value:u,onChange:function(n){return function(n,a){var r=t.varIndex.slice();r[n]=a,e.props.dispatch(p.vd(e.props.activeView.id,t,{varIndex:r}))}(i,n)}}))))}},s=0;s<i;s++)c(s);return 0===l.length?null:r.createElement(r.Fragment,null,r.createElement(sr,{title:"DATA SELECTION"}),l)}},{key:"renderSplitModeSection",value:function(){var e=this.props.selectedImageLayer.splitMode||U.b;return r.createElement(r.Fragment,null,r.createElement(sr,{title:"LAYER SPLIT"}),r.createElement(k.RadioGroup,{key:"layerSplit",inline:!0,onChange:this.handleChangedLayerSplitMode,selectedValue:e},r.createElement(k.Radio,{label:"Show left",value:U.a}),r.createElement(k.Radio,{label:"Show right",value:U.c}),r.createElement(k.Radio,{label:"Off",value:U.b})))}}],[{key:"getLayerItemKey",value:function(e){return e.id}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"capitalizeFirstLetter",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}]),n}(r.Component);ur.SLIDER_DIV_STYLE_10={width:"100%",paddingLeft:"1em",paddingRight:"1em"},ur.LABEL_SPAN_STYLE_100={flexBasis:"100px",paddingLeft:"5px"},ur.LAYER_DIV_STYLE={display:"flex",alignItems:"center",justifyContent:"flex-start",height:"100%"},ur.LAYER_LABEL_ELEMENT_STYLE={marginLeft:"0.5em"},ur.LAYER_CHECKBOX_STYLE={flexGrow:0,margin:0},ur.BG_MAP_CONTAINER_STYLE={display:"flex",alignItems:"center",marginTop:3,marginBottom:3},ur.BG_MAP_LABEL_STYLE={flexGrow:0,marginRight:3},ur.BG_MAP_VALUE_STYLE={flexGrow:1,marginRight:1,display:"flex",justifyContent:"flex-end"};var dr=Object(i.b)((function(e){return{offlineMode:F.P(e),selectedVariable:F.Kb(e),activeView:F.e(e),layers:F.L(e),selectedLayerId:F.pb(e),selectedLayerIndex:F.qb(e),selectedLayer:F.rb(e),selectedImageLayer:F.ob(e),selectedVariableImageLayer:F.Ib(e),baseMaps:F.l(e),baseMapId:F.j(e),layerListHeight:e.session.layerListHeight,showLayerDetails:e.session.showLayerDetails,colorMapCategories:F.q(e)}}))(ur),pr=n(229),hr=n.n(pr),fr=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"parseValue",value:function(e){var t=function(e){if(!e||""===e.trim())return null;var t=e.split(",");if(2===t.length){var n=parseFloat(t[0]),a=parseFloat(t[1]);return[n,a]}throw new Error("Value must be a pair of numbers.")}(e);if(!t)return null;var n=t[0],a=t[1];return a<n?[a,n]:t}},{key:"validateValue",value:function(e){if(Object(Xt.a)(Object(Zt.a)(n.prototype),"validateValue",this).call(this,e),Object(he.g)(e)){if(!this.props.nullable)throw new Error("Numeric range value expected.")}else un(e[0],this.props.nullable,this.props.min,this.props.max,this.props.isInt),un(e[1],this.props.nullable,this.props.min,this.props.max,this.props.isInt)}},{key:"formatValue",value:function(e){return!e||e.length<2?"":"".concat(e[0],", ").concat(e[1])}}]),n}(Qt.a);var mr={display:"grid",gridTemplateColumns:"auto auto auto",justifyItems:"stretch",alignItems:"center",columnGap:"0.7em"},br=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).handleUpdateDisplayStatistics=a.handleUpdateDisplayStatistics.bind(Object(E.a)(a)),a.handleChangedDisplayMinMax=a.handleChangedDisplayMinMax.bind(Object(E.a)(a)),a.handleChangedDisplayRange=a.handleChangedDisplayRange.bind(Object(E.a)(a)),a.handleChangedDisplayAlphaBlend=a.handleChangedDisplayAlphaBlend.bind(Object(E.a)(a)),a.handleChangedColorMapName=a.handleChangedColorMapName.bind(Object(E.a)(a)),a.handleChangedStyleContext=a.handleChangedStyleContext.bind(Object(E.a)(a)),a.handleChangedFillColor=a.handleChangedFillColor.bind(Object(E.a)(a)),a.handleChangedFillColorFromPicker=a.handleChangedFillColorFromPicker.bind(Object(E.a)(a)),a.handleChangedFillOpacity=a.handleChangedFillOpacity.bind(Object(E.a)(a)),a.handleChangedStrokeWidth=a.handleChangedStrokeWidth.bind(Object(E.a)(a)),a.handleChangedStrokeColor=a.handleChangedStrokeColor.bind(Object(E.a)(a)),a.handleChangedStrokeColorFromPicker=a.handleChangedStrokeColorFromPicker.bind(Object(E.a)(a)),a.handleChangedStrokeOpacity=a.handleChangedStrokeOpacity.bind(Object(E.a)(a)),a.handleChangedMarkerColor=a.handleChangedMarkerColor.bind(Object(E.a)(a)),a.handleChangedMarkerColorFromPicker=a.handleChangedMarkerColorFromPicker.bind(Object(E.a)(a)),a.handleChangedMarkerSize=a.handleChangedMarkerSize.bind(Object(E.a)(a)),a.handleChangedMarkerSymbol=a.handleChangedMarkerSymbol.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){this.props.colorMapCategories||this.props.dispatch(p.ac())}},{key:"render",value:function(){return r.createElement(r.Fragment,null,this.renderLayerDetails())}},{key:"renderLayerDetails",value:function(){var e;return e=this.props.styleContext===U.d?this.props.selectedEntity?this.renderVectorLayerDetails():le:this.props.selectedVectorLayer?this.renderVectorLayerDetails():this.props.selectedImageLayer?this.renderImageLayerDetails():ie,r.createElement("div",{style:{width:"100%"}},this.renderStyleContext(),e)}},{key:"renderImageLayerDetails",value:function(){return r.createElement(r.Fragment,null,r.createElement(sr,{title:"COLOUR MAPPING"}),this.renderFormAlphaBlending(),this.renderFormDisplayMinMax(),this.renderFormDisplayColorBar(),r.createElement(sr,{title:"IMAGE ENHANCEMENTS"}),this.renderFormImageEnhancement("opacity","Opacity",0,1),this.renderFormImageEnhancement("brightness","Brightness",0,2),this.renderFormImageEnhancement("contrast","Contrast",0,2),this.renderFormImageEnhancement("hue","Hue",0,1),this.renderFormImageEnhancement("saturation","Saturation",0,2),this.renderFormImageEnhancement("gamma","Gamma",1,2))}},{key:"renderFormAlphaBlending",value:function(){var e=this.props.selectedVariableImageLayer;return e?r.createElement(k.Switch,{key:"alpha",checked:e.alphaBlending,label:"Alpha blending",onChange:this.handleChangedDisplayAlphaBlend}):null}},{key:"renderFormDisplayMinMax",value:function(){return this.props.selectedVariableImageLayer||this.props.selectedResourceVectorLayer?r.createElement("div",{style:{width:"100%",marginBottom:"20px"}},r.createElement(k.Label,{key:"drange",style:{display:"flex"}},r.createElement("span",{style:Object(a.a)(Object(a.a)({},n.LABEL_SPAN_STYLE_100),{},{margin:"auto 0"})},"Display range"),r.createElement("div",{style:mr},r.createElement(fr,{value:this.props.displayMinMax,style:{flex:"auto"},onChange:this.handleChangedDisplayMinMax,uncontrolled:!0}),r.createElement(Qe,{tooltipContent:"Compute valid min/max",intent:k.Intent.PRIMARY,icon:"arrows-horizontal",tooltipPosition:"top",style:{flexGrow:0,margin:0},disabled:this.props.isComputingVariableStatistics,onClick:this.handleUpdateDisplayStatistics}))),r.createElement("div",{style:n.SLIDER_DIV_STYLE_15},this.renderDisplayRangeSlider())):null}},{key:"renderFormDisplayColorBar",value:function(){var e,t=this.props.selectedVariableImageLayer;if(!t)return null;if(this.props.colorMapCategories){var a=this.renderColorBarBox(t);e=r.createElement(k.Popover,{content:a,interactionKind:k.PopoverInteractionKind.CLICK,popoverClassName:"bp3-popover-content-sizing cate-color-bars-popover",position:k.PopoverPosition.LEFT},this.renderColorBarButton(t,!1))}else e=this.renderColorBarButton(t,!0);return r.createElement(k.Label,{key:"cmap",className:"bp3-inline",style:{display:"flex"}},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Colour bar"),e)}},{key:"renderFormImageEnhancement",value:function(e,t,o,i){var l=this,c=this.props.selectedVariableImageLayer||this.props.selectedResourceVectorLayer;if(!c||c===this.props.selectedResourceVectorLayer&&"opacity"!==e)return null;return r.createElement(k.Label,{key:e,style:{display:"flex"}},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},t),r.createElement("div",{style:Object(a.a)(Object(a.a)({},n.SLIDER_DIV_STYLE_10),{},{width:void 0,flex:"auto 1",margin:"auto 0"})},r.createElement(k.Slider,{min:o,max:i,stepSize:(i-o)/10,labelRenderer:!1,value:c[e],onChange:function(t){return function(e,t){l.props.dispatch(p.vd(l.props.activeView.id,c,Object(B.a)({},e,t)))}(e,t)}})))}},{key:"renderVectorLayerDetails",value:function(){return r.createElement(r.Fragment,null,r.createElement(sr,{title:"FILL"}),this.renderFillColor(),this.renderFillOpacity(),r.createElement(sr,{title:"STROKE"}),this.renderStrokeWidth(),this.renderStrokeColor(),this.renderStrokeOpacity(),r.createElement(sr,{title:"MARKER"}),this.renderMarkerColor(),this.renderMarkerSize(),this.renderMarkerSymbol())}},{key:"renderStyleContext",value:function(){var e,t,n=this.props.selectedEntity,a=this.props.selectedPlacemark,o=this.props.selectedLayer;if(a){var i=a.properties&&a.properties.title;e=i&&""!==i?"My place ".concat(i):"Selected place"}else e=n?"Selected entity":"Selected entity (none)";return t=o?"Layer ".concat(Object(Ae.E)(o)):"Selected layer",r.createElement(k.RadioGroup,{key:"styleContext",label:"Style context",onChange:this.handleChangedStyleContext,selectedValue:this.props.styleContext},r.createElement(k.Radio,{label:e,value:U.d}),r.createElement(k.Radio,{label:t,value:U.e}))}},{key:"renderFillColor",value:function(){return r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_BOTTOM_MARGIN},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Colour"),r.createElement(k.ControlGroup,{style:{lineHeight:"0",flex:"auto 1"}},r.createElement(hn.a,{value:this.props.vectorStyle.fill,style:{flex:"auto",fontFamily:"courier",textAlign:"right",paddingRight:"40px"},size:8,uncontrolled:!0,onChange:this.handleChangedFillColor}),r.createElement(k.Popover,{interactionKind:k.PopoverInteractionKind.CLICK,popoverClassName:"bp3-minimal",position:k.PopoverPosition.LEFT,className:"bp3-input-action"},r.createElement(k.Button,{style:{backgroundColor:this.props.vectorStyle.fill}}),r.createElement(hr.a,{color:this.props.vectorStyle.fill,onChange:this.handleChangedFillColorFromPicker,disableAlpha:!0}))))}},{key:"renderFillOpacity",value:function(){return r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_BOTTOM_MARGIN},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Opacity"),r.createElement("div",{style:Object(a.a)(Object(a.a)({},n.SLIDER_DIV_STYLE_05),{},{width:void 0,flex:"auto 1",margin:"auto 0"})},r.createElement(k.Slider,{min:0,max:1,stepSize:.05,labelRenderer:!1,value:this.props.vectorStyle.fillOpacity,onChange:this.handleChangedFillOpacity})))}},{key:"renderStrokeWidth",value:function(){return r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_BOTTOM_MARGIN},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Width"),r.createElement(sn,{value:this.props.vectorStyle.strokeWidth,style:{flex:"auto 1",fontFamily:"courier"},size:8,min:0,uncontrolled:!0,onChange:this.handleChangedStrokeWidth}))}},{key:"renderStrokeColor",value:function(){return r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_BOTTOM_MARGIN},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Colour"),r.createElement(k.ControlGroup,{style:{lineHeight:"0",flex:"auto 1"}},r.createElement(hn.a,{value:this.props.vectorStyle.stroke,style:{flex:"auto",fontFamily:"courier",textAlign:"right",paddingRight:"40px"},size:8,uncontrolled:!0,onChange:this.handleChangedStrokeColor}),r.createElement(k.Popover,{interactionKind:k.PopoverInteractionKind.CLICK,popoverClassName:"bp3-minimal",position:k.PopoverPosition.LEFT,className:"bp3-input-action"},r.createElement(k.Button,{style:{backgroundColor:this.props.vectorStyle.stroke}}),r.createElement(hr.a,{color:this.props.vectorStyle.stroke,onChange:this.handleChangedStrokeColorFromPicker,disableAlpha:!0}))))}},{key:"renderStrokeOpacity",value:function(){return r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_BOTTOM_MARGIN},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Opacity"),r.createElement("div",{style:Object(a.a)(Object(a.a)({},n.SLIDER_DIV_STYLE_05),{},{width:void 0,flex:"auto 1",margin:"auto 0"})},r.createElement(k.Slider,{min:0,max:1,stepSize:.05,labelRenderer:!1,value:this.props.vectorStyle.strokeOpacity,onChange:this.handleChangedStrokeOpacity})))}},{key:"renderMarkerColor",value:function(){return r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_BOTTOM_MARGIN},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Colour"),r.createElement(k.ControlGroup,{style:{lineHeight:"0",flex:"auto 1"}},r.createElement(hn.a,{value:this.props.vectorStyle.markerColor,style:{flex:"auto",fontFamily:"courier",textAlign:"right",paddingRight:"40px"},size:8,uncontrolled:!0,onChange:this.handleChangedMarkerColor}),r.createElement(k.Popover,{interactionKind:k.PopoverInteractionKind.CLICK,popoverClassName:"bp3-minimal",position:k.PopoverPosition.LEFT,className:"bp3-input-action"},r.createElement(k.Button,{style:{backgroundColor:this.props.vectorStyle.markerColor}}),r.createElement(hr.a,{color:this.props.vectorStyle.markerColor,onChange:this.handleChangedMarkerColorFromPicker,disableAlpha:!0}))))}},{key:"renderMarkerSize",value:function(){return r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_BOTTOM_MARGIN},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Size"),r.createElement(k.HTMLSelect,{style:{flex:"auto 1"},value:this.props.vectorStyle.markerSize,onChange:this.handleChangedMarkerSize},r.createElement("option",{value:"small"},"Small"),r.createElement("option",{value:"medium"},"Medium"),r.createElement("option",{value:"large"},"Large")))}},{key:"renderMarkerSymbol",value:function(){return r.createElement(k.Label,{className:"bp3-inline",style:n.LABEL_BOTTOM_MARGIN},r.createElement("span",{style:n.LABEL_SPAN_STYLE_100},"Symbol"),r.createElement(hn.a,{value:this.props.vectorStyle.markerSymbol,style:{flex:"auto",fontFamily:"courier",textAlign:"right"},size:8,uncontrolled:!0,onChange:this.handleChangedMarkerSymbol}))}},{key:"renderDisplayRangeSlider",value:function(){var e=this.props.selectedVariableImageLayer;if(!e)return null;var t=e.statistics;if(!t)return r.createElement("span",{style:{color:k.Colors.ORANGE3}},"Missing data min/max");var n=t.min,a=t.max;if(isNaN(n)||isNaN(a))return r.createElement("span",{style:{color:k.Colors.ORANGE3}},"All values are NaN");if(n===a)return r.createElement("span",{style:{color:k.Colors.ORANGE3}},"All values are ",n);var o=function(e,t){var n=Math.round(Math.log10(t-e));return n<0?1-n:n<=2?2:n<=3?1:0}(n,a);return r.createElement(k.RangeSlider,{min:n,max:a,stepSize:(a-n)/100,labelStepSize:a-n,labelRenderer:function(e){return function(e,t){return t<3?e.toFixed(t):e.toExponential(1)}(e,o)},onChange:this.handleChangedDisplayRange,value:[e.displayMin,e.displayMax]})}},{key:"renderColorBarButton",value:function(e,t){var n=e.colorMapName,a=this.renderColorMapImage(this.props.selectedColorMap)||n||"Select Color Bar";return r.createElement(k.AnchorButton,{className:"bp3-minimal",style:{width:"100%"},disabled:t},a)}},{key:"renderColorBarBox",value:function(e){var t,n=this,a=[],o=Object(W.a)(this.props.colorMapCategories);try{for(o.s();!(t=o.n()).done;){var i=t.value,l=i.colorMaps;a.push(r.createElement("p",{key:i.name+"_head",style:{marginTop:2,marginBottom:2}},r.createElement(k.Tooltip,{content:r.createElement("div",{style:{width:"19em"}},i.description),position:"top"},i.name))),a.push(r.createElement(Ut.a,{key:i.name+"_list",items:l,getItemKey:function(e){return e.name},renderItem:function(e){return n.renderColorMapImage(e)},selectionMode:Ut.b.SINGLE,selection:e.colorMapName?[e.colorMapName]:[],onSelection:this.handleChangedColorMapName}))}}catch(c){o.e(c)}finally{o.f()}return r.createElement("div",{style:{padding:5,overflowY:"auto",height:"87vh"}},a)}},{key:"renderColorMapImage",value:function(e){return e?r.createElement(k.Tooltip,{content:e.name},r.createElement("img",{src:"data:image/png;base64,".concat(e.imageData),alt:e.name,style:{width:"100%",height:"1em"}})):null}},{key:"handleChangedDisplayAlphaBlend",value:function(e){var t=e.target.checked,n=this.props.selectedVariableImageLayer;this.props.dispatch(p.vd(this.props.activeView.id,n,{alphaBlending:t}))}},{key:"handleChangedDisplayMinMax",value:function(e){var t=this.props.selectedVariableImageLayer||this.props.selectedResourceVectorLayer;if(!e.error){var n=e.value[0],a=e.value[1];this.props.dispatch(p.vd(this.props.activeView.id,t,{displayMin:n,displayMax:a}))}}},{key:"handleUpdateDisplayStatistics",value:function(){var e=this,t=this.props.selectedResource,n=this.props.selectedVariable,a=this.props.selectedVariableImageLayer;t&&n&&a&&this.props.dispatch(p.Sb(t.name,n.name,a.varIndex,(function(t){return p.vd(e.props.activeView.id,a,{displayMin:t.min,displayMax:t.max,statistics:t})})))}},{key:"handleChangedDisplayRange",value:function(e){var t=this.props.selectedVariableImageLayer||this.props.selectedResourceVectorLayer;this.props.dispatch(p.vd(this.props.activeView.id,t,{displayMin:e[0],displayMax:e[1]}))}},{key:"handleChangedColorMapName",value:function(e){var t=this.props.selectedVariableImageLayer||this.props.selectedResourceVectorLayer,n=e&&e.length&&e[0];n&&this.props.dispatch(p.vd(this.props.activeView.id,t,{colorMapName:n}))}},{key:"handleChangedStyleContext",value:function(e){this.props.dispatch(p.Yc(e.target.value))}},{key:"handleChangedFillColor",value:function(e){this.handleChangedVectorStyle({fill:e.value})}},{key:"handleChangedFillColorFromPicker",value:function(e){this.handleChangedVectorStyle({fill:e.hex})}},{key:"handleChangedFillOpacity",value:function(e){this.handleChangedVectorStyle({fillOpacity:e})}},{key:"handleChangedStrokeWidth",value:function(e){this.handleChangedVectorStyle({strokeWidth:e.value})}},{key:"handleChangedStrokeColor",value:function(e){this.handleChangedVectorStyle({stroke:e.value})}},{key:"handleChangedStrokeColorFromPicker",value:function(e){this.handleChangedVectorStyle({stroke:e.hex})}},{key:"handleChangedStrokeOpacity",value:function(e){this.handleChangedVectorStyle({strokeOpacity:e})}},{key:"handleChangedMarkerSize",value:function(e){this.handleChangedVectorStyle({markerSize:e.target.value})}},{key:"handleChangedMarkerColor",value:function(e){this.handleChangedVectorStyle({markerColor:e.value})}},{key:"handleChangedMarkerColorFromPicker",value:function(e){this.handleChangedVectorStyle({markerColor:e.hex})}},{key:"handleChangedMarkerSymbol",value:function(e){this.handleChangedVectorStyle({markerSymbol:e.value})}},{key:"handleChangedVectorStyle",value:function(e){this.props.styleContext===U.d?this.props.dispatch(p.sd(this.props.activeView,this.props.selectedEntity,e)):this.props.dispatch(p.wd(this.props.activeView.id,this.props.selectedVectorLayer.id,e))}}]),n}(r.Component);br.SLIDER_DIV_STYLE_05={width:"100%",paddingLeft:"0.5em",paddingRight:"0.5em"},br.SLIDER_DIV_STYLE_10={width:"100%",paddingLeft:"1em",paddingRight:"1em"},br.SLIDER_DIV_STYLE_15={width:"100%",paddingLeft:"1.5em",paddingRight:"1.5em"},br.LABEL_SPAN_STYLE_100={flexBasis:"100px",paddingLeft:"5px"},br.LABEL_BOTTOM_MARGIN={display:"flex",margin:"0 0 5px"};var vr=Object(i.b)((function(e){return{selectedResource:F.Bb(e),selectedVariable:F.Kb(e),activeView:F.e(e),layers:F.L(e),selectedLayer:F.rb(e),selectedImageLayer:F.ob(e),selectedVariableImageLayer:F.Ib(e),selectedVectorLayer:F.Lb(e),selectedResourceVectorLayer:F.Cb(e),selectedEntity:F.mb(e),selectedPlacemark:F.yb(e),styleContext:F.Zb(e),showLayerDetails:e.session.showLayerDetails,colorMapCategories:F.q(e),selectedColorMap:F.eb(e),displayMinMax:F.Hb(e),isComputingVariableStatistics:F.G(e),vectorStyle:F.bc(e)}}))(br);var yr=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).localWebAPI=void 0,a.state={workspaceDir:"",workspaceName:""},a.onCancel=a.onCancel.bind(Object(E.a)(a)),a.onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.onWorkspaceNameChange=a.onWorkspaceNameChange.bind(Object(E.a)(a)),a.onWorkspaceDirChange=a.onWorkspaceDirChange.bind(Object(E.a)(a)),a.showDirectorySelectDialog=a.showDirectorySelectDialog.bind(Object(E.a)(a)),a.localWebAPI=e.isLocalFSAllowed,a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({workspaceDir:e.workspaceDir,workspaceName:e.workspaceName})}},{key:"onCancel",value:function(){this.props.dispatch(p.Tb(this.props.dialogId))}},{key:"canConfirm",value:function(){return!(this.localWebAPI&&!this.state.workspaceDir||!this.state.workspaceName)&&/^([A-Za-z_\-\s0-9.]+)$/.test(this.state.workspaceName)}},{key:"composeWorkspacePath",value:function(){var e=this.state.workspaceDir,t=this.state.workspaceName;return null===e?t:e+"/"+t}},{key:"onConfirm",value:function(){this.props.dispatch(p.Tb(this.props.dialogId,this.state)),this.props.isNewDialog?this.props.dispatch(p.ic(this.composeWorkspacePath())):this.props.dispatch(p.vc(this.composeWorkspacePath()))}},{key:"onWorkspaceDirChange",value:function(e){this.setState({workspaceDir:e.target.value})}},{key:"onWorkspaceNameChange",value:function(e){this.setState({workspaceName:e.target.value})}},{key:"showDirectorySelectDialog",value:function(){var e=this;this.props.dispatch(p.ed({defaultPath:this.state.workspaceDir},(function(t){t&&e.setState({workspaceDir:t})})))}},{key:"render",value:function(){var e=this.props.isOpen;return e?r.createElement(rt.a,{isOpen:e,title:this.props.isNewDialog?"New Workspace":"Save Workspace As",confirmTitle:this.props.isNewDialog?"New":"Save As",onCancel:this.onCancel,canConfirm:this.canConfirm,onConfirm:this.onConfirm,renderBody:this.renderBody}):null}},{key:"renderBody",value:function(){if(!this.props.isOpen)return null;var e=null;return this.props.isLocalFSAllowed&&(e=r.createElement(r.Fragment,null,r.createElement("p",{style:{marginTop:"1em"}},"Workspace parent directory:"),r.createElement(k.ControlGroup,{style:{flexGrow:1,display:"flex",marginLeft:"1em",width:"100%"}},r.createElement(k.InputGroup,{type:"text",style:{flex:"auto"},value:this.state.workspaceDir,onChange:this.onWorkspaceDirChange}),r.createElement(k.AnchorButton,{intent:k.Intent.PRIMARY,style:{flex:"none"},onClick:this.showDirectorySelectDialog},"...")))),r.createElement("div",null,e,r.createElement("p",{style:{marginTop:"1em"}},"Workspace name:"),r.createElement(k.InputGroup,{type:"text",style:{width:"100%"},value:this.state.workspaceName,onChange:this.onWorkspaceNameChange}))}}]),n}(r.Component),gr=Object(i.b)((function(e,t){var n=F.x(t.dialogId)(e),a=n.isOpen,r=t.dialogId,o="newWorkspaceDialog"===t.dialogId,i=F.I(e),l=n.workspaceDir,c=n.workspaceName;return a&&(F.J(e)||(l=l||F.lc(e),c=c||F.mc(e)),l=l||F.K(e)),{workspaceDir:l=i?l||"":null,workspaceName:c=c||"",dialogId:r,isNewDialog:o,isOpen:a,isLocalFSAllowed:i}}))(yr);function Er(){return r.createElement(gr,{dialogId:"newWorkspaceDialog"})}function Or(){return r.createElement(gr,{dialogId:"saveWorkspaceAsDialog"})}var _r={width:"40%"},Cr={width:"100%",marginBottom:"1em"},kr={width:"100%",marginTop:"1em"},wr={width:"60%",wordWrap:"break-word"},Sr=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onConfirm=a.onConfirm.bind(Object(E.a)(a)),a.onCancel=a.onCancel.bind(Object(E.a)(a)),a.canConfirm=a.canConfirm.bind(Object(E.a)(a)),a.renderBody=a.renderBody.bind(Object(E.a)(a)),a.state=e.preferences,a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState(e.preferences)}},{key:"onConfirm",value:function(){if(this.props.dispatch(p.Vb()),me()(this.props.preferences,this.state))Object(wa.a)({type:"info",text:"No changes detected."});else{var e=this.state.backendConfig,t=this.props.preferences.autoUpdateSoftware!==this.state.autoUpdateSoftware,a=!me()(this.props.preferences.backendConfig,e);this.props.dispatch(p.Bd(this.state)),this.props.dispatch(p.Ad(this.state)),(t||a)&&(this.props.dispatch(p.rd(e)),this.props.dispatch(Object(p.kd)({type:"info",title:n.DIALOG_TITLE,message:"Some changes will be effective only after restart."})))}}},{key:"onCancel",value:function(){this.props.dispatch(p.Vb())}},{key:"canConfirm",value:function(){return!0}},{key:"render",value:function(){return r.createElement(rt.a,{isOpen:this.props.isOpen,title:n.DIALOG_TITLE,style:{minWidth:"30em"},icon:"confirm",onCancel:this.onCancel,onConfirm:this.onConfirm,canConfirm:this.canConfirm,renderBody:this.renderBody})}},{key:"renderBody",value:function(){return this.props.isOpen?r.createElement(k.Tabs,{id:"preferences"},r.createElement(k.Tab,{id:"g",title:"General",panel:this.renderGeneralPanel()}),r.createElement(k.Tab,{id:"dm",title:"Data Management",panel:this.renderDataManagementPanel()}),r.createElement(k.Tab,{id:"pc",title:"Proxy Configuration",panel:this.renderProxyConfigurationPanel()}),r.createElement(k.Tab,{id:"a",title:"System",panel:this.renderSystemPanel()})):null}},{key:"renderGeneralPanel",value:function(){return r.createElement("div",{style:{width:"100%",marginTop:"1em"}},this.renderReopenLastWorkspace(),this.renderAutoShowNewFigures())}},{key:"renderDataManagementPanel",value:function(){var e=this.props.serviceInfo.userRootMode;return r.createElement("div",{style:{width:"100%",marginTop:"1em"}},!e&&this.renderDataStoresPath(),!e&&this.renderCacheWorkspaceImagery(),this.renderResourceNamePrefix())}},{key:"renderProxyConfigurationPanel",value:function(){return r.createElement("div",{style:{width:"100%",marginTop:"1em"}},this.renderProxyUrlInput())}},{key:"renderSystemPanel",value:function(){var e=this,t=this.getStateValue("showProperties",!1),n=this.getChangeHandler("showProperties",!1);return r.createElement("div",{style:kr},r.createElement(k.ControlGroup,{style:Cr},r.createElement("span",{style:_r},"Cate UI version:"),r.createElement("span",{style:wr},r.createElement("code",null,ar.a))),r.createElement(k.ControlGroup,{style:Cr},r.createElement("span",{style:_r},"Cate API URL:"),r.createElement("span",{style:wr},r.createElement("code",null,this.props.serviceURL))),r.createElement(k.ControlGroup,{style:Cr},r.createElement("span",{style:_r},"Cate API version:"),r.createElement("span",{style:wr},r.createElement("code",null,this.props.serviceInfo.version))),this.props.serviceInfo.dependencies&&r.createElement(k.ControlGroup,{style:Cr},r.createElement("span",{style:_r},"Cate dependencies:"),r.createElement("div",null,r.createElement(k.Button,{onClick:function(){return n(!t)},small:!0,style:{marginBottom:2}},"Click to "+(t?"collapse":"expand")),r.createElement(k.Collapse,{isOpen:t},r.createElement(k.Card,null,r.createElement(k.HTMLTable,{condensed:!0,small:!0,bordered:!0},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Package"),r.createElement("th",null,"Version"))),r.createElement("tbody",null,Object.getOwnPropertyNames(this.props.serviceInfo.dependencies).map((function(t){var n=e.props.serviceInfo.dependencies[t];return r.createElement("tr",null,r.createElement("td",null,t),r.createElement("td",null,n))})))))))),r.createElement(k.ControlGroup,{style:Cr},r.createElement("span",{style:_r},"File access mode:"),r.createElement("span",{style:wr},this.props.serviceInfo.userRootMode?"sandboxed file system":"full access to file system")))}},{key:"renderReopenLastWorkspace",value:function(){return this.renderBooleanValue("reopenLastWorkspace",!1,"Reopen last workspace on startup")}},{key:"renderAutoShowNewFigures",value:function(){return this.renderBooleanValue("autoShowNewFigures",!1,"Open plot view for new Figure resources")}},{key:"renderDataStoresPath",value:function(){return this.renderDirectoryPath("dataStoresPath",!0,"Synchronisation directory for remote data store files")}},{key:"renderCacheWorkspaceImagery",value:function(){return this.renderBooleanValue("useWorkspaceImageryCache",!0,"Use per-workspace imagery cache (may accelerate image display)")}},{key:"renderResourceNamePrefix",value:function(){return this.renderStringValue("resourceNamePattern",!0,"Default resource name pattern")}},{key:"renderProxyUrlInput",value:function(){var e=this.getStateValue("proxyUrl",!0),t=this.getChangeHandler("proxyUrl",!0);return r.createElement(k.ControlGroup,{style:{width:"100%",marginBottom:"1em",display:"flex",alignItems:"center"}},r.createElement("span",{style:{flexGrow:.8}},"Proxy URL:"),r.createElement(hn.a,{className:"bp3-input bp3-fill",style:{flexGrow:.2},value:e,onChange:t,placeholder:"http://user:password@host:port",nullable:!0}))}},{key:"renderDirectoryPath",value:function(e,t,n){var a=this,o=this.getStateValue(e,t),i=this.getChangeHandler(e,t);return r.createElement("div",{style:{width:"100%",marginBottom:"1em"}},r.createElement("p",null,n,":"),r.createElement(k.ControlGroup,{style:{display:"flex",alignItems:"center"}},r.createElement(hn.a,{style:{flexGrow:1},value:o,placeholder:"Enter directory path",onChange:i}),r.createElement(k.AnchorButton,{intent:k.Intent.PRIMARY,style:{flex:"none"},onClick:function(){return a.showOpenDirectoryDialog(o,i)}},"...")))}},{key:"renderStringValue",value:function(e,t,n){var a=this.getStateValue(e,t),o=this.getChangeHandler(e,t);return r.createElement(k.ControlGroup,{style:{width:"100%",marginBottom:"1em",display:"flex",alignItems:"center"}},r.createElement("span",{style:{flexGrow:.8}},n,":"),r.createElement(hn.a,{style:{flexGrow:.2},value:a,onChange:o}))}},{key:"renderBooleanValue",value:function(e,t,n){var a=this.getStateValue(e,t),o=this.getChangeHandler(e,t);return r.createElement("div",{style:{width:"100%",marginBottom:"1em"}},r.createElement(k.Switch,{checked:a,label:n,onChange:function(e){return o(e.target.checked)}}))}},{key:"getChangeHandler",value:function(e,t){var n=this;return function(a){var r={};r[e]=Object(he.b)(a)?Object(he.b)(a.value)?a.value:a:null,t?n.setBackendConfig(r):n.setState(r)}}},{key:"getStateValue",value:function(e,t){return t?this.state.backendConfig[e]:this.state[e]}},{key:"setBackendConfig",value:function(e){var t=Object.assign({},this.state.backendConfig,e);this.setState({backendConfig:t})}},{key:"showOpenDirectoryDialog",value:function(e,t){this.props.dispatch(p.ed({defaultPath:e},(function(e){e&&t(e)})))}}]),n}(r.Component);Sr.DIALOG_ID="preferencesDialog",Sr.DIALOG_TITLE="Preferences";var jr=Object(i.b)((function(e){return{isOpen:F.x(Sr.DIALOG_ID)(e).isOpen,preferences:e.session,serviceURL:e.communication.webAPIServiceURL,serviceInfo:e.communication.webAPIServiceInfo}}))(Sr),Ir=n(810),Pr=n(51),Dr={display:"flex",flexFlow:"row nowrap",alignItems:"center"},Tr={marginRight:5},Lr={width:"100%",textAlign:"right"},Ar={},Rr=Object(a.a)(Object(a.a)({},Ar),{},{backgroundColor:k.Colors.BLUE3}),Nr={width:"100%",height:"100%",overflow:"auto",borderColor:k.Colors.DARK_GRAY2,borderStyle:"solid",borderWidth:1},xr={width:"100%"},Mr=function(e){var t=e.rootNode,n=e.fileFilter,a=e.multiSelections,o=e.openDirectory,i=e.currentDirPath,l=e.onCurrentDirPathChange,c=e.selectedPaths,s=e.onSelectedPathsChange,u=function(e,t,n){var a=e.childNodes;if(t){var r=Object(Pr.i)(e,t);r&&r.length>0&&(a=r[r.length-1].childNodes)}a&&(n&&(a=Object(Pr.c)(a,n)),a=a.sort(Pr.d));return a}(t,i,n),d=new Set(c),p=function(e){return u[e]},h=function(e){var t=p(e),n=t.name;return i&&(n=i+"/"+t.name),n},f=function(e){return d.has(h(e))};return r.createElement("div",{style:Nr},r.createElement(k.HTMLTable,{className:"bp3-html-table-condensed bp3-interactive",style:xr},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Name"),r.createElement("th",null,"Last modified"),r.createElement("th",null,"Size"))),r.createElement("tbody",null,u&&u.map((function(e,t){return r.createElement("tr",{key:t,style:f(t)?Rr:Ar,onClick:function(e){return function(e,t,n){var r=p(t);if(!(!o&&r.isDir||o&&!r.isDir)){var i=h(t),l=new Set(d);l.has(i)?l.delete(i):(a&&n.ctrlKey||l.clear(),l.add(i)),s&&s(Array.from(l))}}(0,t,e)},onDoubleClick:function(){return function(e,t){l&&(p(t).isDir&&l(h(t)))}(0,t)}},r.createElement("td",null,function(e){var t=p(e);return r.createElement("div",{style:Dr},r.createElement(k.Icon,{style:Tr,icon:Object(Pr.h)(t)}),r.createElement("span",null,t.name))}(t)),r.createElement("td",null,function(e){return p(e).lastModified}(t)),r.createElement("td",null,function(e){var t=p(e);return r.createElement("div",{style:Lr},t.size)}(t)))})))))};var Vr=function(e){return e.rootNode.childNodes?null:r.createElement("div",{style:{width:"100%",height:"100%"}},r.createElement(k.Spinner,{size:32}))},Br={width:"100%",height:"100%",overflow:"auto",borderColor:k.Colors.DARK_GRAY2,borderStyle:"solid",borderWidth:1},Wr=function(e){var t=e.rootNode,n=e.selectedPath,a=e.onSelectedPathChange,o=e.expandedPaths,i=e.onExpandedPathsChange,l=e.showFiles;if(!t.childNodes)return r.createElement(Vr,{rootNode:t});var c=function(e,t,n,a){if(!e.childNodes)return[];return function e(t,n,a,o,i,l){o||(t=t.filter((function(e){return e.isDir})));return t.map((function(t){var c=n,s=!1;c&&Object(Pr.j)(c,i,t.name)?s=i===c.length-1:c=null;var u=a,d=!1;u?d=null!==(u=(u=u.filter((function(e){return Object(Pr.j)(e,i,t.name)}))).length>0?u:null):u=null;var p,h,f,m=l[0];return l[0]=m+1,t.childNodes&&(p=e(t.childNodes,c,u,o,i+1,l)),h=o?t.isDir&&(!p||Boolean(p.find((function(e){return e.nodeData.isDir})))):t.isDir&&(!p||p.length>0),"updating"===t.status?f=r.createElement(k.Spinner,{size:16}):"error"===t.status&&(f=r.createElement(k.Icon,{icon:"error",iconSize:16})),{id:m,icon:Object(Pr.h)(t),label:t.name,secondaryLabel:f,hasCaret:h,isSelected:s,isExpanded:d,childNodes:p,nodeData:t}}))}(e.childNodes,t?t.split("/"):[],n?n.map((function(e){return e.split("/")})):[],a,0,[0])}(t,n||null,o&&o.length>0?o:null,Boolean(l));return r.createElement("div",{style:Br},r.createElement(k.Tree,{contents:c,onNodeClick:function(e,t){if(a&&e.nodeData.isDir){var r=Ur(c,t);a(r!==n?r:null)}},onNodeExpand:function(e,t){if(i&&e.nodeData.isDir){var n=Ur(c,t);i(Object(Pr.b)(o||[],n))}},onNodeCollapse:function(e,t){if(i&&e.nodeData.isDir){var n=Ur(c,t);i(Object(Pr.k)(o||[],n))}}}))};function Ur(e,t){for(var n=null,a=e,r=0;r<t.length;r++){if(!a)throw new Error("internal error: missing childNodes at index ".concat(r," in node path ").concat(t.join()));var o=a[t[r]];null===n?n=o.nodeData.name:n+="/"+o.nodeData.name,a=o.childNodes}return n}var Fr={width:"52vw"},Gr={width:"100%",display:"flex",flexFlow:"column nowrap"},Yr={flexGrow:0,display:"flex",flexFlow:"row nowrap",marginBottom:6},Hr={height:"40vh",flexGrow:0},Kr={flexGrow:0,display:"flex",flexFlow:"row nowrap",alignItems:"center",marginTop:10},zr={flexGrow:1,marginLeft:10,overflow:"hidden"},qr=Object(a.a)(Object(a.a)({},zr),{},{color:"#ffaaaa"}),Jr={flexGrow:0,display:"flex",flexFlow:"row nowrap",marginBottom:6},Xr={flexGrow:1,backgroundColor:k.Colors.DARK_GRAY5,paddingLeft:10,paddingRight:10},Zr=Ir.a.ofType(),Qr=function(e){var t=e.isOpen,n=e.onClose,o=e.rootNode,i=e.updateFileNode,l=e.createFileNode,c=e.renameFileNode,s=e.deleteFileNodes,u=e.title,d=e.defaultPath,p=e.buttonLabel,h=e.filters,f=e.saveFile,b=e.openFile,v=e.openDirectory,y=e.multiSelections,g=e.showHiddenFiles,E=e.hostOS;if(f&&b||f&&v||f&&y)throw new Error("saveFile flag cannot be used with openFile, openDirectory, multiSelections flags");g&&console.warn("showHiddenFiles flag ignored (not implemented yet))");var O=d&&Object(Pr.f)(d,"",y,E)||[],_=[];O.forEach((function(e){_=Object(Pr.b)(_,Object(Yt.c)(e,E))}));var C=_.length>0?_[0]:null,w=C||"",S=r.useReducer((function(e,t){return Object(a.a)(Object(a.a)({},e),t)}),{selectedPaths:O,expandedPaths:_,selectedDirPath:C,currentDirPath:w}),j=Object(m.a)(S,2),I=j[0],P=j[1],D=r.useReducer((function(e,t){return Object(a.a)(Object(a.a)({},e),t)}),{value:d||"",isValid:!0}),T=Object(m.a)(D,2),L=T[0],A=T[1],R=r.useState(300),N=Object(m.a)(R,2),x=N[0],M=N[1],V=r.useState(h&&h.length?h[0]:null),B=Object(m.a)(V,2),W=B[0],U=B[1],F=r.useMemo((function(){return function(e){i(e,!1)}}),[i]);if(r.useEffect((function(){d&&F(d)}),[d,F]),r.useEffect((function(){I.expandedPaths.forEach((function(e){return F(e)}))}),[I.expandedPaths,F]),r.useEffect((function(){F(I.currentDirPath)}),[I.currentDirPath,F]),!t)return null;var G,Y=function(){return""!==I.currentDirPath},H=function(){return Boolean(l)},K=function(){return Boolean(c)&&1===I.selectedPaths.length},z=function(){return Boolean(s)&&I.selectedPaths.length>0},q=function(e){if(v)if(null!==e){var t=[e],n=Object(Pr.l)([Object(Yt.a)(e)],y);P({selectedDirPath:e,currentDirPath:e,selectedPaths:t}),A({value:n,isValid:!0})}else P({selectedDirPath:null,selectedPaths:[]}),A({value:"",isValid:!0});else P(null!==e?{selectedDirPath:e,currentDirPath:e}:{selectedDirPath:null})};return b||v||f||(G=function(){return null}),r.createElement(rt.a,{isOpen:t,title:u||to(f,v,b),confirmTitle:p||to(f,v,b),onConfirm:function(){n&&n({filePaths:I.selectedPaths.map((function(e){return Object(Pr.e)(e,E)})),canceled:!1})},onCancel:function(){n&&n({filePaths:[],canceled:!0})},canConfirm:function(){return I.selectedPaths.length>0&&L.isValid},style:Fr,renderActions:G},r.createElement("div",{style:Gr},r.createElement("div",{style:Jr},r.createElement(k.ButtonGroup,{minimal:!0},r.createElement(k.Button,{disabled:!0,onClick:function(){0},icon:"arrow-left"}),r.createElement(k.Button,{disabled:!0,onClick:function(){0},icon:"arrow-right"}),r.createElement(k.Button,{disabled:!Y(),onClick:function(){if(Y()){var e=Object(Yt.c)(I.currentDirPath);P({selectedDirPath:""!==e?e:null,currentDirPath:e})}},icon:"arrow-up"})),r.createElement("div",{style:Xr},r.createElement(k.Breadcrumbs,{className:"bp3-small",items:function(){if(""===I.currentDirPath)return[];var e=I.currentDirPath.split("/");return e.map((function(t,n){var a;if(n<e.length-1){var r=e.slice(0,n+1).join("/");a=function(){q(r)}}return{text:t,onClick:a}}))}()})),r.createElement(k.ButtonGroup,{minimal:!0},r.createElement(k.Button,{disabled:!0,onClick:function(){0},icon:"caret-down"}),r.createElement(k.Button,{onClick:function(){i(I.currentDirPath,!0)},icon:"refresh"}))),(Boolean(l)||Boolean(c)||Boolean(s))&&r.createElement("div",{style:Yr},r.createElement(k.ButtonGroup,{minimal:!0},Boolean(l)&&r.createElement(k.Tooltip,{content:H()?"Create new directory in ".concat(I.currentDirPath):null},r.createElement(k.Button,{disabled:!H(),onClick:function(){H()},icon:"folder-new",text:"Create Directory"})),Boolean(c)&&r.createElement(k.Tooltip,{content:K()?"Rename ".concat(I.selectedPaths[0]):null},r.createElement(k.Button,{disabled:!K(),onClick:function(){K()},icon:"edit",text:"Rename"})),Boolean(s)&&r.createElement(k.Tooltip,{content:z()?"Delete ".concat(I.selectedPaths[0])+(I.selectedPaths.length>0?", ...":""):null},r.createElement(k.Button,{disabled:!z(),onClick:function(){z()&&s(I.selectedPaths)},icon:"trash",text:"Delete Directory"})))),r.createElement("div",{style:Hr},r.createElement(ft,{dir:"hor",initialSize:x,onChange:function(e){M(e)}},r.createElement(Wr,{rootNode:o,selectedPath:I.selectedDirPath,onSelectedPathChange:q,expandedPaths:I.expandedPaths,onExpandedPathsChange:function(e){P({expandedPaths:e})}}),r.createElement(Mr,{rootNode:o,currentDirPath:I.currentDirPath,onCurrentDirPathChange:function(e){!v||b||y?P({expandedPaths:Object(Pr.b)(I.expandedPaths,e),selectedDirPath:e,currentDirPath:e}):(P({expandedPaths:Object(Pr.b)(I.expandedPaths,e),selectedDirPath:e,currentDirPath:e,selectedPaths:[e]}),A({value:Object(Pr.l)([Object(Yt.a)(e)],y),isValid:!0}))},selectedPaths:I.selectedPaths,onSelectedPathsChange:function(e){P({selectedPaths:e}),A({value:Object(Pr.l)(e.map((function(e){return Object(Yt.a)(e)})),y),isValid:!0})},fileFilter:W,multiSelections:y,openDirectory:v}))),r.createElement("div",{style:Kr},r.createElement("span",null,v&&!b?"Directory:":"Filename:"),r.createElement("input",{className:k.Classes.INPUT,style:L.isValid?zr:qr,type:"text",value:L.value,onChange:function(e){var t=e.target.value||"",n=!0,a=Object(Pr.f)(t,I.currentDirPath,y,E);if(a.length){var r=I.expandedPaths;a.forEach((function(e){var t=Object(Yt.c)(e);r=Object(Pr.b)(r,t)}));var i=a.length>0?Object(Yt.c)(a[0]):null;null!==i&&null===Object(Pr.g)(o,i)&&(i=null),null!==i?(P({selectedDirPath:i,currentDirPath:i,expandedPaths:r,selectedPaths:a}),(b||v)&&(n=!a.find((function(e){return null===Object(Pr.g)(o,e)})))):(P({selectedPaths:a,expandedPaths:r}),n=!1)}else P({selectedPaths:a});A({value:t,isValid:n})}}),r.createElement(k.ButtonGroup,null,r.createElement(k.Button,{disabled:!0,onClick:function(){0},icon:"caret-down",minimal:!0}),h&&r.createElement(Zr,{popoverProps:{minimal:!0},items:h,filterable:!1,itemRenderer:$r,onItemSelect:function(e){return U(e)}},r.createElement(k.Button,{text:eo(W),rightIcon:"caret-down"}))))))},$r=function(e,t){var n=t.modifiers,a=t.handleClick;return r.createElement(k.MenuItem,{active:n.active,disabled:n.disabled,key:e.name,text:e.name,label:"(".concat(e.extensions.map((function(e){return"*."+e})).join(", "),")"),onClick:a})};function eo(e){return e=e||Pr.a,"".concat(e.name," (").concat(e.extensions.map((function(e){return"*."+e})).join(", "),")")}function to(e,t,n){return e?"Save File":t&&!n?"Select Directory":"Open File"}var no=function(e){var t=new Set(e.properties);return r.createElement(Qr,Object.assign({},e,{saveFile:!1,openFile:t.has("openFile"),openDirectory:t.has("openDirectory"),multiSelections:t.has("multiSelections"),showHiddenFiles:t.has("showHiddenFiles")}))};var ao={updateFileNode:p.td},ro=Object(i.b)((function(e){return Object(a.a)(Object(a.a)({},e.control.directorySelectDialog.options),{},{isOpen:e.control.directorySelectDialog.isOpen,onClose:e.control.directorySelectDialog.onClose,rootNode:e.data.fsRootNode,hostOS:e.communication.webAPIServiceInfo.hostOS})}),ao)((function(e){return e.isOpen?r.createElement(no,e):null}));var oo={updateFileNode:p.td},io=Object(i.b)((function(e){return Object(a.a)(Object(a.a)({},e.control.fileOpenDialog.options),{},{isOpen:e.control.fileOpenDialog.isOpen,onClose:e.control.fileOpenDialog.onClose,rootNode:e.data.fsRootNode,hostOS:e.communication.webAPIServiceInfo.hostOS})}),oo)((function(e){return e.isOpen?r.createElement(no,e):null})),lo=function(e){var t=e.onClose,n=Object(yt.a)(e,["onClose"]),a=new Set(n.properties);return r.createElement(Qr,Object.assign({},n,{onClose:function(e){t({canceled:e.canceled,filePath:!e.canceled&&e.filePaths.length>0?e.filePaths[0]:null})},saveFile:!0,openFile:!1,openDirectory:!1,multiSelections:!1,showHiddenFiles:a.has("showHiddenFiles")}))};var co={updateFileNode:p.td},so=Object(i.b)((function(e){return Object(a.a)(Object(a.a)({},e.control.fileSaveDialog.options),{},{isOpen:e.control.fileSaveDialog.isOpen,onClose:e.control.fileSaveDialog.onClose,rootNode:e.data.fsRootNode,hostOS:e.communication.webAPIServiceInfo.hostOS})}),co)((function(e){return e.isOpen?r.createElement(lo,e):null}));var uo={updateFileNode:p.td},po=Object(i.b)((function(e){return Object(a.a)(Object(a.a)({},e.control.fileBrowseDialog.options),{},{isOpen:e.control.fileBrowseDialog.isOpen,onClose:e.control.fileBrowseDialog.onClose,rootNode:e.data.fsRootNode,hostOS:e.communication.webAPIServiceInfo.hostOS})}),uo)((function(e){var t=e.properties;if(t){var n=new Set(t);n.delete("openFile"),n.delete("openDirectory"),t=Array.from(n)}else t=[];return e.isOpen?r.createElement(no,Object.assign({title:"Browse Files"},e,{properties:t})):null})),ho={none:void 0,info:zt.a.INFO_SIGN,error:zt.a.ERROR,question:zt.a.CONFIRM,warning:zt.a.WARNING_SIGN},fo=function(e){var t=e.isOpen,n=e.onClose,a=e.type,o=e.title,i=e.message,l=e.detail,c=e.buttons,s=e.checkboxLabel,u=e.checkboxChecked,d=e.defaultId,p=e.cancelId,h=r.useState(Object(he.b)(u)&&u),f=Object(m.a)(h,2),b=f[0],v=f[1],y=Boolean(s);if(!t)return null;var g=function(){n&&n(null)};return r.createElement(rt.a,{isOpen:t,title:o,icon:ho[a],onCancel:g,renderActions:function(){return(c||["OK"]).map((function(e,t){var a=t===d?k.Intent.PRIMARY:k.Intent.NONE;return t===p?r.createElement(k.Button,{intent:a,onClick:g},e):r.createElement(k.Button,{intent:a,onClick:function(){return function(e){n&&n({buttonIndex:e,checkboxChecked:b})}(t)}},e)}))}},r.createElement("p",null,i),r.createElement("p",{className:"bp3-text-muted"},l),y&&r.createElement("p",null,r.createElement(k.Checkbox,{label:s,onChange:function(e){v(e.target.checked)}})))};var mo=Object(i.b)((function(e){return e.control.messageBox?Object(a.a)({isOpen:e.control.messageBox.isOpen,onClose:e.control.messageBox.onClose},e.control.messageBox.options):{isOpen:!1,message:""}}))((function(e){return r.createElement(fo,e)})),bo=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onTopPanelSelected=a.onTopPanelSelected.bind(Object(E.a)(a)),a.onBottomPanelSelected=a.onBottomPanelSelected.bind(Object(E.a)(a)),a.onTopPanelClose=a.onTopPanelClose.bind(Object(E.a)(a)),a.onBottomPanelClose=a.onBottomPanelClose.bind(Object(E.a)(a)),a.onVerSplitterPosChange=a.onVerSplitterPosChange.bind(Object(E.a)(a)),a.onHorSplitterPosChange=a.onHorSplitterPosChange.bind(Object(E.a)(a)),a.state=n.mapPropsToState(e),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState(n.mapPropsToState(e))}},{key:"onTopPanelSelected",value:function(e){var t=this,n=this.state.selectedTopPanelId===e;this.setState({selectedTopPanelId:n?null:e},(function(){t.props.onSelectedTopPanelChange&&t.props.onSelectedTopPanelChange(t.state.selectedTopPanelId)}))}},{key:"onBottomPanelSelected",value:function(e){var t=this,n=this.state.selectedBottomPanelId===e;this.setState({selectedBottomPanelId:n?null:e},(function(){t.props.onSelectedBottomPanelChange&&t.props.onSelectedBottomPanelChange(t.state.selectedBottomPanelId)}))}},{key:"onTopPanelClose",value:function(){this.onTopPanelSelected(null)}},{key:"onBottomPanelClose",value:function(){this.onBottomPanelSelected(null)}},{key:"onVerSplitterPosChange",value:function(e){var t=this.state.layout.verPos+e;this.setLayout(Object(a.a)(Object(a.a)({},this.state.layout),{},{verPos:t}))}},{key:"onHorSplitterPosChange",value:function(e){var t=this.state.layout.horPos;"left"===(this.props.position||"left")?t+=e:t-=e,this.setLayout(Object(a.a)(Object(a.a)({},this.state.layout),{},{horPos:t}))}},{key:"setLayout",value:function(e){var t=this;this.setState({layout:e},(function(){t.props.onLayoutChange&&t.props.onLayoutChange(e)}))}},{key:"getSelectedTopPanel",value:function(){return this.findPanel(this.state.selectedTopPanelId)}},{key:"getSelectedBottomPanel",value:function(){return this.findPanel(this.state.selectedBottomPanelId)}},{key:"findPanel",value:function(e){if(!e)return null;var t=null;return r.Children.forEach(this.props.children,(function(n){var a=n;a.props&&a.props.id===e&&(t=a)})),t}},{key:"render",value:function(){var e,t,n,a,o=r.createElement(Io,{panels:r.Children.toArray(this.props.children),position:this.props.position,selectedTopPanelId:this.state.selectedTopPanelId,selectedBottomPanelId:this.state.selectedBottomPanelId,onTopPanelSelected:this.onTopPanelSelected,onBottomPanelSelected:this.onBottomPanelSelected}),i=this.getSelectedTopPanel(),l=this.getSelectedBottomPanel(),c=this.state.layout.horPos,s="100%";if(i){i&&l&&(s=this.state.layout.verPos);var u={width:c,height:s};e=this.renderPanelPane(i,u,this.onTopPanelClose)}if(l){i&&l&&(s="calc(100% - ".concat(this.state.layout.verPos+4,"px)"));var d={width:c,height:s};t=this.renderPanelPane(l,d,this.onBottomPanelClose)}e&&t?n=this.renderTwoPanelsPane(e,t):e?n=e:t&&(n=t),n&&(a=this.renderResizablePanelPane(n));var p={display:"flex",flexFlow:"row nowrap",flex:"none",maxHeight:"100%"};return"left"===(this.props.position||"left")?r.createElement("div",{style:p},o,a):r.createElement("div",{style:p},a,o)}},{key:"renderPanelPane",value:function(e,t,n){return r.createElement(Po,{panel:e,onClose:n,position:this.props.position,style:t})}},{key:"renderTwoPanelsPane",value:function(e,t){var n=r.createElement(ht,{dir:"ver",onChange:this.onVerSplitterPosChange});return r.createElement("div",{style:{display:"flex",flexDirection:"column"}},e,n,t)}},{key:"renderResizablePanelPane",value:function(e){var t,o=this.props.undockedMode||!1,i=this.props.position||"left";o&&(t="left"===i?{position:"absolute",top:0,left:n.PANEL_BAR_SIZE,backgroundColor:Oo,zIndex:5}:{position:"absolute",top:0,right:n.PANEL_BAR_SIZE,backgroundColor:Oo,zIndex:5});var l=Object(a.a)({paddingTop:n.PANEL_PANE_PADDING,paddingLeft:"left"===i?n.PANEL_PANE_PADDING:0,paddingRight:"left"===i?0:n.PANEL_PANE_PADDING,flex:"auto",display:"flex",flexFlow:"row nowrap",maxHeight:"100%"},t),c=r.createElement(ht,{dir:"hor",onChange:this.onHorSplitterPosChange});return"left"===i?r.createElement("div",{style:l},e,c):r.createElement("div",{style:l},c,e)}}],[{key:"mapPropsToState",value:function(e){return{selectedTopPanelId:e.selectedTopPanelId,selectedBottomPanelId:e.selectedBottomPanelId,layout:e.layout}}}]),n}(r.PureComponent);function vo(e){var t=r.createElement(k.Icon,{icon:e.icon,className:"cate-panel-header-item"}),n=r.createElement("span",{className:"cate-panel-text cate-panel-header-item"},e.title.toUpperCase()),a=r.createElement(k.Icon,{icon:"cross",className:"cate-icon-small cate-panel-header-item",onClick:e.onClose});return r.createElement("div",{className:"cate-panel-header",style:{flex:"none"}},t,n,a)}bo.PANEL_ICON_SIZE=20,bo.PANEL_ICON_PADDING=8,bo.PANEL_BAR_SIZE=2*bo.PANEL_ICON_PADDING+bo.PANEL_ICON_SIZE,bo.PANEL_BAR_PADDING=8,bo.PANEL_PANE_PADDING=4,bo.PANEL_BODY_PADDING=2;var yo={padding:bo.PANEL_ICON_PADDING},go=Object(a.a)(Object(a.a)({},yo),{},{color:k.Colors.GRAY4}),Eo=Object(a.a)(Object(a.a)({},yo),{},{color:k.Colors.WHITE,backgroundColor:k.Colors.DARK_GRAY5}),Oo="rgba(57, 75, 89, 0.5)",_o={flex:"none",listStyleType:"none",padding:0,margin:0,border:"none"},Co={flex:"none",listStyleType:"none",padding:0,margin:0,border:"none"},ko={flex:"auto"},wo={display:"flex",flexDirection:"column",flex:"none",maxHeight:"100%",minWidth:bo.PANEL_BAR_SIZE,overflow:"hidden",backgroundColor:k.Colors.DARK_GRAY2,paddingTop:bo.PANEL_BAR_PADDING,paddingBottom:bo.PANEL_BAR_PADDING},So={textAlign:"center",verticalAlign:"middle"},jo={flex:1,padding:bo.PANEL_BODY_PADDING,overflow:"auto"};function Io(e){var t="left"===(e.position||"left")?k.PopoverPosition.RIGHT:k.PopoverPosition.LEFT,n=e.panels||[];function a(n,a){var o=n.props.id,i=n.props.title,l=n.props.icon,c=o===a?Eo:go,s=n.props.position||"top";return r.createElement("li",{key:o,onClick:function(){return"top"===s?e.onTopPanelSelected(o):e.onBottomPanelSelected(o)},style:c},r.createElement(k.Tooltip,{content:i,position:t,hoverOpenDelay:1500},r.createElement("span",{style:So},r.createElement(k.Icon,{icon:l,iconSize:bo.PANEL_ICON_SIZE}))))}var o,i=[],l=[],c=Object(W.a)(n);try{for(c.s();!(o=c.n()).done;){var s=o.value;if(s.props&&s.props.id)"top"===(s.props.position||"top")?i.push(a(s,e.selectedTopPanelId)):l.push(a(s,e.selectedBottomPanelId));else console.error("PanelBar children must be of type Panel")}}catch(u){c.e(u)}finally{c.f()}return r.createElement("div",{style:wo},r.createElement("ul",{style:_o},i),r.createElement("div",{style:ko}),r.createElement("ul",{style:Co},l))}function Po(e){var t=e.panel;if(!t||!t.props||!t.props.body)return null;var n=t.props.id,o=t.props.body,i=Object(a.a)({display:"flex",flexDirection:"column",alignItems:"stretch"},e.style);return r.createElement("div",{style:i},r.createElement(vo,{id:n,title:t.props.title,icon:t.props.icon,onClose:function(){return e.onClose(n)}}),r.createElement("div",{style:jo},o))}var Do=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return null}}]),n}(r.PureComponent);function To(e){return"layouts"in e}function Lo(e){return"viewIds"in e}function Ao(e,t){return function e(t,n,a){if(Lo(t))return t;if(a<n.length){de.a(To(t),"ViewSplitState expected");var r=t,o=n[a];return e(r.layouts[o],n,a+1)}return null}(e,t,0)}function Ro(e,t){if(Lo(e)){var n=e;return t&&t(n)?n:null}de.a(To(e),"ViewSplitState expected");var a=e;return Ro(a.layouts[0],t)||Ro(a.layouts[1],t)}function No(e,t){var n={before:[],after:[]};return function e(t,n,a){var r=t.viewIds;if(r)for(var o=null,i=0;i<r.length;i++){var l=r[i];if(l!==n){var c=i<r.length+1?r[i+1]:null;null!==c&&c===n||a.after.push(l),null!==o&&o===n||a.before.push(l)}o=l}var s=t.layouts;if(s){var u,d=Object(W.a)(s);try{for(d.s();!(u=d.n()).done;){var p=u.value;e(p,n,a)}}catch(h){d.e(h)}finally{d.f()}}}(e,t,n),n}function xo(e,t,n,r){return function e(t,n,r,o){if(To(t)){var i=t,l=i.layouts[0],c=i.layouts[1],s=e(l,n,r,o),u=e(c,n,r,o);return l===s&&c===u?i:null===s?(de.a(u),u):null===u?s:Object(a.a)(Object(a.a)({},i),{},{layouts:[s,u]})}var d=t,p=d.viewIds,h=d.selectedViewId,f=p.findIndex((function(e){return e===n}));if(f>=0){if((p=p.slice()).splice(f,1),0===p.length)return null;if(h===n&&p.length){var m=f<p.length?f:p.length-1;h=p[m]}}var b=p.findIndex((function(e){return e===o}));if(b>=0&&(p="before"===r?p.slice(0,b).concat([n].concat(p.slice(b))):p.slice(0,b+1).concat([n].concat(p.slice(b+1))),h=n),p!==d.viewIds)return{viewIds:p,selectedViewId:h};return t}(e,t,n,r)}function Mo(e,t,n){return function e(t,n,r){if(To(t)){var o,i=t,l=i.layouts[0],c=i.layouts[1],s=e(l,n,r);if(o=l===s?e(c,n,r):c,l===s&&c===o)return i;var u=[s,o];return Object(a.a)(Object(a.a)({},i),{},{layouts:u})}var d=t,p=d.viewIds,h=p.findIndex((function(e){return e===n}));if(h<0)return d;var f=h+1;return{viewIds:p.slice(0,f).concat([r].concat(p.slice(f))),selectedViewId:r}}(e,t,n)}function Vo(e,t){return function e(t,n){if(To(t)){var r=t,o=r.layouts[0],i=[e(o,n),r.layouts[1]];return Object(a.a)(Object(a.a)({},r),{},{layouts:i})}return{viewIds:t.viewIds.concat([n]),selectedViewId:n}}(e,t)}function Bo(e,t,n,r){return function e(t,n,r,o,i){if(de.a(i<=n.length,"illegal path index"),i<n.length){de.a(To(t),"ViewSplitState expected");var l,c=t,s=n.charCodeAt(i)-48,u=c.layouts[s],d=e(u,n,r,o,i+1);return l=0===s?[d,c.layouts[1]]:[c.layouts[0],d],Object(a.a)(Object(a.a)({},c),{},{layouts:l})}de.a(Lo(t),"ViewPanelState expected");var p=t,h=p.viewIds;de.a(h.length>1,"ViewPanelState must have more than one view to be split");var f=p.selectedViewId,m=h.findIndex((function(e){return e===f}));m===h.length-1&&(m-=1),de.a(m>=0);var b=h.slice(0,m+1),v=h.slice(m+1);return{dir:r,pos:o,layouts:[{viewIds:b,selectedViewId:b[b.length-1]},{viewIds:v,selectedViewId:v[0]}]}}(e,t,n,r,0)}function Wo(e,t,n){return function e(t,n,r,o){if(de.a(o<=n.length,"illegal path index"),o<n.length){de.a(To(t),"ViewSplitState expected");var i,l=t,c=n.charCodeAt(o)-48,s=l.layouts[c],u=e(s,n,r,o+1);return i=0===c?[u,l.layouts[1]]:[l.layouts[0],u],Object(a.a)(Object(a.a)({},l),{},{layouts:i})}de.a(To(t),"ViewSplitState expected");var d=t;return Object(a.a)(Object(a.a)({},d),{},{pos:d.pos+r})}(e,t,n,0)}function Uo(e,t,n){return function e(t,n,r,o){if(de.a(o<=n.length,"illegal path index"),o<n.length){de.a(To(t),"ViewSplitState expected");var i,l=t,c=n.charCodeAt(o)-48,s=l.layouts[c],u=e(s,n,r,o+1);return s===u?l:(i=0===c?[u,l.layouts[1]]:[l.layouts[0],u],Object(a.a)(Object(a.a)({},l),{},{layouts:i}))}de.a(Lo(t),"ViewPanelState expected");var d=t,p=d.viewIds;return r===d.selectedViewId?d:(de.a(p.indexOf(r)>=0,"viewId not found"),{viewIds:p,selectedViewId:r})}(e,t,n,0)}function Fo(e,t,n){return Ho(e,t,n,0)}function Go(e,t){for(;;){var n=e.findIndex((function(e){return e.id===t}));if(!(n>=0))break;e=e.slice(0,n).concat(e.slice(n+1))}return e}function Yo(e,t){if(To(e)){var n=e,r=n.layouts[0],o=n.layouts[1],i=Yo(r,t),l=Yo(o,t);if(r!==i||o!==l)return Object(a.a)(Object(a.a)({},n),{},{layouts:[i,l]})}else{var c=e;if(t!==c.selectedViewId){var s=c.viewIds;if(s.findIndex((function(e){return e===t}))>=0)return{viewIds:s,selectedViewId:t}}}return e}function Ho(e,t,n,r){if(de.a(r<=t.length,"illegal path index"),r<t.length){de.a(To(e),"ViewSplitState expected");var o,i=e,l=t.charCodeAt(r)-48,c=i.layouts[l],s=Ho(c,t,n,r+1);return c===s?i:Lo(s)&&0===s.viewIds.length?0===l?i.layouts[1]:i.layouts[0]:(o=0===l?[s,i.layouts[1]]:[i.layouts[0],s],Object(a.a)(Object(a.a)({},i),{},{layouts:o}))}de.a(Lo(e),"ViewPanelState expected");var u=e;if(n){var d=u.viewIds,p=d.indexOf(n);if(p<0)return u;d=d.slice(0,p).concat(d.slice(p+1));var h=u.selectedViewId;return h===n&&(h=p>0?d[p-1]:p<d.length?d[p]:null),{viewIds:d,selectedViewId:h}}return{viewIds:[],selectedViewId:null}}var Ko=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).viewMap=void 0,a.viewMap=n.createViewMap(a.props.views),a}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.viewMap=n.createViewMap(e.views)}},{key:"render",value:function(){return this.props.views.length?To(this.props.viewLayout)?this.renderViewSplit(this.props.viewLayout,""):this.renderViewPanel(this.props.viewLayout,""):this.renderNoViews()}},{key:"renderNoViews",value:function(){return r.createElement("div",{style:n.NO_VIEW_CONTAINER_STYLE},r.createElement(k.NonIdealState,{title:"No views",description:this.props.noViewsDescription,action:this.props.noViewsAction,icon:this.props.noViewsVisual}))}},{key:"renderViewSplit",value:function(e,t){var a,o,i=this,l=e.layouts[0];a=To(l)?this.renderViewSplit(l,t+"0"):this.renderViewPanel(l,t+"0");var c=e.layouts[1];if(o=To(c)?this.renderViewSplit(c,t+"1"):this.renderViewPanel(c,t+"1"),a&&o){var s,u,d;if("hor"===e.dir){s=n.HOR_SPLIT_CONTAINER_STYLE;var p=e.pos;u={flex:"none",width:p,height:"100%"},d={flex:"auto",width:"calc(100% - ".concat(p+4,"px)"),height:"100%"}}else{s=n.VER_SPLIT_CONTAINER_STYLE;var h=e.pos;u={flex:"none",width:"100%",height:h},d={flex:"auto",width:"100%",height:"calc(100% - ".concat(h+4,"px)")}}return r.createElement("div",{style:s},r.createElement("div",{style:u},a),r.createElement(ht,{dir:e.dir,onChange:function(e){return i.props.onChangeViewSplitPos(t,e)}}),r.createElement("div",{style:d},o))}return a||(o||null)}},{key:"renderViewPanel",value:function(e,t){return r.createElement(zo,{viewLayout:this.props.viewLayout,viewRenderMap:this.props.viewRenderMap,viewMap:this.viewMap,activeView:this.props.activeView,viewPath:t,viewIds:e.viewIds,selectedViewId:e.selectedViewId,onSelectView:this.props.onSelectView,onCloseView:this.props.onCloseView,onCloseAllViews:this.props.onCloseAllViews,onMoveView:this.props.onMoveView,onSplitViewPanel:this.props.onSplitViewPanel})}}],[{key:"createViewMap",value:function(e){var t={};return e.forEach((function(e){t[e.id]=e})),t}}]),n}(r.PureComponent);Ko.NO_VIEW_CONTAINER_STYLE={width:"100%",height:"100%",flex:"auto"},Ko.HOR_SPLIT_CONTAINER_STYLE={width:"100%",height:"100%",display:"flex",flexFlow:"row nowrap",flex:"auto",boxSizing:"border-box"},Ko.VER_SPLIT_CONTAINER_STYLE={width:"100%",height:"100%",display:"flex",flexFlow:"column nowrap",flex:"auto",boxSizing:"border-box"};var zo=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).contentElement=void 0,a.onSplitHor=a.onSplitHor.bind(Object(E.a)(a)),a.onSplitVer=a.onSplitVer.bind(Object(E.a)(a)),a.onContentDivRef=a.onContentDivRef.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onSplitHor",value:function(){this.props.onSplitViewPanel(this.props.viewPath,"hor",.5*this.contentElement.clientWidth)}},{key:"onSplitVer",value:function(){this.props.onSplitViewPanel(this.props.viewPath,"ver",.5*this.contentElement.clientHeight)}},{key:"onContentDivRef",value:function(e){this.contentElement=e}},{key:"render",value:function(){var e=this,t=this.props.viewIds;if(!t||!t.length)return null;var a,o=this.props.selectedViewId,i=[],l=null;t.forEach((function(t){var n=e.props.viewMap[t];n&&(o&&t===o&&(l=n),i.push(n))}));for(var c=[],s=function(t){var o=i[t],s=o.id,u=o.title,d=o.icon,p=void 0,h=void 0,f=void 0;if(l&&l.id===s){var m=e.props.viewRenderMap[o.type];a=m(o),p=n.TAB_STYLE_SELECTED,h=l===e.props.activeView?n.TITLE_STYLE_ACTIVE:n.TITLE_STYLE_SELECTED,f=n.CLOSE_ICON_STYLE_SELECTED}else p=n.TAB_STYLE_NORMAL,h=n.TITLE_STYLE_NORMAL,f=n.CLOSE_ICON_STYLE_NORMAL;var b=function(){e.props.onSelectView(e.props.viewPath,s)},v=void 0;d&&""!==d&&(v=r.createElement(k.Icon,{icon:d,style:h,onClick:b})),c.push(r.createElement("div",{key:s,style:p},v,r.createElement("span",{style:h,onClick:b},u),r.createElement(k.Icon,{style:f,icon:"cross",onClick:function(){e.props.onCloseView(e.props.viewPath,s)}})))},u=0;u<i.length;u++)s(u);var d,p,h,f=r.createElement("div",{style:n.TABS_STYLE},c),m=r.createElement("div",{key:"spacer",style:n.SPACER_STYLE}),b=n.MENU_ICON_STYLE;if(i.length>1&&(d=r.createElement(k.Icon,{key:"splitHor",style:b,icon:"add-column-right",onClick:this.onSplitHor}),p=r.createElement(k.Icon,{key:"splitVer",style:b,icon:"add-row-bottom",onClick:this.onSplitVer})),l){var v,y,g=No(this.props.viewLayout,o),E=this.props.viewMap,O=g.before.map((function(t){var n=E[t];return r.createElement(k.MenuItem,{key:t,onClick:function(){return e.props.onMoveView(o,"before",n.id)},text:n.title})})),_=g.after.map((function(t){var n=E[t];return r.createElement(k.MenuItem,{key:t,onClick:function(){return e.props.onMoveView(o,"after",n.id)},text:n.title})}));if(O.length&&(v=r.createElement(k.MenuItem,{key:"before",text:"Move Before"},O)),_.length&&(y=r.createElement(k.MenuItem,{key:"after",text:"Move After"},_)),v||y){var C=r.createElement(k.Menu,null,v,y);h=r.createElement(k.Popover,{content:C,position:k.PopoverPosition.BOTTOM},r.createElement(k.Icon,{key:"more",style:b,icon:"more"}))}}var w=r.createElement("div",{style:n.MENU_STYLE},d,p,h);return r.createElement("div",{style:n.CONTAINER_STYLE},r.createElement("div",{style:n.VIEW_HEADER_STYLE},f,m,w),r.createElement("div",{style:n.VIEW_BODY_STYLE,ref:this.onContentDivRef},a))}}]),n}(r.PureComponent);zo.SELECTED_BG_COLOR=k.Colors.DARK_GRAY1,zo.TAB_STYLE_SELECTED={padding:2,flex:"none",color:k.Colors.WHITE,backgroundColor:zo.SELECTED_BG_COLOR},zo.TAB_STYLE_NORMAL={padding:2,color:k.Colors.LIGHT_GRAY1},zo.TITLE_STYLE_BASE={paddingLeft:4,paddingRight:4},zo.TITLE_STYLE_ACTIVE=Object(a.a)(Object(a.a)({},zo.TITLE_STYLE_BASE),{},{color:k.Colors.BLUE5}),zo.TITLE_STYLE_SELECTED=zo.TITLE_STYLE_BASE,zo.TITLE_STYLE_NORMAL=zo.TITLE_STYLE_BASE,zo.CLOSE_ICON_STYLE_SELECTED={marginLeft:6,fontSize:12},zo.CLOSE_ICON_STYLE_NORMAL={marginLeft:6,fontSize:12},zo.MENU_ICON_STYLE={color:k.Colors.GRAY5,marginLeft:5,fontSize:12},zo.TABS_STYLE={flex:"none",display:"flex",flexDirection:"row"},zo.SPACER_STYLE={flex:"auto"},zo.MENU_STYLE={flex:"none",height:"100%"},zo.VIEW_HEADER_STYLE={display:"flex",flexDirection:"row",flex:"none",width:"100%",marginTop:2,borderBottomStyle:"solid",borderBottomWidth:2,borderBottomColor:zo.SELECTED_BG_COLOR,boxSizing:"border-box",overflow:"hidden"},zo.VIEW_BODY_STYLE={display:"flex",flexDirection:"column",flex:"auto",width:"100%",height:"100%",overflow:"hidden"},zo.CONTAINER_STYLE={display:"flex",flexDirection:"column",width:"100%",height:"100%",overflow:"hidden"};var qo=n(428);var Jo={wordBreak:"break-all"},Xo=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).renderBody=a.renderBody.bind(Object(E.a)(a)),a.handleConfirm=a.handleConfirm.bind(Object(E.a)(a)),a.handleCancel=a.handleCancel.bind(Object(E.a)(a)),a.handleCopyReport=a.handleCopyReport.bind(Object(E.a)(a)),a.state={copyReport:!1},a}return Object(g.a)(n,[{key:"handleConfirm",value:function(){if(this.state.copyReport){var e=this.props.jobTitle,t=this.props.jobFailure,a="Job: ".concat(e,"\nMessage: ").concat(t.message,"\n");a+="Code: ".concat(t.code,"\n"),t.data&&(t.data.method&&(a+="Method: ".concat(t.data.method,"\n")),t.data.exception&&(a+="Exception: ".concat(t.data.exception,"\n")),t.data.traceback&&(a+="\n".concat(t.data.traceback,"\n"))),p.Lb(a)}this.props.dispatch(p.Tb(n.DIALOG_ID))}},{key:"handleCancel",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID))}},{key:"handleCopyReport",value:function(e){this.setState({copyReport:e.target.checked})}},{key:"render",value:function(){if(!this.props.isOpen||!this.props.jobFailure)return null;var e=Object(Xa.l)(this.props.jobFailure);return r.createElement(rt.a,{isOpen:this.props.isOpen,icon:"error",title:e,onConfirm:this.handleConfirm,onCancel:this.handleCancel,noCancelButton:!0,renderBody:this.renderBody,style:n.DIALOG_STYLE})}},{key:"renderBody",value:function(){if(!this.props.isOpen)return null;var e=this.props.jobFailure.message;e||(e="An unknown error occurred (code ".concat(this.props.jobFailure.code,")."));var t,n,a=r.createElement("div",{style:Jo},r.createElement("p",null,"Oops, Cate couldn't carry out the request"),r.createElement("em",null,r.createElement("p",{className:"user-selectable"},this.props.jobTitle)),r.createElement("div",null,"Reason:"),r.createElement("div",{className:"user-selectable"},e));!Object(Xa.n)(this.props.jobFailure)&&this.props.jobFailure.data&&this.props.jobFailure.data.traceback&&(t=r.createElement(ka,{details:this.props.jobFailure.data.traceback,width:"36em"})),Object(Xa.m)(this.props.jobFailure)&&(n=r.createElement("div",{style:{marginTop:"1em"}},r.createElement("span",{className:"bp3-text-muted"},"Please consider reporting this issue in Cate's ",r.createElement("a",{href:"https://github.com/CCI-Tools/cate/issues",target:"_blank",rel:"noopener noreferrer"},"issue tracker"),"."),r.createElement(k.Checkbox,{label:"Copy error report to clipboard",checked:this.state.copyReport,onChange:this.handleCopyReport})));var o,i=Object(Xa.j)(this.props.jobFailure);return o=Object(Xa.n)(this.props.jobFailure)?k.Intent.PRIMARY:k.Intent.WARNING,r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{fontSize:"4em",flex:"0 1 1em"}},r.createElement(k.Icon,{icon:i,intent:o,iconSize:48})),r.createElement("div",{style:{flex:"1 1 90%",marginLeft:"1em"}},a,t,n))}}]),n}(r.Component);Xo.DIALOG_ID="jobFailureDialog",Xo.DIALOG_STYLE={width:"600px"};var Zo=Object(i.b)((function(e){var t=F.x(Xo.DIALOG_ID)(e);return{isOpen:t.isOpen,jobTitle:t.jobTitle,jobFailure:t.jobFailure}}))(Xo),Qo=n(90),$o=n(223),ei={width:"100%",marginBottom:"2em",display:"flex",flexGrow:1},ti={flex:"none"};var ni=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var r;return Object(y.a)(this,n),(r=t.call(this,e)).handleOpenFilesOnClose=function(e){e.canceled||r.setState(Object(a.a)(Object(a.a)({},r.state),{},{filePaths:e.filePaths}))},r.handleOpenFilesOpen=function(){r.props.dispatch(Object(p.gd)({title:"Select Files",properties:["openFile","multiSelections"]},r.handleOpenFilesOnClose))},r.state={filePaths:[]},r.onCancel=r.onCancel.bind(Object(E.a)(r)),r.onConfirm=r.onConfirm.bind(Object(E.a)(r)),r.canConfirm=r.canConfirm.bind(Object(E.a)(r)),r.renderBody=r.renderBody.bind(Object(E.a)(r)),r}return Object(g.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({filePaths:[]})}},{key:"onCancel",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID))}},{key:"canConfirm",value:function(){return this.state.filePaths.length>0}},{key:"onConfirm",value:function(){this.props.dispatch(p.Tb(n.DIALOG_ID,this.state)),this.props.dispatch(p.Pb(this.state.filePaths))}},{key:"render",value:function(){var e=this.props.isOpen;return e?r.createElement(rt.a,{isOpen:e,title:"Download Files",icon:"download",confirmTitle:"Download",confirmIconName:"download",confirmTooltip:"Download files.",onCancel:this.onCancel,canConfirm:this.canConfirm,onConfirm:this.onConfirm,renderBody:this.renderBody}):null}},{key:"renderBody",value:function(){if(!this.state.filePaths)return null;var e=this.state.filePaths.map((function(e){return r.createElement("li",{key:e},e)}));return r.createElement("div",null,"File download:",r.createElement(k.ControlGroup,{style:ei,fill:!0},r.createElement(k.AnchorButton,{intent:k.Intent.PRIMARY,style:ti,onClick:this.handleOpenFilesOpen},"Select Remote Files...")),r.createElement("aside",null,e.length>0?r.createElement("h4",null,"Files"):"",r.createElement("ul",null,e)))}}]),n}(r.Component);ni.DIALOG_ID="fileDownloadDialog";var ai=Object(i.b)((function(e){return{isOpen:F.x(ni.DIALOG_ID)(e).isOpen,dialogId:"fileDownloadDialog"}}))(ni);var ri={world:function(e){return r.createElement(Ke,{view:e})},figure:function(e){return r.createElement(at,{view:e})},animation:function(e){return r.createElement(qo.a,{view:e})},table:function(e){return r.createElement(pt,{view:e})}};var oi={display:"flex",flexFlow:"column nowrap",width:"100%",height:"100%",overflow:"hidden"},ii={display:"flex",flexFlow:"row nowrap",flex:"auto",height:"100%",overflow:"hidden"},li=Object(i.b)((function(e){return{forceAppBar:e.session.forceAppBar,fileSystemAPI:F.B(e),appServiceMode:e.communication.userProfile?"cloud":"local",appServiceURL:e.communication.webAPIServiceURL,appServiceHostOS:e.communication.webAPIServiceInfo&&e.communication.webAPIServiceInfo.hostOS,appServiceVersion:e.communication.webAPIServiceInfo&&e.communication.webAPIServiceInfo.version}}))((function(e){var t,n=e.forceAppBar,a=e.fileSystemAPI,o=e.appServiceMode,i=e.appServiceURL,l=e.appServiceHostOS,c=e.appServiceVersion,s=e.dispatch,u=Object(C.a)().trackPageView;return r.useEffect((function(){var e=[{id:1,value:o},{id:2,value:i},{id:3,value:l},{id:4,value:c}];console.log("Tracking:",e),u({customDimensions:e})}),[u,o,i,l,c]),r.useEffect((function(){s(p.Wb())}),[s]),Object(S.a)()&&!n||(t=r.createElement(R,null)),r.createElement("div",{className:"bp3-dark",style:oi},r.createElement(w,null),r.createElement(ja,null),t,r.createElement("div",{style:ii},r.createElement(si,null),r.createElement(hi,null),r.createElement(di,null)),r.createElement(cr,null),r.createElement(jr,null),r.createElement(Er,null),r.createElement($o.b,null),r.createElement(ai,null),r.createElement(Or,null),r.createElement(it,null),r.createElement(V.c,{dialogId:V.b}),r.createElement(V.c,{dialogId:V.a}),r.createElement(la,{id:"newCtxOperationStepDialog"}),r.createElement(Zo,null),!Qo.a.isNativeUI&&null!==a&&r.createElement(ro,null),!Qo.a.isNativeUI&&null!==a&&r.createElement(io,null),!Qo.a.isNativeUI&&null!==a&&r.createElement(so,null),!Qo.a.isNativeUI&&null!==a&&r.createElement(po,null),!Qo.a.isNativeUI&&r.createElement(mo,null))}));var ci=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onLeftPanelContainerLayoutChange=a.onLeftPanelContainerLayoutChange.bind(Object(E.a)(a)),a.onRightPanelContainerLayoutChange=a.onRightPanelContainerLayoutChange.bind(Object(E.a)(a)),a.onSelectedLeftTopPanelChange=a.onSelectedLeftTopPanelChange.bind(Object(E.a)(a)),a.onSelectedLeftBottomPanelChange=a.onSelectedLeftBottomPanelChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onLeftPanelContainerLayoutChange",value:function(e){this.props.dispatch(p.Gc(e))}},{key:"onRightPanelContainerLayoutChange",value:function(e){this.props.dispatch(p.Jc(e))}},{key:"onSelectedLeftTopPanelChange",value:function(e){this.props.dispatch(p.Oc(e))}},{key:"onSelectedLeftBottomPanelChange",value:function(e){this.props.dispatch(p.Nc(e))}},{key:"render",value:function(){return r.createElement(bo,{position:"left",undockedMode:this.props.panelContainerUndockedMode,layout:this.props.leftPanelContainerLayout,onLayoutChange:this.onLeftPanelContainerLayoutChange,selectedTopPanelId:this.props.selectedLeftTopPanelId,selectedBottomPanelId:this.props.selectedLeftBottomPanelId,onSelectedTopPanelChange:this.onSelectedLeftTopPanelChange,onSelectedBottomPanelChange:this.onSelectedLeftBottomPanelChange},r.createElement(Do,{id:"dataSources",position:"top",icon:"database",title:"Data Sources",body:r.createElement(ya,null)}),r.createElement(Do,{id:"operations",position:"bottom",icon:"function",title:"Operations",body:r.createElement(Oa,null)}))}}]),n}(r.PureComponent),si=Object(i.b)((function(e){return{panelContainerUndockedMode:F.V(e),leftPanelContainerLayout:F.M(e),selectedLeftTopPanelId:F.ub(e),selectedLeftBottomPanelId:F.tb(e)}}))(ci);var ui=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onRightPanelContainerLayoutChange=a.onRightPanelContainerLayoutChange.bind(Object(E.a)(a)),a.onSelectedRightTopPanelChange=a.onSelectedRightTopPanelChange.bind(Object(E.a)(a)),a.onSelectedRightBottomPanelChange=a.onSelectedRightBottomPanelChange.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onRightPanelContainerLayoutChange",value:function(e){this.props.dispatch(p.Jc(e))}},{key:"onSelectedRightTopPanelChange",value:function(e){this.props.dispatch(p.Sc(e))}},{key:"onSelectedRightBottomPanelChange",value:function(e){this.props.dispatch(p.Rc(e))}},{key:"render",value:function(){return r.createElement(bo,{position:"right",undockedMode:this.props.panelContainerUndockedMode,layout:this.props.rightPanelContainerLayout,onLayoutChange:this.onRightPanelContainerLayoutChange,selectedTopPanelId:this.props.selectedRightTopPanelId,selectedBottomPanelId:this.props.selectedRightBottomPanelId,onSelectedTopPanelChange:this.onSelectedRightTopPanelChange,onSelectedBottomPanelChange:this.onSelectedRightBottomPanelChange},r.createElement(Do,{id:"workspace",position:"top",icon:"flows",title:"Workspace",body:r.createElement(Ma,null)}),r.createElement(Do,{id:"layers",position:"top",icon:"layers",title:"Layers",body:r.createElement(dr,null)}),r.createElement(Do,{id:"placemarks",position:"top",icon:"map-marker",title:"Places",body:r.createElement(Ka,null)}),r.createElement(Do,{id:"variables",position:"bottom",icon:"variable",title:"Variables",body:r.createElement(Wa,null)}),r.createElement(Do,{id:"style",position:"bottom",icon:"style",title:"Styles",body:r.createElement(vr,null)}),r.createElement(Do,{id:"view",position:"bottom",icon:"eye-open",title:"View",body:r.createElement(Ja,null)}),r.createElement(Do,{id:"tasks",position:"bottom",icon:"play",title:"Tasks",body:r.createElement(tr,null)}))}}]),n}(r.PureComponent),di=Object(i.b)((function(e){return{panelContainerUndockedMode:F.V(e),rightPanelContainerLayout:F.cb(e),selectedRightTopPanelId:F.Fb(e),selectedRightBottomPanelId:F.Eb(e)}}))(ui);var pi=function(e){Object(O.a)(n,e);var t=Object(_.a)(n);function n(e){var a;return Object(y.a)(this,n),(a=t.call(this,e)).onSelectView=a.onSelectView.bind(Object(E.a)(a)),a.onCloseView=a.onCloseView.bind(Object(E.a)(a)),a.onCloseAllViews=a.onCloseAllViews.bind(Object(E.a)(a)),a.onMoveView=a.onMoveView.bind(Object(E.a)(a)),a.onChangeViewSplitPos=a.onChangeViewSplitPos.bind(Object(E.a)(a)),a.onSplitViewPanel=a.onSplitViewPanel.bind(Object(E.a)(a)),a}return Object(g.a)(n,[{key:"onSelectView",value:function(e,t){this.props.dispatch(p.yc(e,t))}},{key:"onCloseView",value:function(e,t){this.props.dispatch(p.Ib(e,t))}},{key:"onCloseAllViews",value:function(e){this.props.dispatch(p.Hb(e))}},{key:"onMoveView",value:function(e,t,n){this.props.dispatch(p.hc(e,t,n))}},{key:"onSplitViewPanel",value:function(e,t,n){this.props.dispatch(p.qd(e,t,n))}},{key:"onChangeViewSplitPos",value:function(e,t){this.props.dispatch(p.Fb(e,t))}},{key:"render",value:function(){return r.createElement("div",{style:n.DIV_STYLE},r.createElement(Ko,{viewRenderMap:ri,viewLayout:this.props.viewLayout,views:this.props.views,activeView:this.props.activeView,noViewsDescription:"You can create new views from the VIEW panel.",noViewsVisual:"eye-open",onSelectView:this.onSelectView,onCloseView:this.onCloseView,onCloseAllViews:this.onCloseAllViews,onMoveView:this.onMoveView,onChangeViewSplitPos:this.onChangeViewSplitPos,onSplitViewPanel:this.onSplitViewPanel}))}}]),n}(r.PureComponent);pi.DIV_STYLE={flex:"auto",height:"100%",overflow:"hidden"};var hi=Object(i.b)((function(e){return{viewLayout:F.cc(e),views:F.dc(e),activeView:F.e(e)}}))(pi);var fi=Object(i.b)((function(e){return{trackingConsentObtained:e.session.trackingConsentObtained}}))((function(e){var t=e.trackingConsentObtained,n=r.useState(null),a=Object(m.a)(n,2),o=a[0],i=a[1];return r.useEffect((function(){if(null===o){var e=Object(b.a)({urlBase:"https://matomo-ext.esa.int/",siteId:8,disabled:!t,heartBeat:{active:!0,seconds:10},linkTracking:!1,configurations:{disableCookies:!t,setSecureCookie:!0,setRequestMethod:"POST"}});i(e)}}),[t,o]),r.createElement(v.a,{value:o},r.createElement(li,null))}));var mi=Object(i.b)((function(e){return{cookieConsentObtained:e.session.cookieConsentObtained}}))((function(e){var t=e.cookieConsentObtained,n=e.dispatch,a=Object(d.b)(),o=Object(m.a)(a,2),i=o[0],l=o[1];return r.useEffect((function(){t&&n(l?p.Yb(i):p.ad("login"))}),[n,i,l,t]),r.createElement(fi,null)}));var bi=Object(i.b)((function(e){return{cookieConsentObtained:e.session.cookieConsentObtained}}))((function(e){var t=e.cookieConsentObtained,n=e.dispatch,a=new URLSearchParams(Object(f.h)().search),o=r.useState(!1),i=Object(m.a)(o,2),l=i[0],c=i[1];return r.useEffect((function(){if(!l&&t){var e=a.get("serviceUrl");null!==e?n(p.Kb(e)):(Object(wa.a)({type:"error",text:'Missing query parameter "serviceUrl"'}),n(p.ad(null))),c(!0)}}),[n,l,c,a,t]),r.createElement(fi,null)})),vi=n(175),yi={expires:365};function gi(e){vi.set("cookieConsentObtained","1",yi),vi.set("trackingConsentObtained",e?"1":"0",yi)}var Ei={dataStores:null,operations:null,workspace:null,colorMaps:null,baseMaps:Ae.b,fsRootNode:{name:"",isDir:!0,lastModified:"",size:0},workspaceNames:null,hasWebGL:Object(Ae.R)()},Oi=Object(Ae.fb)(),_i={selectedWorkflowStepId:null,selectedWorkspaceResourceName:null,selectedVariableName:null,dialogs:{},directorySelectDialog:{onClose:function(){}},fileOpenDialog:{onClose:function(){}},fileSaveDialog:{onClose:function(){}},fileBrowseDialog:{onClose:function(){}},messageBox:{},selectedCtxOperationName:null,views:[Oi],viewLayout:{viewIds:[Oi.id],selectedViewId:Oi.id},activeViewId:Oi.id,newPlacemarkToolType:"NoTool",entityUpdateCount:0,pwaInstallPromotionVisible:!1,pwaDisplayMode:"browser"},Ci={reopenLastWorkspace:!1,lastWorkspacePath:null,autoUpdateSoftware:!0,autoShowNewFigures:!0,offlineMode:!1,showSelectedVariableLayer:!0,savedLayers:{},selectedDataStoreId:null,selectedDataSourceId:null,dataSourceFilterExpr:"",selectedOperationName:null,operationFilterTags:[],operationFilterExpr:"",dataSourceListHeight:200,showDataSourceDetails:!0,resourceListHeight:100,showResourceDetails:!0,workflowStepListHeight:100,showWorkflowStepDetails:!0,operationListHeight:200,showOperationDetails:!0,variableListHeight:200,showVariableDetails:!0,layerListHeight:160,showLayerDetails:!0,lastBaseMapId:Ae.e,panelContainerUndockedMode:!1,leftPanelContainerLayout:{horPos:300,verPos:400},rightPanelContainerLayout:{horPos:300,verPos:400},selectedLeftTopPanelId:"dataSources",selectedLeftBottomPanelId:"operations",selectedRightTopPanelId:"workspace",selectedRightBottomPanelId:"variables",placemarkCollection:{type:"FeatureCollection",features:[]},selectedPlacemarkId:null,placemarkListHeight:160,showPlacemarkDetails:!0,defaultPlacemarkStyle:Object(a.a)({},Ae.g.style),workspacePanelMode:"steps",showDataStoreDescription:!1,showDataStoreNotices:!0,showDataSourceIDs:!0,showAllDataSources:!1,showLayerTextOverlay:!0,debugWorldView:!1,styleContext:U.d,backendConfig:{dataStoresPath:null,useWorkspaceImageryCache:!1,resourceNamePattern:"res_{index}",proxyUrl:null},cookieConsentObtained:"1"===vi.get("cookieConsentObtained"),trackingConsentObtained:"1"===vi.get("trackingConsentObtained")},ki={webAPIServiceURL:"http://localhost:9090",webAPIStatus:null,webAPIServiceInfo:null,webAPIClient:null,hubStatus:null,userProfile:null,tasks:{}},wi={globeMousePosition:null,globeViewPosition:null,positionData:null},Si=n(429),ji=n.n(Si),Ii={display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},Pi={display:"flex",flexFlow:"column nowrap",alignItems:"stretch"},Di={marginTop:4,textAlign:"center"};var Ti=Object(i.b)((function(e){var t=e.communication.hubStatus;return{hubOk:!!t&&"ok"===t.status,hubMessage:t&&t.message}}))((function(e){var t=e.hubOk,n=e.hubMessage,a=Object(f.g)(),o=Object(d.b)(),i=Object(m.a)(o,2)[1],l=Object(r.useState)("http://localhost:9090"),c=Object(m.a)(l,2),s=c[0],u=c[1],p=Object(r.useState)(!1),h=Object(m.a)(p,2),b=h[0],v=h[1];Object(r.useEffect)((function(){try{var e=window.localStorage.getItem("serviceUrl");null!==e&&u(e)}catch(t){}}),[]);return r.createElement("div",{style:Ii},r.createElement(w,null),r.createElement("div",{style:Pi},r.createElement("h1",{style:{textAlign:"center"}},"Select Cate Service"),r.createElement("div",{style:{marginTop:12,alignContent:"center",textAlign:"center"}},r.createElement("img",{src:ji.a,width:128,height:128,alt:"Cate icon"})),t&&r.createElement("div",{style:{marginTop:12,alignContent:"center",textAlign:"center",maxWidth:360}},"Please select a Cate service provision mode"),n&&r.createElement("div",{style:{marginTop:12,alignContent:"center",textAlign:"center",maxWidth:360}},r.createElement(k.Icon,{icon:"warning-sign",intent:k.Intent.WARNING}),"\xa0",n),r.createElement(k.Button,{className:"bp3-large",intent:k.Intent.PRIMARY,style:{marginTop:18},onClick:function(){a.push("/hub")},disabled:!i||!b||!t,rightIcon:t?null:!i&&r.createElement(k.Spinner,{size:16})},r.createElement(k.Tooltip,{content:r.createElement("div",null,"Obtain a new Cate service instance",r.createElement("br",null),"in the cloud (CateHub Software-as-a-Service).",r.createElement("br",null),"Requires login information.")},"Cate Cloud Service")),r.createElement("div",{style:Di},r.createElement(k.Checkbox,{checked:b,onChange:function(e){v(e.currentTarget.checked)},disabled:!t},"I agree to the\xa0",r.createElement(nr,null)),r.createElement("a",{href:"https://climate.esa.int/en/helpdesk",target:"_blank",rel:"noopener noreferrer"},"Click here in case you need support")),r.createElement(k.Button,{className:"bp3-large",style:{marginTop:18},disabled:!Li(s),onClick:function(){try{window.localStorage.setItem("serviceUrl",s)}catch(e){}a.push("/sa?serviceUrl=".concat(encodeURI(s)))}},r.createElement(k.Tooltip,{content:r.createElement("div",null,"Use a Cate service instance on your",r.createElement("br",null),"own machine or at another known URL.")},"Cate Local Service")),r.createElement("div",{style:{marginTop:6}},r.createElement(k.InputGroup,{value:s,onChange:function(e){return u(e.target.value)},placeholder:"Service URL",large:!0,rightElement:r.createElement(k.Button,{icon:"reset",minimal:!0,disabled:"http://localhost:9090"===s,onClick:function(){u("http://localhost:9090")}})}),r.createElement("div",{style:Di},r.createElement("a",{href:"https://github.com/CCI-Tools/cate#running-cate-app-in-stand-alone-mode",target:"_blank",rel:"noopener noreferrer"},"How do I run a Cate local service?")))),r.createElement("div",{style:{position:"absolute",bottom:4,right:4}},r.createElement(rr,null)))}));function Li(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(n){return!1}}var Ai=Object(i.b)((function(e){return{hubStatus:e.communication.hubStatus}}))((function(e){var t=e.hubStatus;return r.createElement(h.a,null,r.createElement(f.d,null,r.createElement(f.b,{exact:!0,path:"/"},r.createElement(Ti,null)),r.createElement(f.b,{path:"/sa"},r.createElement(bi,null)),r.createElement(f.b,{path:"/hub"},null!==t&&"ok"!==t.status?r.createElement(f.a,{to:"/"}):r.createElement(mi,null))))})),Ri=function(e,t,n){var r=t.payload.dataStoreId,o=e.dataStores.findIndex((function(e){return e.id===r}));if(o<0)throw Error("illegal data store ID: "+r);var i=e.dataStores[o],l=Object(a.a)(Object(a.a)({},i),{},{dataSources:n(i)}),c=Object(In.a)(e.dataStores);return c[o]=l,Object(a.a)(Object(a.a)({},e),{},{dataStores:c})};function Ni(e,t,n){var r,o=t.id,i=function(e,t){return e.concat([t])}(e.views,t),l=e.viewLayout;return n&&(r=Mo(l,n,o)),r&&r!==l||(r=Vo(l,o)),Object(a.a)(Object(a.a)({},e),{},{viewLayout:r,views:i,activeViewId:o})}var xi=function(e,t,n){for(var a=null,r=0;r<e.length;r++){var o=e[r],i=Mi(o,t,n);o!==i&&(a||(a=e.slice(0,r))),a&&i&&a.push(i)}return a||e},Mi=function(e,t,n){var r=e.id===n;switch(t.type){case p.B:if("world"===e.type){var o=Vi(e.data.layers,t,r);if(o!==e.data.layers)return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:o})})}else if("figure"===e.type){var i=Object(Ae.B)(t.payload.resName);if(e.title===i)return i=Object(Ae.B)(t.payload.newResName),Object(a.a)(Object(a.a)({},e),{},{title:i})}break;case p.ib:var l=t.payload.viewId;if(e.id===l&&"world"===e.type){var c=Vi(e.data.layers,t,r);if(c!==e.data.layers)return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:c})})}break;case p.O:if("world"===e.type){var s=Vi(e.data.layers,t,r);if(s!==e.data.layers)return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:s})})}break;case p.M:if(t.payload.viewId===e.id&&"world"===e.type){var u=t.payload.selectedLayerId;return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{selectedLayerId:u})})}break;case p.L:if(t.payload.viewId===e.id&&"world"===e.type){var d=t.payload.selectedEntityId;return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{selectedEntityId:d})})}break;case p.Q:if(t.payload.viewId===e.id){de.a("world"===e.type);var h=t.payload.viewMode;return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{viewMode:h})})}break;case p.J:var f=t.payload,m=f.viewId,b=f.layerSplitPosition;if(m===e.id)return de.a("world"===e.type),Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layerSplitPosition:b})});break;case p.E:if(t.payload.viewId===e.id){de.a("world"===e.type);var v=t.payload.baseMapId;return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{baseMapId:v})})}break;case p.K:if(t.payload.viewId===e.id){de.a("world"===e.type);var y=t.payload.projectionCode;return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{projectionCode:y})})}break;case p.b:if(t.payload.viewId===e.id){de.a("world"===e.type);var g=t.payload.layer,E=t.payload.selectLayer?g.id:e.data.selectedLayerId,O=e.data.layers.concat([g]);return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:O,selectedLayerId:E})})}break;case p.y:if(t.payload.viewId===e.id){de.a("world"===e.type);var _=t.payload.id,C=e.data.layers.slice(),k=e.data.selectedLayerId;_===k&&(k=null);var w=C.findIndex((function(e){return e.id===_}));if(w>=0)return C.splice(w,1),Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:C,selectedLayerId:k})})}break;case p.q:if(t.payload.viewId===e.id){de.a("world"===e.type);var S=t.payload.id,j=e.data.layers.slice(),I=j.findIndex((function(e){return e.id===S}));if(de.a(I>=0,"layerIndex >= 0"),I>0){var P=j[I-1];return j[I-1]=j[I],j[I]=P,Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:j})})}}break;case p.p:if(t.payload.viewId===e.id){de.a("world"===e.type);var D=t.payload.id,T=e.data.layers.slice(),L=T.findIndex((function(e){return e.id===D}));if(de.a(L>=0,"layerIndex >= 0"),L>=0&&L<T.length-1){var A=T[L+1];return T[L+1]=T[L],T[L]=A,Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:T})})}}break;case p.mb:if(t.payload.viewId===e.id){de.a("world"===e.type);var R=t.payload.layer,N=e.data.layers.slice(),x=N.findIndex((function(e){return e.id===R.id}));return de.a(x>=0,"layerIndex >= 0"),N[x]=Object(Sn.a)(N[x],R),Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:N})})}break;case p.nb:if(t.payload.viewId===e.id){de.a("world"===e.type);var M=t.payload,V=M.layerId,B=M.style,W=e.data.layers.slice(),U=W.findIndex((function(e){return e.id===V}));de.a(U>=0,"layerIndex >= 0");var F=W[U];return W[U]=Object(a.a)(Object(a.a)({},F),{},{style:Object(a.a)(Object(a.a)({},F.style),B)}),Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:W})})}break;case p.vb:if(t.payload.viewId===e.id){de.a("table"===e.type);var G=Object(a.a)(Object(a.a)({},e.data),t.payload);return Object(a.a)(Object(a.a)({},e),{},{data:G})}break;case p.bb:if(t.payload.viewId===e.id){de.a("animation"===e.type);var Y=Object(a.a)(Object(a.a)({},e.data),t.payload);return Object(a.a)(Object(a.a)({},e),{},{data:Y})}break;default:if("world"===e.type){var H=Vi(e.data.layers,t,r);if(H!==e.data.layers)return Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{layers:H})})}}return e},Vi=function(e,t,n){for(var a,r=0;r<e.length;r++){var o=e[r],i=Bi(o,t,n);o!==i&&(a||(a=e.slice(0,r))),a&&i&&a.push(i)}return a||e},Bi=function(e,t,n){switch(t.type){case p.B:var r=t.payload.resName,o=t.payload.newResName;if(e.resName===r)return Object(a.a)(Object(a.a)({},e),{},{resName:o});break;case p.ib:var i=t.payload,l=i.layerId,c=i.entityId,s=i.style;if(e.id===l&&Object(Ae.ab)(e)){var u=e.entityStyles,d=u&&u[c],h=Object(a.a)(Object(a.a)({},d),s);if(!me()(d,h))return Object(a.a)(Object(a.a)({},e),{},{entityStyles:Object(a.a)(Object(a.a)({},u),{},Object(B.a)({},c,h))})}break;case p.O:if(e.id===Ae.a){var f=t.payload.showSelectedVariableLayer;return Object(a.a)(Object(a.a)({},e),{},{visible:f})}break;case p.N:if(e.id===Ae.a&&n){var m=t.payload.resource,b=t.payload.selectedVariable,v=t.payload.savedLayers;return Object(Ae.gb)(e,m,b,v)}break;case p.I:var y=t.payload,g=y.layerId,E=y.splitMode;if(e.id===g&&Object(Ae.V)(e))return Object(a.a)(Object(a.a)({},e),{},{splitMode:E})}return e},Wi=function(e,t,n){var r=e.placemarkCollection.features.slice(),o=r.findIndex((function(e){return e.id===t})),i=o>=0&&r[o];de.a(i);var l=i&&i.properties,c=Object(a.a)(Object(a.a)({},l),n),s=Object(a.a)(Object(a.a)({},i),{},{properties:c});o>=0?r[o]=s:r.push(s);var u=Object(a.a)(Object(a.a)({},e.placemarkCollection),{},{features:r});return Object(a.a)(Object(a.a)({},e),{},{placemarkCollection:u})},Ui=function(e,t,n){var r=e.placemarkCollection.features.slice(),o=r.findIndex((function(e){return e.id===t})),i=o>=0&&r[o];de.a(i);var l=i&&i.geometry,c=Object(a.a)(Object(a.a)({},l),n),s=Object(a.a)(Object(a.a)({},i),{},{geometry:c});o>=0?r[o]=s:r.push(s);var u=Object(a.a)(Object(a.a)({},e.placemarkCollection),{},{features:r});return Object(a.a)(Object(a.a)({},e),{},{placemarkCollection:u})},Fi=Object(l.c)({data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ei,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.xb:var n=t.payload.workspaceNames||null;return Object(a.a)(Object(a.a)({},e),{},{workspaceNames:n});case p.pb:var r=t.payload.operations;return Object(a.a)(Object(a.a)({},e),{},{operations:r});case p.F:var o=t.payload.workspace;return Object(a.a)(Object(a.a)({},e),{},{workspace:o});case p.jb:var i=t.payload,l=i.path,c=i.updatedFileNode,s=Object(Pr.m)(e.fsRootNode,l,c);return Object(a.a)(Object(a.a)({},e),{},{fsRootNode:s});case p.cb:var u=t.payload.colorMaps;return Object(a.a)(Object(a.a)({},e),{},{colorMaps:u});case p.gb:var d=t.payload.dataStores.slice();return Object(a.a)(Object(a.a)({},e),{},{dataStores:d});case p.eb:return Ri(e,t,(function(){return t.payload.dataSources.slice()}));case p.fb:return Ri(e,t,(function(e){var n=Object(In.a)(e.dataSources),r=t.payload,o=r.dataSourceId,i=r.metaInfo,l=r.metaInfoStatus,c=n.findIndex((function(e){return e.id===o}));if(c<0)throw Error("illegal data source ID: "+o);var s=n[c],u=Object(a.a)(Object(a.a)({},s),{},{metaInfo:i,metaInfoStatus:l}),d=u.capabilities;return!d&&i&&"ok"===l&&(d=Object(Ae.p)(u)),d!==u.capabilities&&(u=Object(a.a)(Object(a.a)({},u),{},{capabilities:d})),n[c]=u,n}))}return e},control:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.B:var n=t.payload.resName,r=t.payload.newResName,o=e.selectedWorkspaceResourceName;o===n&&(o=r);var i=xi(e.views,t,e.activeViewId);return o!==e.selectedWorkspaceResourceName||i!==e.views?Object(a.a)(Object(a.a)({},e),{},{selectedWorkspaceResourceName:o,views:i}):e;case p.ib:var l=xi(e.views,t,e.activeViewId);return l!==e.views?Object(a.a)(Object(a.a)({},e),{},{views:l}):e;case p.eb:var c=t.payload.dataSources,s=c&&c.length?c[0].id:null;return Object(a.a)(Object(a.a)({},e),{},{selectedDataSourceId:s});case p.pb:var u=t.payload.operations,d=u&&u.length?u[0].name:null;return Object(a.a)(Object(a.a)({},e),{},{selectedOperationName:d});case p.N:var h=t.payload.selectedVariable,f=h?h.name:null,m=e.views,b=xi(e.views,t,e.activeViewId);return b!==m&&(m=b),Object(a.a)(Object(a.a)({},e),{},{selectedVariableName:f,views:m});case p.db:return Object(a.a)(Object(a.a)({},e),t.payload);case p.c:return Object(a.a)(Object(a.a)({},e),{},{newPlacemarkToolType:"NoTool"});case p.a:var v=t.payload.newPlacemarkToolType;return v===e.newPlacemarkToolType&&(v="NoTool"),Object(a.a)(Object(a.a)({},e),{},{newPlacemarkToolType:v});case p.hb:var y=Object(Sn.b)(e.dialogs,t.payload.dialogId,t.payload.dialogState);return Object(a.a)(Object(a.a)({},e),{},{dialogs:y});case p.e:var g=Object(Ae.fb)(t.payload.baseMapId);return Ni(e,g,t.payload.placeAfterViewId);case p.X:var E=t.payload,O=E.resource,_=E.placeAfterViewId,C=e.views.find((function(e){return"figure"===e.type&&O.id===e.data.resourceId}));if(C){var k=Yo(e.viewLayout,C.id);return Object(a.a)(Object(a.a)({},e),{},{viewLayout:k})}var w=Object(Ae.cb)(O);return Ni(e,w,_);case p.W:var S=t.payload,j=S.resource,I=S.placeAfterViewId,P=e.views.find((function(e){return"animation"===e.type&&j.id===e.data.resourceId}));if(P){var D=Yo(e.viewLayout,P.id);return Object(a.a)(Object(a.a)({},e),{},{viewLayout:D})}var T=Object(Ae.bb)(j);return Ni(e,T,I);case p.Z:var L=t.payload,A=L.resName,R=L.varName,N=L.placeAfterViewId,x=e.views.find((function(e){return"table"===e.type&&e.data.resName===A&&e.data.varName===R}));if(x){var M=Yo(e.viewLayout,x.id);return Object(a.a)(Object(a.a)({},e),{},{viewLayout:M})}var V=Object(Ae.db)(A,R);return Ni(e,V,N);case p.d:var W=t.payload,U=W.placeAfterViewId,F=W.resName,G=W.varName,Y=Object(Ae.db)(F,G);return Ni(e,Y,U);case p.D:var H=t.payload,K=H.viewPath,z=H.viewId,q=Uo(e.viewLayout,K,z);return Object(a.a)(Object(a.a)({},e),{},{viewLayout:q,activeViewId:z});case p.r:var J=t.payload,X=J.sourceViewId,Z=J.placement,Q=J.targetViewId,$=xo(e.viewLayout,X,Z,Q),ee=e.activeViewId;if(ee){var te=function(e){return e.viewIds.indexOf(ee)>=0},ne=Ro($,te);ne&&ne.selectedViewId!==ee&&(ee=ne.selectedViewId)}return Object(a.a)(Object(a.a)({},e),{},{viewLayout:$,activeViewId:ee});case p.l:var ae=t.payload.viewPath,re=t.payload.viewId,oe=Go(e.views,re),ie=Fo(e.viewLayout,ae,re),le=e.activeViewId;if(le===re){le=null;var ce=Ao(ie,ae);(ce&&ce.selectedViewId||(ce=Ro(ie,(function(e){return!!e.selectedViewId}))))&&(le=ce.selectedViewId)}return Object(a.a)(Object(a.a)({},e),{},{viewLayout:ie,views:oe,activeViewId:le});case p.ab:var se=t.payload.viewPath,ue=t.payload.dir,de=t.payload.pos,pe=Bo(e.viewLayout,se,ue,de);return Object(a.a)(Object(a.a)({},e),{},{viewLayout:pe});case p.f:var he=t.payload.viewPath,fe=t.payload.delta,me=Wo(e.viewLayout,he,fe);return Object(a.a)(Object(a.a)({},e),{},{viewLayout:me});case p.n:var be=e.entityUpdateCount+1;return Object(a.a)(Object(a.a)({},e),{},{entityUpdateCount:be});case p.o:var ve=t.payload,ye=ve.selectedCtxOperationName,ge=ve.inputAssignments,Ee=e.dialogs.newCtxOperationStepDialog;return Ee=Object(a.a)(Object(a.a)({},Ee),{},{isOpen:!0,inputAssignments:ge}),Object(a.a)(Object(a.a)({},e),{},{selectedCtxOperationName:ye,dialogs:Object(a.a)(Object(a.a)({},e.dialogs),{},Object(B.a)({},"newCtxOperationStepDialog",Ee))});case p.ob:return Object(a.a)(Object(a.a)({},e),t.payload);case p.Y:return Object(a.a)(Object(a.a)({},e),{},{pwaInstallPromotionVisible:!0});case p.m:return Object(a.a)(Object(a.a)({},e),{},{pwaInstallPromotionVisible:!1});case p.tb:return Object(a.a)(Object(a.a)({},e),{},{pwaDisplayMode:t.payload});case p.x:return Object(a.a)(Object(a.a)({},e),{},{messageBox:Object(a.a)(Object(a.a)(Object(a.a)({},e.messageBox),t.payload),{},{isOpen:!0})});case p.k:return Object(a.a)(Object(a.a)({},e),{},{messageBox:Object(a.a)(Object(a.a)(Object(a.a)({},e.messageBox),t.payload),{},{isOpen:!1})});case p.t:return Object(a.a)(Object(a.a)({},e),{},{directorySelectDialog:Object(a.a)(Object(a.a)(Object(a.a)({},e.directorySelectDialog),t.payload),{},{isOpen:!0})});case p.g:return Object(a.a)(Object(a.a)({},e),{},{directorySelectDialog:Object(a.a)(Object(a.a)(Object(a.a)({},e.directorySelectDialog),t.payload),{},{isOpen:!1})});case p.v:return Object(a.a)(Object(a.a)({},e),{},{fileOpenDialog:Object(a.a)(Object(a.a)(Object(a.a)({},e.fileOpenDialog),t.payload),{},{isOpen:!0})});case p.i:return Object(a.a)(Object(a.a)({},e),{},{fileOpenDialog:Object(a.a)(Object(a.a)(Object(a.a)({},e.fileOpenDialog),t.payload),{},{isOpen:!1})});case p.w:return Object(a.a)(Object(a.a)({},e),{},{fileSaveDialog:Object(a.a)(Object(a.a)(Object(a.a)({},e.fileSaveDialog),t.payload),{},{isOpen:!0})});case p.j:return Object(a.a)(Object(a.a)({},e),{},{fileSaveDialog:Object(a.a)(Object(a.a)(Object(a.a)({},e.fileSaveDialog),t.payload),{},{isOpen:!1})});case p.u:return Object(a.a)(Object(a.a)({},e),{},{fileBrowseDialog:Object(a.a)(Object(a.a)(Object(a.a)({},e.fileBrowseDialog),t.payload),{},{isOpen:!0})});case p.h:return Object(a.a)(Object(a.a)({},e),{},{fileBrowseDialog:Object(a.a)(Object(a.a)(Object(a.a)({},e.fileBrowseDialog),t.payload),{},{isOpen:!1})});default:var Oe=xi(e.views,t,e.activeViewId);if(Oe!==e.views)return Object(a.a)(Object(a.a)({},e),{},{views:Oe})}return e},session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ci,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.L:var n=t.payload.selectedEntityId||null,r=null;if(Object(he.e)(n)&&n.startsWith(Ae.i)&&(r=n),r!==e.selectedPlacemarkId)return Object(a.a)(Object(a.a)({},e),{},{selectedPlacemarkId:r});break;case p.lb:return Object(a.a)(Object(a.a)({},e),t.payload.session);case p.ub:case p.O:return Object(a.a)(Object(a.a)({},e),t.payload);case p.E:return Object(a.a)(Object(a.a)({},e),{},{lastBaseMapId:t.payload.baseMapId});case p.C:var o=t.payload,i=o.key,l=o.layer,c=Object(Sn.a)(e.savedLayers,Object(B.a)({},i,l));return Object(a.a)(Object(a.a)({},e),{},{savedLayers:c});case p.c:var s=t.payload.placemark,u=e.placemarkCollection.features,d=Object(a.a)({},s.properties),h=Object(Ae.L)(s,e.placemarkCollection),f=h.title,m=h.index;f&&(d=Object(a.a)(Object(a.a)({},d),{},{title:f}),"Point"===s.geometry.type&&(d["marker-symbol"]=m.toString(16).slice(-1)),s=Object(a.a)(Object(a.a)({},s),{},{properties:d})),u=u.concat([s]);var b=Object(a.a)(Object(a.a)({},e.placemarkCollection),{},{features:u});return Object(a.a)(Object(a.a)({},e),{},{placemarkCollection:b,selectedPlacemarkId:s.id});case p.z:var v=t.payload.placemarkId,y=e.placemarkCollection.features,g=y.findIndex((function(e){return e.id===v}));if(g>=0){(y=y.slice()).splice(g,1);var E=null;g<y.length?E=y[g].id:y.length>0&&(E=y[y.length-1].id);var O=Object(a.a)(Object(a.a)({},e.placemarkCollection),{},{features:y});return Object(a.a)(Object(a.a)({},e),{},{placemarkCollection:O,selectedPlacemarkId:E})}break;case p.qb:var _=t.payload,C=_.placemarkId,k=_.geometry;return Ui(e,C,k);case p.rb:var w=t.payload,S=w.placemarkId,j=w.properties;return Wi(e,S,j);case p.sb:var I=t.payload,P=I.placemarkId,D=I.style,T=Object(Ne.b)(D),L=Object(a.a)(Object(a.a)({},e.defaultPlacemarkStyle),D);return Object(a.a)(Object(a.a)({},Wi(e,P,T)),{},{defaultPlacemarkStyle:L});case p.s:var A=t.payload.trackingConsentObtained;return gi(A),Object(a.a)(Object(a.a)({},e),{},{cookieConsentObtained:!0,trackingConsentObtained:A})}return e},communication:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ki,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.U:var n=t.payload.webAPIServiceURL;return Object(a.a)(Object(a.a)({},e),{},{webAPIServiceURL:n});case p.V:var r=t.payload.webAPIStatus;return Object(a.a)(Object(a.a)({},e),{},{webAPIStatus:r});case p.S:var o=t.payload.webAPIClient;return Object(a.a)(Object(a.a)({},e),{},{webAPIClient:o,webAPIStatus:"open"});case p.T:var i=t.payload.webAPIServiceInfo;return Object(a.a)(Object(a.a)({},e),{},{webAPIServiceInfo:Object(a.a)(Object(a.a)({},e.webAPIServiceInfo),i)});case p.R:var l=t.payload.webAPIAutoStopInfo;return Object(a.a)(Object(a.a)({},e),{},{webAPIServiceInfo:Object(a.a)(Object(a.a)({},e.webAPIServiceInfo),{},{autoStopInfo:l})});case p.kb:return Object(a.a)(Object(a.a)({},e),{},{hubStatus:t.payload});case p.wb:return Object(a.a)(Object(a.a)({},e),{},{tasks:Object(Sn.b)(e.tasks,t.payload.jobId,t.payload.taskState)});case p.A:var c=Object(a.a)({},e.tasks);return delete c[t.payload.jobId],Object(a.a)(Object(a.a)({},e),{},{tasks:c});case p.P:return Object(a.a)(Object(a.a)({},e),{},{userProfile:t.payload})}return e},location:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wi,t=arguments.length>1?arguments[1]:void 0;if(t.type===p.G){var n=t.payload.position;if(e.globeMousePosition!==n)return Object(a.a)(Object(a.a)({},e),{},{globeMousePosition:n})}else if(t.type===p.H){var r=t.payload.position,o=t.payload.positionData;if(e.globeViewPosition!==r||e.positionData!==o)return Object(a.a)(Object(a.a)({},e),{},{globeViewPosition:r,positionData:o})}return e}}),Gi=u()(function(){var e=ar.b.auth,t=e.url,n=e.realm,a=e.clientId;if(!n||!t||!a)throw new Error("Missing or incomplete KeyCloak configuration");return{realm:n,url:t,clientId:a}}()),Yi={onLoad:"check-sso",enableLogging:!0};console.debug("Cate PWA version ".concat("3.1.5-dev.0"));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(790),n(791),n(792),n(793),n(794),n(795),n(796),n(797);window.CESIUM_BASE_URL="./cesium",function(){var e=[c.a],t=l.a.apply(void 0,e),n=Object(l.d)(Fi,t),s=ar.b.webApi.endpointUrl.includes("stage")||ar.b.webApi.endpointUrl.includes("dev")?"development":"production";fetch("https://raw.githubusercontent.com/CCI-Tools/cate-status/main/".concat(s,".json"),{mode:"cors"}).then((function(e){return e.json()})).then((function(e){return n.dispatch(p.ud(Object(a.a)(Object(a.a)({},e),{},{deployment:s})))})).catch((function(e){return console.error(e)})),o.render(r.createElement(d.a,{keycloak:Gi,initConfig:Yi,onEvent:function(e,t){console.debug("onKeycloakEvent",e,t)},onTokens:function(e){console.debug("onKeycloakTokens",e)}},r.createElement(i.a,{store:n},r.createElement(Ai,null))),document.getElementById("root")),Object(S.a)()||window.addEventListener("beforeinstallprompt",(function(e){n.dispatch(p.nd(e)),console.log("BEFORE INSTALL PROMPT:",e)}))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},90:function(e,t,n){"use strict";var a=n(6),r=n(219),o=n.n(r),i=window.electron||null;t.a=i?{isNativeUI:!0,showFileOpenDialog:function(e,t){i.ipcRenderer.send("show-open-dialog",e,!1),i.ipcRenderer.once("show-open-dialog-reply",(function(e,n){t(n)}))},showFileSaveDialog:function(e,t){i.ipcRenderer.send("show-save-dialog",e,!1),i.ipcRenderer.once("show-save-dialog-reply",(function(e,n){t(n)}))},showMessageBox:function(e,t){e.buttons||(e=Object(a.a)(Object(a.a)({},e),{},{buttons:["OK"]})),i.ipcRenderer.send("show-message-box",e,!1),i.ipcRenderer.once("show-message-box-reply",(function(e,n,a){t({buttonIndex:n,checkboxChecked:a})}))},showItemInFolder:function(e){return Promise.resolve(i.shell.showItemInFolder(e))},openItem:function(e){return Promise.resolve(i.shell.openItem(e))},openExternal:function(e){return Promise.resolve(i.shell.openExternal(e))},copyTextToClipboard:function(e){return i.clipboard.writeText(e)}}:{isNativeUI:!1,showFileOpenDialog:function(e,t){},showFileSaveDialog:function(e,t){},showMessageBox:function(e,t){},showItemInFolder:function(e){return Promise.resolve(!0)},copyTextToClipboard:function(e){return new Promise((function(t){o()(e,{onCopy:function(){return t(!0)}})}))}}}},[[449,1,2]]]);
//# sourceMappingURL=main.360f730d.chunk.js.map